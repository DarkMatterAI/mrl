---

title: VAE Model

keywords: fastai
sidebar: home_sidebar

summary: "VAE-type models"
description: "VAE-type models"
nb_path: "nbs/11_generative_models.vae.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/11_generative_models.vae.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VAE-Models">VAE Models<a class="anchor-link" href="#VAE-Models"> </a></h2><p>Variational Autoencoders (VAEs) are a class of generative model that follows an encoder-decoder framework. The encoder maps an input down to a latent vector. The decoder reconstructs the input, and the model is trained on the quality of the reconstruction. VAEs impose a Gaussian prior on the latent space by regularizing the deviation of latent vectors from a unit Gaussian. As a result, we can easily sample valid latent vectors by randomly sampling from a Gaussian distribution.</p>
<p>When dealing with generating text sequences (SMILES, amino acids, etc), we train the model in a self-supervised fashion using next token prediction. In this framework, the decoder module is a conditional LSTM. These models are very similar to the <a href="/mrl/generative_models.lstm_lm#Conditional_LSTM_LM"><code>Conditional_LSTM_LM</code></a> model, with the added constraint on the latent space.</p>
<p>During generation, we sample from the model in an autoregression fashion. Given an input token, the model predicts a distribution of tokens over the next token. We then sample from that distribution and feed the selected token back into the model. We repeat this process until either an end of sentence (EOS) token is predicted, or the generated sequence reaches a maximum allowed length.</p>
<p>During sampling, we save the log probability of each token predicted. This gives us a probability value for the model's estimated likelihood of the generated compound. We can also backprop through this value.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VAE-Transition">VAE Transition<a class="anchor-link" href="#VAE-Transition"> </a></h2><p>The <a href="/mrl/generative_models.vae#VAE_Transition"><code>VAE_Transition</code></a> class converts an input vector to a valid latent vector. Following standard VAE implementations, the input vector is used to predict a vector of means and a vector of log variances which parameterize a Gaussian distribution. We then use the <a href="https://gregorygundersen.com/blog/2018/04/29/reparameterization/">Reparametarization Trick</a> to sample a latent vector from that distribution.</p>
<p>The module returns the latent vectors and a KL-loss based on the latent distributions deviations from a unit Gaussian.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAE_Transition" class="doc_header"><code>class</code> <code>VAE_Transition</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAE_Transition</code>(<strong><code>d_latent</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>VAE_Transition - converts an input vector to
a latent vector using the reparametarization trick</p>
<p>Inputs:</p>
<ul>
<li><code>d_latent int</code>: latent variable dimensions</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VAE">VAE<a class="anchor-link" href="#VAE"> </a></h2><p><a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a> is the base class for VAE models. VAE models consist of a encoder, decoder, and transition modules.</p>
<p>The encoder module maps the model's inputs down to a vector. The model will work with any of the <a href="/mrl/layers#Encoder"><code>Encoder</code></a> subclasses in the <code>layers</code> section. Custom encoders also work so long as they are compatible with the data format you are using and produce a single vector per batch item.</p>
<p>The transition module converts the encoder output to a valid latent vector. By default, VAEs use the <a href="/mrl/generative_models.vae#VAE_Transition"><code>VAE_Transition</code></a> which samples a latent vector assuming a target distribution of a unit Gaussian. This can be substituted for any module that returns latent vectors and a KL loss term (0 if not applicable).</p>
<p>The decoder module uses the latent vector to reconstruct the input.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAE" class="doc_header"><code>class</code> <code>VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L47" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAE</code>(<strong><code>encoder</code></strong>, <strong><code>decoder</code></strong>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.generative_base#GenerativeModel"><code>GenerativeModel</code></a></p>
</blockquote>
<p>VAE - base VAE class</p>
<p>Inputs:</p>
<ul>
<li><p><code>encoder nn.Module</code>: encoder module</p>
</li>
<li><p><code>decoder nn.Module</code>: decoder module</p>
</li>
<li><p><code>prior Optional[nn.Module]</code>: prior module</p>
</li>
<li><p><code>bos_idx int</code>: BOS token</p>
</li>
<li><p><code>transition Optional[nn.Module]</code>: transition module</p>
</li>
<li><p><code>forward_rollout bool</code>: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models</p>
</li>
<li><p><code>p_force float</code>: teacher forcing probabiliy</p>
</li>
<li><p><code>force_decay float</code>: rate of decay of p_force</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">LSTM_Encoder</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">Conditional_LSTM_Block</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Conditional_LSTM_Block</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Conditional_LSTM_Block</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">o</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">lpg</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">set_prior_from_encoder</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>

<span class="n">o</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">lpg</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">lpg</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<span class="n">latent</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">128</span><span class="p">))</span>
<span class="n">o</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">lpg</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">latent</span><span class="o">=</span><span class="n">latent</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preset-VAEs">Preset VAEs<a class="anchor-link" href="#Preset-VAEs"> </a></h2><p>The following modules are preset encoder-decoder configurations.</p>
<p><a href="/mrl/generative_models.vae#LSTM_VAE"><code>LSTM_VAE</code></a> has a LSTM encoder and a conditional LSTM decoder. This works for most sequence to sequence type tasks.</p>
<p><a href="/mrl/generative_models.vae#Conv_VAE"><code>Conv_VAE</code></a> replaces the LSTM encoder with a 1D conv encoder (the model is still intended for sequences, not 2D images). The convolutional encoder tends to be faster and lighter than the LSTM encoder. Anecdotally, it seems to perform better than the LSTM encoder.</p>
<p><a href="/mrl/generative_models.vae#MLP_VAE"><code>MLP_VAE</code></a> uses a MLP encoder. This model works best for reconstructing a sequence from a fingerprint, property vector, or something similar.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_VAE" class="doc_header"><code>class</code> <code>LSTM_VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L355" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_VAE</code>(<strong><code>d_vocab</code></strong>, <strong><code>d_embedding</code></strong>, <strong><code>d_hidden</code></strong>, <strong><code>n_layers</code></strong>, <strong><code>d_latent</code></strong>, <strong><code>input_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>lstm_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>condition_hidden</code></strong>=<em><code>True</code></em>, <strong><code>condition_output</code></strong>=<em><code>True</code></em>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a></p>
</blockquote>
<p>LSTM_VAE - VAE with LSTM encoder and conditional LSTM decoder.
Usable for text-to-text or seq-2-seq tasks or similar</p>
<p>Inputs:</p>
<ul>
<li><p><code>d_vocab int</code>: vocab size</p>
</li>
<li><p><code>d_embedding int</code>: embedding dimension</p>
</li>
<li><p><code>d_hidden int</code>: hidden dimension</p>
</li>
<li><p><code>n_layers int</code>: number of LSTM layers (same for encoder and decoder)</p>
</li>
<li><p><code>d_latent int</code>: latent vector dimension</p>
</li>
<li><p><code>input_dropout float</code>: dropout percentage on inputs</p>
</li>
<li><p><code>lstm_dropout float</code>: dropout on LSTM layers</p>
</li>
<li><p><code>condition_hidden bool</code>: if True, latent vector is used to initialize the
hidden state</p>
</li>
<li><p><code>condition_output bool</code>: if True, latent vector is concatenated to inputs</p>
</li>
<li><p><code>prior Optional[nn.Module]</code>: optional prior distribution to sample from.
see <a href="/mrl/layers#Prior"><code>Prior</code></a></p>
</li>
<li><p><code>bos_idx int</code>: beginning of sentence token</p>
</li>
</ul>
<ul>
<li><p><code>transition Optional[nn.Module]</code>: transition module</p>
</li>
<li><p><code>forward_rollout bool</code>: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models</p>
</li>
<li><p><code>p_force float</code>: teacher forcing probabiliy</p>
</li>
<li><p><code>force_decay float</code>: rate of decay of p_force</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">LSTM_VAE</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Conv_VAE" class="doc_header"><code>class</code> <code>Conv_VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L446" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Conv_VAE</code>(<strong><code>d_vocab</code></strong>, <strong><code>d_embedding</code></strong>, <strong><code>conv_filters</code></strong>, <strong><code>kernel_sizes</code></strong>, <strong><code>strides</code></strong>, <strong><code>conv_drops</code></strong>, <strong><code>d_hidden</code></strong>, <strong><code>n_layers</code></strong>, <strong><code>d_latent</code></strong>, <strong><code>input_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>lstm_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>condition_hidden</code></strong>=<em><code>True</code></em>, <strong><code>condition_output</code></strong>=<em><code>True</code></em>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a></p>
</blockquote>
<p>Conv_VAE - VAE with 1D Conv encoder and conditional LSTM decoder.
Usable for text-to-text or seq-2-seq tasks or similar</p>
<p>Inputs:</p>
<ul>
<li><p><code>d_vocab int</code>: vocab size</p>
</li>
<li><p><code>d_embedding int</code>: embedding dimension</p>
</li>
<li><p><code>conv_filters list[int]</code>: filter sizes for conv layers ie <code>[64, 128, 256]</code></p>
</li>
<li><p><code>kernel_sizes list[int]</code>: kernel sizes for conv layers ie <code>[5, 5, 5]</code></p>
</li>
<li><p><code>strides list[int]</code>: strides for conv layers ie <code>[2, 2, 2]</code></p>
</li>
<li><p><code>conv_drops list[float]</code>: list of dropout pobabilities ie <code>[0.2, 0.2, 0.3]</code></p>
</li>
<li><p><code>d_hidden int</code>: hidden dimension</p>
</li>
<li><p><code>n_layers int</code>: number of LSTM layers (same for encoder and decoder)</p>
</li>
<li><p><code>d_latent int</code>: latent variable dimension</p>
</li>
<li><p><code>input_dropout float</code>: dropout percentage on inputs</p>
</li>
<li><p><code>lstm_dropout float</code>: dropout on LSTM layers</p>
</li>
<li><p><code>condition_hidden bool</code>: if True, latent vector is used to initialize the
hidden state</p>
</li>
<li><p><code>condition_output bool</code>: if True, latent vector is concatenated to
the outputs of the embedding layer</p>
</li>
<li><p><code>prior Optional[nn.Module]</code>: prior module</p>
</li>
<li><p><code>bos_idx int</code>: BOS token</p>
</li>
<li><p><code>transition Optional[nn.Module]</code>: transition module</p>
</li>
<li><p><code>forward_rollout bool</code>: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models</p>
</li>
<li><p><code>p_force float</code>: teacher forcing probabiliy</p>
</li>
<li><p><code>force_decay float</code>: rate of decay of p_force</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">Conv_VAE</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> 
               <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MLP_VAE" class="doc_header"><code>class</code> <code>MLP_VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L546" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MLP_VAE</code>(<strong><code>d_vocab</code></strong>, <strong><code>d_embedding</code></strong>, <strong><code>encoder_d_in</code></strong>, <strong><code>encoder_dims</code></strong>, <strong><code>encoder_drops</code></strong>, <strong><code>d_hidden</code></strong>, <strong><code>n_layers</code></strong>, <strong><code>d_latent</code></strong>, <strong><code>input_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>lstm_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>condition_hidden</code></strong>=<em><code>True</code></em>, <strong><code>condition_output</code></strong>=<em><code>True</code></em>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a></p>
</blockquote>
<p>MLP_VAE - VAE with MLP encoder and conditional LSTM decoder.
Usable for reconstructing a sequence from a vector</p>
<p>Inputs:</p>
<ul>
<li><p><code>d_vocab int</code>: vocab size</p>
</li>
<li><p><code>d_embedding int</code>: embedding dimension</p>
</li>
<li><p><code>encoder_d_in int</code>: encoder input dimension</p>
</li>
<li><p><code>encoder_dims list[int]</code>: list of encoder layer sizes ie <code>[1024, 512, 256]</code></p>
</li>
<li><p><code>encoder_drops list[float]</code>: list of dropout pobabilities ie <code>[0.2, 0.2, 0.3]</code></p>
</li>
<li><p><code>d_hidden int</code>: hidden dimension</p>
</li>
<li><p><code>n_layers int</code>: number of LSTM layers (same for encoder and decoder)</p>
</li>
<li><p><code>d_latent int</code>: latent variable dimension</p>
</li>
<li><p><code>input_dropout float</code>: dropout percentage on inputs</p>
</li>
<li><p><code>lstm_dropout float</code>: dropout on LSTM layers</p>
</li>
<li><p><code>condition_hidden bool</code>: if True, latent vector is used to initialize the
hidden state</p>
</li>
<li><p><code>condition_output bool</code>: if True, latent vector is concatenated to
the outputs of the embedding layer</p>
</li>
<li><p><code>prior Optional[nn.Module]</code>: prior module</p>
</li>
<li><p><code>bos_idx int</code>: BOS token</p>
</li>
<li><p><code>transition Optional[nn.Module]</code>: transition module</p>
</li>
<li><p><code>forward_rollout bool</code>: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models</p>
</li>
<li><p><code>p_force float</code>: teacher forcing probabiliy</p>
</li>
<li><p><code>force_decay float</code>: rate of decay of p_force</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> 
               <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">condition</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">condition</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">condition</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAELoss" class="doc_header"><code>class</code> <code>VAELoss</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L638" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAELoss</code>(<strong><code>weight</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>VAELoss - loss for VAE models</p>
<p>Inputs:</p>
<ul>
<li><code>weight float</code>: KL loss weight</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="vae_seq2seq_collate" class="doc_header"><code>vae_seq2seq_collate</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L656" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>vae_seq2seq_collate</code>(<strong><code>batch</code></strong>, <strong><code>pad_idx</code></strong>, <strong><code>batch_first</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAE_Seq2Seq_Dataset" class="doc_header"><code>class</code> <code>VAE_Seq2Seq_Dataset</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L663" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAE_Seq2Seq_Dataset</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <a href="/mrl/dataloaders#Text_Dataset"><code>Text_Dataset</code></a></p>
</blockquote>
<p>VAE_Seq2Seq_Dataset - seq to seq dataset for VAEs</p>
<p>Inputs:</p>
<ul>
<li><p><code>sequences - list[tuple]</code>: list of text tuples (source, target)</p>
</li>
<li><p><code>vocab - Vocab</code>: vocabuary for tokenization/numericaization</p>
</li>
<li><p><code>collate_function Callable</code>: batch collate function.
If None, defauts to <a href="/mrl/generative_models.vae#vae_seq2seq_collate"><code>vae_seq2seq_collate</code></a></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># text reconstruction</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Text_Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LSTM_VAE</span><span class="p">(</span>
                <span class="n">d_vocab</span><span class="p">,</span>
                <span class="n">d_embedding</span><span class="p">,</span>
                <span class="n">d_hidden</span><span class="p">,</span>
                <span class="n">n_layers</span><span class="p">,</span>
                <span class="n">d_latent</span><span class="p">,</span>
                <span class="n">input_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">lstm_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
                <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
                <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
                <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>


<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fa7c815dbd0&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># text reconstruction conv</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Text_Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">conv_filters</span> <span class="o">=</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">kernel_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">strides</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">conv_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Conv_VAE</span><span class="p">(</span>
                <span class="n">d_vocab</span><span class="p">,</span>
                <span class="n">d_embedding</span><span class="p">,</span>
                <span class="n">conv_filters</span><span class="p">,</span>
                <span class="n">kernel_sizes</span><span class="p">,</span>
                <span class="n">strides</span><span class="p">,</span>
                <span class="n">conv_drops</span><span class="p">,</span>
                <span class="n">d_hidden</span><span class="p">,</span>
                <span class="n">n_layers</span><span class="p">,</span>
                <span class="n">d_latent</span><span class="p">,</span>
                <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
                <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
                <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
                <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
                <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
                <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>


<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fa7c0f21290&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXAAAAD4CAYAAAD1jb0+AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAxhElEQVR4nO3deXhb1Z3/8feRZFm2LFve9zWxs+8rJEAgQNnTQstWWgptaQu0lPZXoNPOlE43pjAzLWU6lLIOZWuBsrWsCQkQkhBnTxw7m+Ml3vdVtmWd3x+ShR3b2LEVy5K/r+fhiX11pXsuiT85+d6zKK01QgghAo/B3w0QQggxNhLgQggRoCTAhRAiQEmACyFEgJIAF0KIAGWayIvFxcXprKysibykEEIEvB07dtRpreNPPj6hAZ6VlUV+fv5EXlIIIQKeUqpkqONSQhFCiAAlAS6EEAFKAlwIIQKUBLgQQgQoCXAhhAhQEuBCCBGgJMCFECJABVSA97o0z39SSnNHj7+bIoQQfhdQAf4/7x/hnpf38ca+Cn83RQgh/C5gAnxHSQO/X38YgIqmTj+3Rggh/G9Cp9KPVXNnD997bjcpdgud3S4qmxz+bpIQQvhdQPTAf/lGAdUtDh68dhFZseFUNEsPXAghAqIHftu50zljWiyLMqJJtoext7zJ300SQgi/C4gAz4qzkhVnBSAlysLbBxxorVFK+bllQgjhPwFRQukvOcpCt9NFfXu3v5sihBB+FXgBbg8DkAeZQogpL+ACPCXKHeDyIFMIMdUFXIAn2y0AVMpYcCHEFBdwAR5rNWM2GahslhKKEGJqC7gAV0qRHGWhQgJcCDHFBVyAg3skipRQhBBTXUAGeEpUmJRQhBBTXkAGeLLdQlWLg16X9ndThBDCbwIzwKPC6HVpalu7/N0UIYTwmxEDXCn1uFKqRim1v9+x+5VShUqpvUqpvyul7Ke1lSdJ8QwllLHgQoipbDQ98CeBi0469i4wV2s9HzgE/NjH7fpMyVEyG1MIIUYMcK31B0DDScfe0Vo7Pd9uBdJOQ9uG1Tcbs1J64EKIKcwXNfCbgTeHe1EpdYtSKl8plV9bW+uDy0FkmIlws5EK6YELIaawcQW4UuongBN4ZrhztNaPaK2Xaq2XxsfHj+dy/a/rHgsuPXAhxBQ25vXAlVI3ApcBa7XWEz6eL8UeJntjCiGmtDH1wJVSFwF3A1dorTt826TRyUu0cbCqFUdPrz8uL4QQfjeaYYTPAVuAGUqpcqXU14GHABvwrlJqt1Lq4dPczkFWZMfQ7XSxp6xpoi8thBCTwoglFK31dUMcfuw0tOWULM+OQSnYVtzAipxYfzdHCCEmXEDOxASwh5uZmRTJtuJ6fzdFCCH8ImADHNxllB0ljXQ7Xf5uihBCTLiADvCVOTE4elzsLW/yd1OEEGLCBXSAL8921763FTeMcKYQQgSfgA7wGKuZGYk2th6TOrgQYuoJ6AAHWJHjroP39EodXAgxtQR8gK/MiaWju5e95c3+booQQkyogA/wM6fFYjQoNhRW+7spQggxoQI+wO3hZlZkx/DOAQlwIcTUEvABDnDh7EQO17RxrLbN300RQogJExQBfsGcJADeLZBeuBBi6giKAE+1hzE3NZJ3JMCFEFNIUAQ4wIWzk9hZ2khNq+zSI4SYGoInwOckojX8Lb+cjw7X8W5BNX7YZ0IIISbMmHfkmWxmJNrIiAnn/reLvMf++b2zmJ0S6cdWCSHE6RM0Aa6U4qHrF3GwsgVHj4ufvXaA6lYHs5EAF0IEp6AJcID5aXbmp9k5XtcOQENbt59bJIQQp0/Q1MD7i4kwA9DQLgEuhAheQRngtlATIUZFvQS4ECKIBWWAK6WIsZppaO/yd1OEEOK0CcoAB4ixhkoJRQgR1II4wEMkwIUQQS2IA1x64EKI4Ba0AR5rNctDTCFEUAvaAI+xmml1OOl2ylZrQojgFNQBDtDYIb1wIURwCtoAj/UEeL3MxhRCBKmgDfC+Hrg8yBRCBKugDfBYz3T6epnMI4QIUkEb4DHWUEB64EKI4DVigCulHldK1Sil9vc7FqOUelcpddjza/Tpbeaps4eFYFAS4EKI4DWaHviTwEUnHbsHWK+1zgXWe76fVAwGRXS4jAUXQgSvEQNca/0B0HDS4XXAU56vnwI+79tm+UaM1UyjBLgQIkiNtQaeqLWuBPD8mjDciUqpW5RS+Uqp/Nra2jFebmyiZTamECKInfaHmFrrR7TWS7XWS+Pj40/35QaItZqlBi6ECFpjDfBqpVQygOfXGt81yXdiJMCFEEFsrAH+GnCj5+sbgVd90xzfirWaaezoptel/d0UIYTwudEMI3wO2ALMUEqVK6W+DtwHXKCUOgxc4Pl+0omxmtEammQ9FCFEEBpxV3qt9XXDvLTWx23xuZiITyfzxHq+FkKIYBG0MzGh34JWUgcXQgShoA5wWdBKCBHMgjrA+/fAD1a28NCGw/JAUwgRNEasgQeyaE+Abyqq4bdvFdLqcLI0K4aVObF+bpkQQoxfUPfAQ4wGIi0m3jtYQ1xEKGajgfUHq/3dLCGE8ImgDnCAzFgrM5Ns/PVbZ7AiJ4b1hZNyzpEQQpyyoC6hADz7zRWEmoyYTQbWzkzg3tcLKK5rJzvO6u+mCSHEuAR9D9xmCcFsct/meTMTAdggvXAhRBAI+gDvLyM2nNyECDYUSh1cCBH4plSAA6ydlci2Yw20Onr83RQhhBiXKRjgCThdmg8O1fm7KUIIMS5TLsAXpduJt4Xyhw2H6ezu9XdzhBBizKZcgJuMBu7/4nwKq1q597UD/m6OEEKM2ZQLcIA1MxK47dxpvJBfxks7yv3dHCGEGJMpGeAAd56fx4rsGP711f00d8oDTSFE4JmyAW4yGvjppbPp6O7ltT0V/m6OEEKcsikb4ABzUyOZnRzJC9tL/d0UIYQ4ZVM6wJVSXLs8nf0nWth/otnfzRFCiFMypQMcYN2CVEJNBl7YXubvpgghxCmZ8gEeFR7CJfOSeWX3CRkXLoQIKFM+wAGuWZZOq8PJs59ILVwIETgkwIEV2TGcnRfPr/5RwFv7Kwe9rrXG2evyQ8uEEGJ4EuC4H2Y+fMNiFqbb+e5zu/jgUK33tfYuJ9c+spUrHtqMo0dKLEKIyUMC3CPcbOKJry1nWnwEX39qO//z/hHau5x846l8th9voKCyhYc2HPF3M4UQwksCvJ+o8BCev2UlF85O4v63i1j5m/VsLa7nv65eyFWL03h401EKKlr83UwhhAAkwAexh5t56PpF/P7ahUSFhXDflfP4/KJU/vWyWdjDQ7j7pb1SDxdCTAoS4ENQSrFuYSof3X0e1yzLANzBfu8Vc9h3opnX98rUeyGE/0mAn4JL5yWTE2flma0y3FAI4X8S4KdAKcX1KzLIL2mksEpq4UII/5IAP0VXLU7DbDLw7DbphQsh/GtcAa6UulMpdUAptV8p9ZxSyuKrhk1W0VYzl81L5uWdJ2jvcvq7OUKIKWzMAa6USgW+ByzVWs8FjMC1vmrYZPbllRm0dTl5XdYRF0L40XhLKCYgTCllAsKBKZFoizOiyU2IkI0ghBB+NeYA11qfAB4ASoFKoFlr/c7J5ymlblFK5Sul8mtra09+OSAppVicEc2h6lZ/N0UIMYWNp4QSDawDsoEUwKqUuuHk87TWj2itl2qtl8bHx4+9pZNMbmIEdW3dNLR3+7spQogpajwllPOBYq11rda6B3gZONM3zZr8pidEAHCkps3PLRFCTFXjCfBSYKVSKlwppYC1wEHfNGvyy020AXC4RsooQgj/GE8NfBvwIrAT2Of5rEd81K5JLyXKgtVs5HC19MCFEP5hGs+btdY/A37mo7YEFKUU0xMipIQihPAbmYk5DtMTbJNmJIrWmsv/8BFPbznu76YIISaIBPg45CZGUNPaRXNHj7+bQmlDB/tONLPlWP2A4/vKm2XGqBBBSgJ8HPISPSNRav3fC99V2gRASX2H91hzZw9f+ONmntlW4qdWCSFOp3HVwKe63ATPSJTqNpZkxtDQ3k1YiJEws/Ez37flaD2fFDdwtLaN1Ogw7r5o5rjbsqu0EYDS+g601iilOFbbhtOlKW/sHPfnCyEmHwnwcUi1h2EJMXC4po2mjm4u/O8PiAoz8dwtK0mwDb2u18aiGr72xHYAbBYTrQ4n31idTWxE6LjastPTA2/tctLY0UOM1UxxXTsANS1d4/psIcTkJCWUcTAY3CNRDte08Zt/FtLY0U1ls4PrHtlKbevg0Gxo7+ZHL+4lLzGCffdeyP/dvBxgUN36VHV293KwssVb0impdwf3sVpPgLc6xvX5QojJSQJ8nHITbGwvbuCF/DK+cVY2T3xtGRVNDq750xZe31NBj2f/TK01//LyPpo6uvndNYuwWUKYlxqFLdTE5iODA9zZ6+L5T0pH9QByf0UzTpdm3cJUwP1AE/i0Bz7EXyZCiMAnJZRxmp4QQWdPL+kxYXx/bR5hZiNP3rSMu17ay3ef20WCLZTM2HBaOp0UVbdyz8UzmZ0SCYDJaGBFTiybj9QN+twPDtdyz8v7WF9Yw59uWILBoIZtQ1/9e93CFO5/u8j7IPNorXuMek1rl7cuLoQIHtIDH6eF6XYMCn75+Xneh5crcmJ5/4dreOJry1iYbsdkMJAeE8bt507nm2flDHj/qumxlDZ0UNbQMeD4jhJ3KL9bUM3v3jv0mW3YVdpERkw4adHhJEaGUlLfgculOV7fTqjJQLfTRUunDCUUIthID3yczpwWS/5PLyDGah5w3GBQnDszgXNnJnzm+1dPjwPg46N1XBOT4T2+s6SJealRzEq28eCGI8xOieSiuclDfsau0iZW5MQAkBljpbShncoWB44eF2fkxLLlWD3VrQ6iwkPGc6tCiElGeuDjpJQaFN6nYnpCBAm2UD7qVwd39rrYXdbEksxofvH5ucxKjuSBd4buhVc0dVLV4mBRuh2AjNhwSuo7KPY8wOwLdhmJIkTwkQD3M6UUZ06LZcvROrTWABRWtdLZ08vizGhCTUa+uCSNIzVtg8os8GmpZVFGNACZMeHUtHZxoKIZgJU5sYCMRBEiGEmATwKrpsdR19ZNkWddlb5QXpLpDuXzPGWYDYU1g9772p4K4iLM3gejGbHhAGw6VIvVbGRuahQw9EgUrTW9Lu3juxFCTBQJ8ElgdW4cBgUv7SgHYGdpI4mRoaREuScDZcdZyY6zsv6kAK9pcbChsIarlqQRYnT/VmbGWgHYfryB7HgrEaEmrGbjkCWUn79ewCW//5BG2VVIiIAkAT4JJEeFsW5hKk9vLaGm1cGOkkaWZEYPGPZ33swEth6rp6P709EkL+08Qa9Lc/XSdO+xzBh3D7ynV5MT557YkxBpGbKEkl/SQFF1K9/8v3wcPb2n6/aEEKeJBPgkccfaXHp6NT9/rYDyxk4We2rafc6bmUC30+Wd9KO15q/5ZSzPimFafIT3PHt4CDaLe3BRTry7Nx5vCx1UQtFac7yugxmJNvJLGrnzhd24pJwiRECRAJ8ksuKsXLU4lX/sqwRgcebAAF+WFUNEqMlbB/+kuIHiunauWZY+4DylFJmeOnh2nDvAE2yh1LQM7IHXtnXR1uXkuuXp/Pjimby5v4r3iwbX2IUQk5cE+CTy3fNyCTEqzCYDczwPJfuYTQbOyo1jQ2E1b+2v4nfvHcYWauKSeYPHhmfGuIO7r2eeYLMM6oEfr3OPaMmKs3LjmVmYDIrtxxtPx20JIU4TmcgziaTHhHP7ubnUtjkINQ1eknbtrETe3F/Ft/+yA4AfXpA35NK12XFWDModzgAJkaF0dPfS1uUkItT9W37cs05KTlwElhAjc1Ii2Vk6dICXNXRgDTWNa7y7EML3JMAnmTvOzx32tc8vTCHSYiIpysK0+AisoUP/9t28OpuVObHesE6wuZeqrWlxEOHplRfXtxNiVKTY3SNdFmVE8/z2Unp6Xd4RLeCulV/zpy0syYrhD9ct8sk9CiF8Q0ooAcRkNHDhnCTmp9mHDW+AGKuZ1blx3u/71ibvX0Y5XtdOekw4Jk9YL86MxtHjorBy4O5CBZUtVDQ7yD/e4MtbEUL4gAT4FJAY6emB9wvw4rp2sj1jxuHTSUMnl1E2HaoFoLLZQXXL4KGIb+2v4vo/b5URLEL4gQT4FODtgXsCuG+lwr5RKgApURYSI0MHBfjGolrCPXX2PWVNgz77+e2lfHy0noYOmQwkxESTAJ8CIsNMmE0Gbw+8utW9UmFWvwBXSrE4I9o7jR+gxdHDjpJGrl2WgdGg2FPeNOBzHT29bPXsJlTVLGutCDHRJMCnAKXUgLHgfTv19O+BAyzOiKa8sdM7a3Pz4Tp6XZqL5iYxM8nGnrLmAed/UtyAo8e941ClBLgQE04CfIpI6Dcbsy/As04O8Ew74F6LHNz1b1uoiUUZdhak29lT3jSg1r2xqJa+jYKqmjtP7w0IIQaRAJ8i+k/mOV7n3qknOdIy4Jw5KVGYjQa2HK3D5dJsLKpldW4cIUYDC9PttDqcFHs2TAbYdKiGVdPjMBmU9MCF8AMJ8CkiO95KcV07+ccbKK7rICvWOmifTUuIkYUZdp7aUsKiX7xLVYuDc/LiAffWcfDpg8yyhg6O1razZkYCiZGWUdfAHT29PLTh8IBFuYQQYyMBPkV8+5xppEWHcduzOymoaCYrLnzI8x6+YQkPfGkBa2clsDwrhgtmJwLuaflWs9Eb4B8cdg8vPCcvnuQoy6h74OsP1vDAO4eGXNtcCHFqZCbmFBEVFsIfv7yYK//4MV1OF5cvTBnyvBirmS8uSeOLS9IGHDcaFPPSothd1kSvS7P+YA2p9jCmxVtJirJwoKJlVO3oG7VSUj94dyGAt/ZXkhQV5u3xCyGGN64euFLKrpR6USlVqJQ6qJQ6w1cNE743JyWKX6ybC0Begu2U378g3c6+E83Mv/dtNhTWcN7MBJRSnh54p3dLuM/SF+B9a7H0935hDd/+y05ufPwTTjTJQ1EhRjLeHvjvgbe01l9USpmBof9dLiaNq5elMyPJxqzkyJFPPsnl81PYW9ZMbmIEC9Pt3vJKUlQYjh4XzZ092MOHX/Cqrq2LwzVtwOAe+ImmTu78626mJ0RQ2dTJ95/fxXPfXOmd6n8qel0al9YD1nQRIhiNOcCVUpHA2cDXALTW3YBMxwsAC8ZYnpibGsVzt6wcdDzZs/VbZbMDe7iZj4/UsfVYPd8/P2/Ag9K+3ndeYgTH+41m6Xa6uP3ZnTh7NX/+6lJ2lzVy5wt7eHD9YX5w4YxTbuetz+ygqtnBK7etGrCrkRDBZjxdlBygFnhCKbVLKfWoUsp68klKqVuUUvlKqfza2tpxXE5MVkmeAO8bifLYR8U8uOEI//3eoQHnbT1Wj9Vs5NJ5KdS0dnlHorxbUM2u0iZ+feU8suOsfGFRGlctTuPBDUe48o+beWXXCYrr2ilv7Bhx9MrGohrePlDNnvJm8ktkfXMR3MYT4CZgMfC/WutFQDtwz8knaa0f0Vov1VovjY+PH8flxGTVvweutWZXWROWEAN/2HCEV3ef8J639VgDy7JjmJ7gXtK2r4yyp7wJs8nAxXOTvOf++sq5/Otls2ns6OH7L+zm3Ac2svo/3mfVfRuG3b+zp9fFL94oIDM2HJvFxF+2lpyuWxZiUhhPgJcD5VrrbZ7vX8Qd6GKKiY8IxaDcszFLGzpoaO/mnotmsjw7hh+9uJf3i2qoaXVwpKaNM3JivVu+lXjKKHvLm5iVHDmgZh1qMvL11dms/8E5PPfNlfzumoXcdu40Gjt6vKUYgOoWB2/tr6KiqZOnt5RwtLadf710NlctTuPNfVXUtw3ciUiIYDLmGrjWukopVaaUmqG1LgLWAgW+a5oIFCajgQSbeyz4rtImAFbkxHLFwlSu//NWbn5yO2fluv/1tbJfgB+v78Dl0uw/0cIXFqUO+dkGg+KMabGAexLQox8Ws+lQLWtmJADws1cP8NaBKgCUgrNy41g7K4HM2HCe/Pg4f80v5ztrpp3O2xfCb8Y7CuW7wDOeESjHgJvG3yQRiJKiLFS1ONhV2ki42Uheog2jQfHyrWfy45f38eruCiJCTcxJicRkNBAXYaakvp3j9e20dTmZlxY14jUsIUZW5sSyqagWLofmjh42FNZwxYIUFmXYKapq5TtrpqGUIjfRxorsGJ79pIRvnZ0zaNapEMFgXAGutd4NLPVNU0QgS46ycLimjebOHhak2TF6AjPcbOJ31yxk1bQ4lMI7LDAz1j21f98J9wqH81JHDnBwz/z89zcKKK3vYMuxOrp7XXx9dfaQI2tuWJnJd5/bxXPbS/nyikzf3KgQk4gMlBU+kRRl4URjJwUVLSzKsA94TSnF1cvS+dLSdO+xzNhwSuo72FveTKjJQK7nweZI1sxwl2I2HarhlV0VZMdZmT9M7/2SecmcnRfPva8dYFu/urkQwUICXPhEcpSFzp5enC7NoozoEc/PirVS2exg+/EGb1llNLLjrGTEhPO3HeVsLa7nigUpw471NhoUf7huEekx4XznmZ2UNQw9fV+IQCUBLnwiKSrM+/Vo1jHpe5C5t7x51OUTcPfm18yIZ295M1rDumHWdOkTFRbCYzcuw9nr4t9e3T/q6wSymhYHLY4efzdDTAAJcOETfWPB02PCiLeFjnh+Vr8Nleel2U/pWn1L3M5PiyInfuTSS3aclSsXp7HlWD3dTtcpXSsQ3fjEdn71xkF/N0NMAAlw4RNJns0hFqWPXD6BgQE+XA17OGdMiyUp0sINK0f/YHJlTiyOHhd7T9rXMxiV1LdztLbN380QE0CWkxU+kRRlISfeyoVzEkd1flR4CPbwELp6XEwbRS+6v3Czia3/svaU3rMiOwZwT+dfmhVzSu8NJO1dTjq6e2WHpClCAlz4RIjRwIYfrjml9+Ql2jAovEMOT6doq5mZSTa2Hmvg9vNO++VG5b2CajYdqqWouhWr2cjjX1s27sW36jwzT6tbHPS69IT8vxX+IwEu/ObBaxcxkYsFrsyJ5fntpXQ7XZhNo68ednQ7CQsx+nRlw55eF7c+s5MQo8IebuZEUye1bV0k2Cwjv/kz1Hr2PXW6NHVtXSRGju/zxOQmNXDhN0lRlgkNmLHUwRvbu1nx6/U8vOmYT9tyrLad7l4Xv/rCPH7x+TkAlDWMfxOLvgAHqJBNMYKeBLiYMvrq4NuKG0b9nld2n6DV4eSPG4/Q3OG7oXmFVe4t6GYk2UiLdg+pLG8c/zj1un6Ld412o2kRuCTAxZTxaR18dLMytda8sL2MVHsYrQ4nj33ku154UVUrRoMiJ95KWrR7DL0vJhoN6IFLgAc9CXAxpazMiSX/eCMl9e24XJrS+g7+5/0j3PPS3kElh/0nWiisauXba6ZxybwkHt98nMZ232w6VVTVSk6clVCTkXCzibgIs29KKG3dxEWYsYQYqJQSStCTh5hiSjk7L44nPz7OOfdvJCzESKdncwiz0cC7BdU8dP1i7/K1L+SXEmoycMWCFFZkx/Dm/ir+9MEx7rl45rjbUVTdOmDGalp0OGU+KKHUtnYRFxGKzRIiQwmnAAlwMaWcOyOB129fzYGKZgqrWkmKsnDZ/GQcPS6+9XQ+Nzy2ja+szOSaZem8uruCS+YlExUWQlRYCOsWpPDnD4+RHRfONcsyxtyGti4n5Y2dXLvs08W90mPC2V02/i3g6tq6iLeF0uvSVDRLDzzYSYCLKUUpxby0qCHXH3/ltlX8++sFPLOthCc/Pg7A1f1WUPzlF+bR2NHD3S/t40RjJ3dekDemoYVFVa0AzEiK9B5Ljw7jzX2VOHtdo17YC9yBbVCKGKsZcPfAc+KsKKX4+GjdqD7j2W2lvFtQxRM3LT+FuxCTgdTAhfCwWUK4/0sL2HzPefzggjy+ekamd+QKQESoiUdvXMo1S9N5cMMRXttTMabr9AX4zCSb91h6TDhOl6aqZfiyh6Onl7augZs63/qXnXz/hd2A+6FrXw88xW6husWBs3fktV8+PFzL+0W1PhkFIyaWBLgQJ0mwWfje2lz+fd3cQTv5hBgN3HfVPOJtobx3sGbI939wqJbNR4bv/RZVtWA1G0m1f7qCY7pnKOFnPci884XdfPnPW73fdztd7C5rYr9nU4zWLiddThdxEaEkR4Xh0lDTOvKeoH2jVbYeG/3wSjE5SIALcYqUUpydG8+Hh2vpdekBr206VMtNT27nxsc/YWPRpwHf4uihy+l+YFpY1Upekm3AXw7pMZ6hhMP0gqtbHLx9oIo95c00d/Z4PqeF7l4XDe3d1LV1UecJ63hbKMl29wSpylHUwftG34x2eKWYPCTAhRiDc2bE09TRM2BWZ0FFC7f+ZQe5CRHkJdq49ZmdbD5Sx3+9U8SKX63n6j9tpb3LSVF164DyCUByVBgGBeXDjAV/aWc5fX9X7Cp1P+zcU97sff1Qdat3DLi7B94X4ANLMr0uPWCt8G6nyzv5RwI88EiACzEGZ0137/G56VAt4H6YePOT27FZQnjipmU8efMy4iJC+fKj23hwwxGWZ8ewr7yJrz7+CU0dPcxIHBjgZpOBpEgLZY2De8xaa/6WX878tCiMBsWOEneA7ytvItSzpsvh6jZq2/r1wD0bbFQ2DQzwxz46xtm/fd+7Lnp1iwOtYU5KJOWNnbJrUYCRABdiDKKtZhak2b0B/p/vHKKurYtHb1xKclQYCTYLT399OV9ekcGrt63iqZuX85sr53nDt/8IlD5pMeFDBuj2440U17Xz1TOymJVs837G3vJmVubEYrOYOFTd6i2hxEWYibSYsJqNg4YSvrm/iqaOHu8DyxOe8smVi9MA6YUHGglwIcbonLx49pQ1seVoPS9sL+UrZ2Qyt9/2cJmxVn71hXks8EzYuWZZBndfNJNYq5nZKYMDPD06nPIheuB/zS/DajZyybwklmREs7usiVZHD4eqW1mQFkVeos3bAzcaFNHhZpRSJNvDBvTAmzt62FPWBEBxXTvwaY38nLx4YqxmtkiABxQJcCHG6Oy8eFwavv2XHUSGhXDH2twR3/OdNdPY/pPziQoLGfRaekwY1a0O78NOcK+G+I+9lVy+IIVws4nFmdF0dPfy8s4TuLR7O7q8xAgO1bR6ZmGavQ9Hk6MsAx5ifnSkzltH7wvwCk/Ap9rDWJkTw7ZjDWg98MGsmLwkwIUYowVpUUSFhdDc2cOd5+dhDzeP6n0nD03skx4djtZwol8v/GevHaCn18XXVmUBsCTTvWVd30SjBWlR5CbYaOrooaiqlbiIT/cjTYkKG/AQ84NDtdgsJqLCQjjWrwduDw8hzGzkjJxYTjR1DjuU8d9fL+A/3ioc1T2KiSEBLsQYmYwGLpqTxOzkSK5fMfap9X3SYzxjwT0B/o+9lby2p4Lvrc1lpqdmnmoPIynSQnFdO0mRFhIiLeR5HojuO9E8YEPppCgLtW1ddDtdaK354HAtq6bFMS3eSnHtpz3wFM8Dz741YD4aYgx7t9PF89tLeXln+bjvU/iOBLgQ4/CbK+fx6u2rCDmF6e/D6RsL/thHxfw1v4yfvrKP+WlRfGfNNO85SilvL7xvM+i8RPeeoi7NgB74rGQbWsOTHxdztLaNymYHZ+fFkxVn7VdC6STFM2Z8WnwEGTHhvFtQNahte8qb6Ojupbqla0LXGdday8iYzyABLsQ4GAzKJ+ENkGiz8IVFqewqaeSuF/fS3t3Lf35pwaDPX+wJ8L6Ho/G2UG9NvX8P/HNzkrhkXhL3vVnIf75zCHCvxpgTZ6WqxUFHt5PKZod3yKFSis/NSWTzkXpaHQM3r+g/s9QXi26N1pMfH+es377PwcqWCbtmIJEAF2KSMBgU/33NQnb/7ELe+O5qXrl1FbknjRcHWD09DpNBeUseSilvL7x/D1wpxW+/uIDsOCtv7q/ybB4RTnac+9yCihaaO3tI6Tel/8I5SXT3urzDI/tsPlLHjEQbIUbF7rJmJkJFUycPvF0EwCensIvSVCIBLsQkYzQo5qZGDTnUENzbsO2793Mszoj2Hpue4A76/j1wcC/A9aevLCUi1MQFsxMByI6zArD5iHvIYF8JBWBxRjRxEWbePlDtPdbe5WRXaRPnzkxgdnKkdyji6dB/BMy9rx2gV2vs4SHe2adioHEvJ6uUMgL5wAmt9WXjb5IQYiRhZuOA7/t64PERoYPOnZ4QwYd3nYs11P3jnhXnfli62bPcbP8euNGgOH9WIm/sraTL2UuoycgnxxtwujSrpsfS0e3k5Z0n6HVpjMOMphmrbcfqufGJT5iZFMnslEjeKajm7otmsre8iZ2lTT69VrDwRQ/8DuCgDz5HCDFGa2YksDjDzqzkwSUXcM8cNXum3YebTSRFWry92r51U/p8bk4SbV1Othx199A3H67DbDSwNDOGBWl22rqcHK1t82n7Wxw9/OCve4i1hqJxr1E+M8nGN87KZlGGndKGjgEbNp+q0voOXK7gG98+rgBXSqUBlwKP+qY5QoixyI6z8vKtq0Y9Fj07zkpPr0YpSIwcGOBnTIvFajby0s4TOHp62Xy0niWZ0YSZjSzMsAOwexRlFGevi5rW0Y1Y+flrBVQ2d/KH6xfx6m2r2P6T8/nbt88gxGjwlop2jbEXXtbQwbn/uZF/7Ksc0/sns/H2wH8H3AWMvGq8EGLSyI5318ETbZZBo1wsIUauWJjK63sqWPrL9zhY2cKq6e4HptmxVmwW06jq4P/xViHn/HbjiMMO39pfxUs7y7n93OnesI63uff1BJibGoXJoMZcB99R0kivS1MQhCNZxhzgSqnLgBqt9Y4RzrtFKZWvlMqvra39rFOFEBMkx/MgM9luGfL1X6ybw9NfX85l85PJS4zgknnJgHukzII0O3v6LaM7lOoWB09tKaGzp5eHNx0d9jyXS/PbtwqZmWTju8MsRWAJMTI7JZKdYwzwvZ5ld/smLwWT8fTAVwFXKKWOA88D5yml/nLySVrrR7TWS7XWS+Pj48dxOSGEr2TFugO8bxbmyUxGA2flxnPfVfN5585zyImP8L62ID2KwspWHD29Q74X4H83HqXXpTk7L55nPyml2rNVXEN7N0dqWr3nbTpUy7G6dr6zZtpnjqdfnBHN3vLmUW0Rd7K+NduP10uAe2mtf6y1TtNaZwHXAhu01jf4rGVCiNOmr4SSMkwP/LMszYrB6dK8sXfomnJlcyfPbivlS0vS+OW6ufS6NA9vOsq+8mYu/v0HXPLgRxRWucsZj28uJjEy1NvDH86iDDsd3b0cqj61h6fOXhf7Kzw98Lr2oHuQKePAhZiCMmLCWZBuZ2VO7Cm/95zceBZl2LnvzULvjM3nPill6S/f5eYnt/ODF/ag0dx27nQyYsO5clEqz2wr5Ut/+hiTwUCkJYQ7ntvNvvJmPjxcx1fPyBpxNuuidHdt/FTLKEdq23D0uFieHUOX00XlZ2waHYh8EuBa640yBlyIwBFiNPDqbatYOyvxlN9rMCjuvXwO9e1d/GHDEd4rqOYnf99Hgs3C8fp2thyr5/rlGd7FuW4/bzpomJ0cyau3r+KBL82nqLqVGx7bRqjJwPXLR14ILD0mjLiI0EEzREey1zNrdN3CFCD46uDjnsgjhJh6FqTbuXpJOo9/VMzTW0qYmxrF87esJNxsorG9G5vl02jJjLXywV3nEhthJsRoYM2MBG5alcUTm49z3fIMoq0jD31USnH98nQe3HCEPWVN3nVgRrKnvAlbqInzZiYAUFzXxurcuDHd82QkJRQhxJj86KIZhJuNxNnMPHbjMsLN7tCOtpoxnVQSSYoaOFzx7otmctdFM7jzgpE3wehzyznTiLWa+c2bB0e96cS+E83MTY0iKdJCuNnoXQc9WEiACyHGJC4ilDe+exav3rZ60BosI7GEGLl1zXQSbKN/iBoRauKO83PZeqyBjUUjl1K6nL0crGxhfnoUSimy+y2jGywkwIUQY5YRG07MKEogvnLd8gyyYsP59T8PejdkHk5RVSs9vZr5qXaAQQG+p6yJv+8q59EPj5F/3PerHda0ODh+mv/CkBq4ECJghBgN/Nvls/nW0ztYc//7fHFJOj/63AzvXyLOXhd3vLAbgB6ne8x438YXOXFW/rmvkm6ni81H6rjpye3ezzUaFL+5ch5XL02nptXBg+sPMzMpkhtWZn5mez4+Usec1Kgh9zj96Sv72VbcwPofnjNgmV9fkgAXQgSU82YmsvFH5/LwxqM8v72Unl4XD3xpAQD5JY38Y28lsVYz9e3dpNrDSIt2T1bKjrfi0lDa0MGfPzxGcpSFZ76xAmuoif/3tz3c9eJethyt572Calq7nAB0dvfyzbNzhmzHm/sq+c4zO/nG6mx+etnsQa/vP9FMc2cPv3yjgN9du+i0/L+QEooQIuCk2sP4xefnsm5hKu8cqKLb09t+t6Aas9HAprvOZfe/XcA/vrcapdzL3vZtZPHmvko+PlrPV8/IIic+gsRIC4/duIx1C1P4+64TLMyw8+6dZ3PpvGR+9c+DPLzp6KAJQOWNHdz90l4A3thbOej1po5uKpodpERZeGV3BR8ePj3LiEiACyEC1sVzk2hxOPn4aB1aa94tqObM6bFEhJqwh5sHrM6Y7Vk+4I8bj2IJMXDd8nTva2aTgf++eiHv/eAc/u/m5eQm2vj9tQu5dF4y971ZyJoHNvLIB0fZW97EiaZOvv/8brSGH16QR1WLgx0nTTAqrHIvF3DvFXPIibPyk7/vp7N7+KUHxkoCXAgRsFbnxhERauLNfVUcqm6jtKGDC2cnDXluVHgIMVYznT29XLU4bdDSuwaDYnpChLfHbjIaePC6RTx43SISI0P59T8LueKhzay6bwP5JY386sp53LQ6m1CTgTf2VAz4rL49PBem2/nlF+ZS1tjBpkM1Pr9/qYELIQJWqMnI+bMSeLugiiTPxhTnz0oY9vzsOCsN7d3ctCprVJ9vNCiuWJDCFQtSOFLTxrHaNurauom3hXq3qDtvZgL/2FfFv10+x7tLUWFlK7FWM/G2UBIiLaz/wcAFwXxFAlwIEdAunpfMK7srePTDYyxMt5MQOfzY8qsWp7EkM9q7h+ipmJ4QwfSEwSF82fwU3txfxbZj9Zw53T3L82BVC7OSI729+dMR3iABLoQIcOfkxRNuNtLe3evtFQ/n+hUjr7tyqs6bmUC42cjreys5c3ocvS5NUVUrXxlhCKIvSA1cCBHQLCFG71onF44Q4KdDmNnI+bMS+ee+Sjq6nRTXtdPldDErOfK0X1t64EKIgPe9tbnMSYkassQxEb56Riav7angb/nl3klFM4fZYNqXJMCFEAEvL9FGXuLpD8zhLM2KYUlmNH/+8BiXzk/G5BnRcrpJCUUIIXzglrNzKG/s5NmtpUyLjyDUZDzt15QAF0IIH7hgViI5cVZau5zMmoDyCUiACyGETxgMim+c5V43ZSIeYILUwIUQwmeuXJzK8fp2Ll+QMiHXkwAXQggfsYQY+ZdLZk3Y9aSEIoQQAUoCXAghApQEuBBCBCgJcCGECFAS4EIIEaAkwIUQIkBJgAshRICSABdCiACltNYjn+WriylVC5SM8e1xQJ0Pm+MPcg+TQzDcAwTHfcg9jE6m1jr+5IMTGuDjoZTK11ov9Xc7xkPuYXIIhnuA4LgPuYfxkRKKEEIEKAlwIYQIUIEU4I/4uwE+IPcwOQTDPUBw3IfcwzgETA1cCCHEQIHUAxdCCNGPBLgQQgSogAhwpdRFSqkipdQRpdQ9/m7PaCil0pVS7yulDiqlDiil7vAcj1FKvauUOuz5Ndrfbf0sSimjUmqXUuoNz/cB1X4ApZRdKfWiUqrQ8/txRqDdh1LqTs+fo/1KqeeUUpbJfg9KqceVUjVKqf39jg3bZqXUjz0/40VKqc/5p9UDDXMP93v+LO1VSv1dKWXv99qE3sOkD3CllBH4H+BiYDZwnVJqtn9bNSpO4Ida61nASuA2T7vvAdZrrXOB9Z7vJ7M7gIP9vg+09gP8HnhLaz0TWID7fgLmPpRSqcD3gKVa67mAEbiWyX8PTwIXnXRsyDZ7fjauBeZ43vNHz8++vz3J4Ht4F5irtZ4PHAJ+DP65h0kf4MBy4IjW+pjWuht4Hljn5zaNSGtdqbXe6fm6FXdopOJu+1Oe054CPu+XBo6CUioNuBR4tN/hgGk/gFIqEjgbeAxAa92ttW4iwO4D9/aHYUopExAOVDDJ70Fr/QHQcNLh4dq8Dnhea92ltS4GjuD+2feroe5Ba/2O1trp+XYrkOb5esLvIRACPBUo6/d9uedYwFBKZQGLgG1Aota6EtwhDyT4sWkj+R1wF+DqdyyQ2g+QA9QCT3hKQY8qpawE0H1orU8ADwClQCXQrLV+hwC6h36Ga3Og/pzfDLzp+XrC7yEQAlwNcSxgxj4qpSKAl4Dva61b/N2e0VJKXQbUaK13+Lst42QCFgP/q7VeBLQz+UoNn8lTJ14HZAMpgFUpdYN/W+VzAfdzrpT6Ce5S6TN9h4Y47bTeQyAEeDmQ3u/7NNz/fJz0lFIhuMP7Ga31y57D1UqpZM/ryUCNv9o3glXAFUqp47jLVucppf5C4LS/TzlQrrXe5vn+RdyBHkj3cT5QrLWu1Vr3AC8DZxJY99BnuDYH1M+5UupG4DLgy/rTyTQTfg+BEODbgVylVLZSyoz7IcFrfm7TiJRSCnfd9aDW+r/6vfQacKPn6xuBVye6baOhtf6x1jpNa52F+//5Bq31DQRI+/torauAMqXUDM+htUABgXUfpcBKpVS458/VWtzPVALpHvoM1+bXgGuVUqFKqWwgF/jED+0bkVLqIuBu4AqtdUe/lyb+HrTWk/4/4BLcT3uPAj/xd3tG2ebVuP/5tBfY7fnvEiAW99P3w55fY/zd1lHcyxrgDc/Xgdj+hUC+5/fiFSA60O4D+DlQCOwHngZCJ/s9AM/hrtn34O6dfv2z2gz8xPMzXgRc7O/2f8Y9HMFd6+77uX7YX/cgU+mFECJABUIJRQghxBAkwIUQIkBJgAshRICSABdCiAAlAS6EEAFKAlwIIQKUBLgQQgSo/w8KDb5ATU2kuAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vector to text</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">ECFP6</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Vec_To_Text_Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">ECFP6</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">encoder_d_in</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">encoder_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">encoder_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span>
            <span class="n">d_vocab</span><span class="p">,</span>
            <span class="n">d_embedding</span><span class="p">,</span>
            <span class="n">encoder_d_in</span><span class="p">,</span>
            <span class="n">encoder_dims</span><span class="p">,</span>
            <span class="n">encoder_drops</span><span class="p">,</span>
            <span class="n">d_hidden</span><span class="p">,</span>
            <span class="n">n_layers</span><span class="p">,</span>
            <span class="n">d_latent</span><span class="p">,</span>
            <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
            <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
            <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
            <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
            <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
            <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fa7a9266d90&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># text to text</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Scaffolds</span> <span class="kn">import</span> <span class="n">MurckoScaffold</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">to_mol</span><span class="p">,</span> <span class="n">to_smile</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">source_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_smile</span><span class="p">(</span><span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">target_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">source_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">target_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source_smiles</span><span class="p">))]</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">VAE_Seq2Seq_Dataset</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LSTM_VAE</span><span class="p">(</span>
                <span class="n">d_vocab</span><span class="p">,</span>
                <span class="n">d_embedding</span><span class="p">,</span>
                <span class="n">d_hidden</span><span class="p">,</span>
                <span class="n">n_layers</span><span class="p">,</span>
                <span class="n">d_latent</span><span class="p">,</span>
                <span class="n">input_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">lstm_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
                <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
                <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
                <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>


<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fa7a92b2350&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vec to text</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Scaffolds</span> <span class="kn">import</span> <span class="n">MurckoScaffold</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">to_mol</span><span class="p">,</span> <span class="n">to_smile</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">source_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_smile</span><span class="p">(</span><span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">target_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">source_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">target_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source_smiles</span><span class="p">))]</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">Vec_To_Text_Dataset</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">ECFP6</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">encoder_d_in</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">encoder_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">encoder_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span>
            <span class="n">d_vocab</span><span class="p">,</span>
            <span class="n">d_embedding</span><span class="p">,</span>
            <span class="n">encoder_d_in</span><span class="p">,</span>
            <span class="n">encoder_dims</span><span class="p">,</span>
            <span class="n">encoder_drops</span><span class="p">,</span>
            <span class="n">d_hidden</span><span class="p">,</span>
            <span class="n">n_layers</span><span class="p">,</span>
            <span class="n">d_latent</span><span class="p">,</span>
            <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
            <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
            <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
            <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
            <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
            <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fa7a9202cd0&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vec to text with rollout</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Scaffolds</span> <span class="kn">import</span> <span class="n">MurckoScaffold</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">to_mol</span><span class="p">,</span> <span class="n">to_smile</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">source_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_smile</span><span class="p">(</span><span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">target_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">source_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">target_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source_smiles</span><span class="p">))]</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">Vec_To_Text_Dataset</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">ECFP6</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">encoder_d_in</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">encoder_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">encoder_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>
<span class="n">forward_rollout</span><span class="o">=</span><span class="kc">True</span>
<span class="n">p_force</span><span class="o">=</span><span class="mf">1.</span>
<span class="n">force_decay</span><span class="o">=</span><span class="mf">0.9</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span>
            <span class="n">d_vocab</span><span class="p">,</span>
            <span class="n">d_embedding</span><span class="p">,</span>
            <span class="n">encoder_d_in</span><span class="p">,</span>
            <span class="n">encoder_dims</span><span class="p">,</span>
            <span class="n">encoder_drops</span><span class="p">,</span>
            <span class="n">d_hidden</span><span class="p">,</span>
            <span class="n">n_layers</span><span class="p">,</span>
            <span class="n">d_latent</span><span class="p">,</span>
            <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
            <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
            <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
            <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
            <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
            <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">forward_rollout</span><span class="o">=</span><span class="n">forward_rollout</span><span class="p">,</span>
            <span class="n">p_force</span><span class="o">=</span><span class="n">p_force</span><span class="p">,</span>
            <span class="n">force_decay</span><span class="o">=</span><span class="n">force_decay</span>
        <span class="p">)</span>

<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fa7a911b510&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

