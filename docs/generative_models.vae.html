---

title: VAE Model

keywords: fastai
sidebar: home_sidebar

summary: "VAE-type models"
description: "VAE-type models"
nb_path: "nbs/11_generative_models.vae.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/11_generative_models.vae.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VAE-Models">VAE Models<a class="anchor-link" href="#VAE-Models"> </a></h2><p>Variational Autoencoders (VAEs) are a class of generative model that follows an encoder-decoder framework. The encoder maps an input down to a latent vector. The decoder reconstructs the input, and the model is trained on the quality of the reconstruction. VAEs impose a Gaussian prior on the latent space by regularizing the deviation of latent vectors from a unit Gaussian. As a result, we can easily sample valid latent vectors by randomly sampling from a Gaussian distribution.</p>
<p>When dealing with generating text sequences (SMILES, amino acids, etc), we train the model in a self-supervised fashion using next token prediction. In this framework, the decoder module is a conditional LSTM. These models are very similar to the <a href="/mrl/generative_models.lstm_lm#Conditional_LSTM_LM"><code>Conditional_LSTM_LM</code></a> model, with the added constraint on the latent space.</p>
<p>During generation, we sample from the model in an autoregression fashion. Given an input token, the model predicts aa distribution of tokens over the next token. We then sample from that distributiona and feed the selected token back into the model. We repeat this process until either an end of sentence (EOS) token is predicted, or the generated sequence reaches a maximum allowed length.</p>
<p>During sampling, we save the log probability of each token predicted. This gives us a probability value for the model's estimated likelihood of the generated compound. We can also backprop through this value.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VAE-Transition">VAE Transition<a class="anchor-link" href="#VAE-Transition"> </a></h2><p>The <a href="/mrl/generative_models.vae#VAE_Transition"><code>VAE_Transition</code></a> class converts an input vector to a valid latent vector. Following standard VAE implementations, the input vector is used to predict a vector of means and a vector of log variances which parameterize a Gaussian distribution. We then use the <a href="https://gregorygundersen.com/blog/2018/04/29/reparameterization/">Reparametarization Trick</a> to sample a latent vector from that distribution.</p>
<p>The module returns the latent vectors and a KL-loss based on the latent distributions deviations from a unit Gaussian.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAE_Transition" class="doc_header"><code>class</code> <code>VAE_Transition</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAE_Transition</code>(<strong><code>d_latent</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>VAE_Transition - converts an input vector to
a latent vector using the reparametarization trick</p>
<p>Inputs:</p>

<pre><code>d_latent int: latent variable dimensions</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VAE">VAE<a class="anchor-link" href="#VAE"> </a></h2><p><a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a> is the base class for VAE models. VAE models consist of a encoder, decoder, and transition modules.</p>
<p>The encoder module maps the model's inputs down to a vector. The model will work with any of the <a href="/mrl/layers#Encoder"><code>Encoder</code></a> subclasses in the <code>layers</code> section. Custom encoders aso work so long as they are compatible with the data format you are using and produce a single vector per batch item.</p>
<p>The transition module converts the encoder output to a valid latent vector. By default, VAEs use the <a href="/mrl/generative_models.vae#VAE_Transition"><code>VAE_Transition</code></a> which samples a latent vector assuming a target distribution of a unit Gaussian. This can be substituted for any module that returns latent vectors and a KL loss term (0 if not applicable).</p>
<p>The decoder module uses the latent vector to reconstruct the input.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAE" class="doc_header"><code>class</code> <code>VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L47" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAE</code>(<strong><code>encoder</code></strong>, <strong><code>decoder</code></strong>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.generative_base#GenerativeModel"><code>GenerativeModel</code></a></p>
</blockquote>
<p>VAE - base VAE class</p>
<p>Inputs:</p>

<pre><code>encoder nn.Module: encoder module

decoder nn.Module: decoder module

prior Optional[nn.Module]: prior module

bos_idx int: BOS token

transition Optional[nn.Module]: transition module

forward_rollout bool: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models

p_force float: teacher forcing probabiliy

force_decay float: rate of decay of p_force</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">LSTM_Encoder</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">Conditional_LSTM_Block</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Conditional_LSTM_Block</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Conditional_LSTM_Block</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">o</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">lpg</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">set_prior_from_encoder</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>

<span class="n">o</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">lpg</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">lpg</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">loc</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<span class="n">latent</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">128</span><span class="p">))</span>
<span class="n">o</span><span class="p">,</span><span class="n">lp</span><span class="p">,</span><span class="n">lpg</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">latent</span><span class="o">=</span><span class="n">latent</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preset-VAEs">Preset VAEs<a class="anchor-link" href="#Preset-VAEs"> </a></h2><p>The following modules are preset encoder-decoder configurations.</p>
<p><a href="/mrl/generative_models.vae#LSTM_VAE"><code>LSTM_VAE</code></a> has a LSTM encoder and a conditional LSTM decoder. This works for most sequence to sequence type tasks.</p>
<p><a href="/mrl/generative_models.vae#Conv_VAE"><code>Conv_VAE</code></a> replaces the LSTM encoder with a 1D conv encoder (the model is still intended for sequences, not 2D images). The convolutional encoder tends to be faster and lighter than the LSTM encoder. Anecdotally, it seems to perform better than the LSTM encoder.</p>
<p><a href="/mrl/generative_models.vae#MLP_VAE"><code>MLP_VAE</code></a> uses a MLP encoder. This model works best for reconstructing a sequence from a fingerprint, property vector, or something similar.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_VAE" class="doc_header"><code>class</code> <code>LSTM_VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L347" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_VAE</code>(<strong><code>d_vocab</code></strong>, <strong><code>d_embedding</code></strong>, <strong><code>d_hidden</code></strong>, <strong><code>n_layers</code></strong>, <strong><code>d_latent</code></strong>, <strong><code>input_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>lstm_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>condition_hidden</code></strong>=<em><code>True</code></em>, <strong><code>condition_output</code></strong>=<em><code>True</code></em>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a></p>
</blockquote>
<p>LSTM_VAE - VAE with LSTM encoder and conditional LSTM decoder.
Usable for text-to-text or seq-2-seq tasks or similar</p>
<p>Inputs:</p>

<pre><code>d_vocab int: vocab size

d_embedding int: embedding dimension

d_hidden int: hidden dimension

n_layers int: number of LSTM layers (same for encoder and decoder)

d_latent int: latent variable dimension

input_dropout float: dropout percentage on inputs

lstm_dropout float: dropout on LSTM layers

condition_hidden bool: if True, latent vector is used to initialize the
hidden state

condition_output bool: if True, latent vector is concatenated to
the outputs of the embedding layer

prior Optional[nn.Module]: prior module

bos_idx int: BOS token

transition Optional[nn.Module]: transition module

forward_rollout bool: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models

p_force float: teacher forcing probabiliy

force_decay float: rate of decay of p_force</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">LSTM_VAE</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Conv_VAE" class="doc_header"><code>class</code> <code>Conv_VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L426" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Conv_VAE</code>(<strong><code>d_vocab</code></strong>, <strong><code>d_embedding</code></strong>, <strong><code>conv_filters</code></strong>, <strong><code>kernel_sizes</code></strong>, <strong><code>strides</code></strong>, <strong><code>conv_drops</code></strong>, <strong><code>d_hidden</code></strong>, <strong><code>n_layers</code></strong>, <strong><code>d_latent</code></strong>, <strong><code>input_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>lstm_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>condition_hidden</code></strong>=<em><code>True</code></em>, <strong><code>condition_output</code></strong>=<em><code>True</code></em>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a></p>
</blockquote>
<p>Conv_VAE - VAE with 1D Conv encoder and conditional LSTM decoder.
Usable for text-to-text or seq-2-seq tasks or similar</p>
<p>Inputs:</p>

<pre><code>d_vocab int: vocab size

d_embedding int: embedding dimension

conv_filters list[int]: filter sizes for conv layers ie `[64, 128, 256]`

kernel_sizes list[int]: kernel sizes for conv layers ie `[5, 5, 5]`

strides list[int]: strides for conv layers ie `[2, 2, 2]`

conv_drops list[float]: list of dropout pobabilities ie `[0.2, 0.2, 0.3]`

d_hidden int: hidden dimension

n_layers int: number of LSTM layers (same for encoder and decoder)

d_latent int: latent variable dimension

input_dropout float: dropout percentage on inputs

lstm_dropout float: dropout on LSTM layers

condition_hidden bool: if True, latent vector is used to initialize the
hidden state

condition_output bool: if True, latent vector is concatenated to
the outputs of the embedding layer

prior Optional[nn.Module]: prior module

bos_idx int: BOS token

transition Optional[nn.Module]: transition module

forward_rollout bool: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models

p_force float: teacher forcing probabiliy

force_decay float: rate of decay of p_force</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">Conv_VAE</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> 
               <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MLP_VAE" class="doc_header"><code>class</code> <code>MLP_VAE</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L513" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MLP_VAE</code>(<strong><code>d_vocab</code></strong>, <strong><code>d_embedding</code></strong>, <strong><code>encoder_d_in</code></strong>, <strong><code>encoder_dims</code></strong>, <strong><code>encoder_drops</code></strong>, <strong><code>d_hidden</code></strong>, <strong><code>n_layers</code></strong>, <strong><code>d_latent</code></strong>, <strong><code>input_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>lstm_dropout</code></strong>=<em><code>0.0</code></em>, <strong><code>condition_hidden</code></strong>=<em><code>True</code></em>, <strong><code>condition_output</code></strong>=<em><code>True</code></em>, <strong><code>prior</code></strong>=<em><code>None</code></em>, <strong><code>bos_idx</code></strong>=<em><code>0</code></em>, <strong><code>transition</code></strong>=<em><code>None</code></em>, <strong><code>forward_rollout</code></strong>=<em><code>False</code></em>, <strong><code>p_force</code></strong>=<em><code>0.0</code></em>, <strong><code>force_decay</code></strong>=<em><code>0.99</code></em>) :: <a href="/mrl/generative_models.vae#VAE"><code>VAE</code></a></p>
</blockquote>
<p>MLP_VAE - VAE with MLP encoder and conditional LSTM decoder.
Usable for reconstructing a sequence from a vector</p>
<p>Inputs:</p>

<pre><code>d_vocab int: vocab size

d_embedding int: embedding dimension

encoder_d_in int: encoder input dimension

encoder_dims list[int]: list of encoder layer sizes ie `[1024, 512, 256]`

encoder_drops list[float]: list of dropout pobabilities ie `[0.2, 0.2, 0.3]`

d_hidden int: hidden dimension

n_layers int: number of LSTM layers (same for encoder and decoder)

d_latent int: latent variable dimension

input_dropout float: dropout percentage on inputs

lstm_dropout float: dropout on LSTM layers

condition_hidden bool: if True, latent vector is used to initialize the
hidden state

condition_output bool: if True, latent vector is concatenated to
the outputs of the embedding layer

prior Optional[nn.Module]: prior module

bos_idx int: BOS token

transition Optional[nn.Module]: transition module

forward_rollout bool: if True, run supervised training using
rollout with teacher forcing. This is a technique used in some
seq2seq models and should not be used for pure generative models

p_force float: teacher forcing probabiliy

force_decay float: rate of decay of p_force</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> 
               <span class="n">condition_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">condition_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ints</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">condition</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">condition</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="mi">8</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">get_rl_tensors</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">condition</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAELoss" class="doc_header"><code>class</code> <code>VAELoss</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L592" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAELoss</code>(<strong><code>weight</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>VAELoss - loss for VAE models</p>
<p>Inputs:</p>

<pre><code>weight float: KL loss weight</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="vae_seq2seq_collate" class="doc_header"><code>vae_seq2seq_collate</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L610" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>vae_seq2seq_collate</code>(<strong><code>batch</code></strong>, <strong><code>pad_idx</code></strong>, <strong><code>batch_first</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VAE_Seq2Seq_Dataset" class="doc_header"><code>class</code> <code>VAE_Seq2Seq_Dataset</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/g_models/vae.py#L617" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VAE_Seq2Seq_Dataset</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <a href="/mrl/dataloaders#Text_Dataset"><code>Text_Dataset</code></a></p>
</blockquote>
<p>VAE_Seq2Seq_Dataset - seq to seq dataset for VAEs</p>
<p>Inputs:</p>

<pre><code>`sequences` - list[tuple], list of text tuples (source, target)

[`vocab`](/mrl/vocab) - Vocab, vocabuary for tokenization/numericaization

`collate_function` - batch collate function. If None, defauts to [`vae_seq2seq_collate`](/mrl/generative_models.vae#vae_seq2seq_collate)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># text reconstruction</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Text_Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LSTM_VAE</span><span class="p">(</span>
                <span class="n">d_vocab</span><span class="p">,</span>
                <span class="n">d_embedding</span><span class="p">,</span>
                <span class="n">d_hidden</span><span class="p">,</span>
                <span class="n">n_layers</span><span class="p">,</span>
                <span class="n">d_latent</span><span class="p">,</span>
                <span class="n">input_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">lstm_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
                <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
                <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
                <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>


<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fd00dde57b8&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># text reconstruction conv</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Text_Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">conv_filters</span> <span class="o">=</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">kernel_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">strides</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">conv_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Conv_VAE</span><span class="p">(</span>
                <span class="n">d_vocab</span><span class="p">,</span>
                <span class="n">d_embedding</span><span class="p">,</span>
                <span class="n">conv_filters</span><span class="p">,</span>
                <span class="n">kernel_sizes</span><span class="p">,</span>
                <span class="n">strides</span><span class="p">,</span>
                <span class="n">conv_drops</span><span class="p">,</span>
                <span class="n">d_hidden</span><span class="p">,</span>
                <span class="n">n_layers</span><span class="p">,</span>
                <span class="n">d_latent</span><span class="p">,</span>
                <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
                <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
                <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
                <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
                <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
                <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>


<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fd00dcfb128&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vector to text</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">ECFP6</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">Vec_To_Text_Dataset</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">ECFP6</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">encoder_d_in</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">encoder_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">encoder_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span>
            <span class="n">d_vocab</span><span class="p">,</span>
            <span class="n">d_embedding</span><span class="p">,</span>
            <span class="n">encoder_d_in</span><span class="p">,</span>
            <span class="n">encoder_dims</span><span class="p">,</span>
            <span class="n">encoder_drops</span><span class="p">,</span>
            <span class="n">d_hidden</span><span class="p">,</span>
            <span class="n">n_layers</span><span class="p">,</span>
            <span class="n">d_latent</span><span class="p">,</span>
            <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
            <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
            <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
            <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
            <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
            <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fd00343b518&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># text to text</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Scaffolds</span> <span class="kn">import</span> <span class="n">MurckoScaffold</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">to_mol</span><span class="p">,</span> <span class="n">to_smile</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">source_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_smile</span><span class="p">(</span><span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">target_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">source_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">target_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source_smiles</span><span class="p">))]</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">VAE_Seq2Seq_Dataset</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LSTM_VAE</span><span class="p">(</span>
                <span class="n">d_vocab</span><span class="p">,</span>
                <span class="n">d_embedding</span><span class="p">,</span>
                <span class="n">d_hidden</span><span class="p">,</span>
                <span class="n">n_layers</span><span class="p">,</span>
                <span class="n">d_latent</span><span class="p">,</span>
                <span class="n">input_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">lstm_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
                <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
                <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
                <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>


<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fd00346fac8&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vec to text</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Scaffolds</span> <span class="kn">import</span> <span class="n">MurckoScaffold</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">to_mol</span><span class="p">,</span> <span class="n">to_smile</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">source_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_smile</span><span class="p">(</span><span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">target_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">source_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">target_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source_smiles</span><span class="p">))]</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">Vec_To_Text_Dataset</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">ECFP6</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">encoder_d_in</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">encoder_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">encoder_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span>
            <span class="n">d_vocab</span><span class="p">,</span>
            <span class="n">d_embedding</span><span class="p">,</span>
            <span class="n">encoder_d_in</span><span class="p">,</span>
            <span class="n">encoder_dims</span><span class="p">,</span>
            <span class="n">encoder_drops</span><span class="p">,</span>
            <span class="n">d_hidden</span><span class="p">,</span>
            <span class="n">n_layers</span><span class="p">,</span>
            <span class="n">d_latent</span><span class="p">,</span>
            <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
            <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
            <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
            <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
            <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
            <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fd00340a908&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vec to text with rollout</span>

<span class="kn">from</span> <span class="nn">mrl.vocab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Scaffolds</span> <span class="kn">import</span> <span class="n">MurckoScaffold</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="n">to_mol</span><span class="p">,</span> <span class="n">to_smile</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">source_smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_smile</span><span class="p">(</span><span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">target_smiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">source_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">target_smiles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source_smiles</span><span class="p">))]</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">Vec_To_Text_Dataset</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">ECFP6</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">VAELoss</span><span class="p">()</span>

<span class="n">d_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>
<span class="n">d_embedding</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">encoder_d_in</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">encoder_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
<span class="n">encoder_drops</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">d_hidden</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">d_latent</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">n_layers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">input_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">lstm_dropout</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">bidir</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">condition_hidden</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">condition_output</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">bos_idx</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;bos&#39;</span><span class="p">]</span>
<span class="n">forward_rollout</span><span class="o">=</span><span class="kc">True</span>
<span class="n">p_force</span><span class="o">=</span><span class="mf">1.</span>
<span class="n">force_decay</span><span class="o">=</span><span class="mf">0.9</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">MLP_VAE</span><span class="p">(</span>
            <span class="n">d_vocab</span><span class="p">,</span>
            <span class="n">d_embedding</span><span class="p">,</span>
            <span class="n">encoder_d_in</span><span class="p">,</span>
            <span class="n">encoder_dims</span><span class="p">,</span>
            <span class="n">encoder_drops</span><span class="p">,</span>
            <span class="n">d_hidden</span><span class="p">,</span>
            <span class="n">n_layers</span><span class="p">,</span>
            <span class="n">d_latent</span><span class="p">,</span>
            <span class="n">input_dropout</span><span class="o">=</span><span class="n">input_dropout</span><span class="p">,</span>
            <span class="n">lstm_dropout</span><span class="o">=</span><span class="n">lstm_dropout</span><span class="p">,</span>
            <span class="n">condition_hidden</span><span class="o">=</span><span class="n">condition_hidden</span><span class="p">,</span>
            <span class="n">condition_output</span><span class="o">=</span><span class="n">condition_output</span><span class="p">,</span>
            <span class="n">prior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">bos_idx</span><span class="o">=</span><span class="n">bos_idx</span><span class="p">,</span>
            <span class="n">transition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">forward_rollout</span><span class="o">=</span><span class="n">forward_rollout</span><span class="p">,</span>
            <span class="n">p_force</span><span class="o">=</span><span class="n">p_force</span><span class="p">,</span>
            <span class="n">force_decay</span><span class="o">=</span><span class="n">force_decay</span>
        <span class="p">)</span>

<span class="n">to_device</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                                    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dl</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dl</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">to_device</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">batch_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fd00333ff28&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

