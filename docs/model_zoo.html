---

title: Model Zoo

keywords: fastai
sidebar: home_sidebar

summary: "Standard Pretrained Models"
description: "Standard Pretrained Models"
nb_path: "nbs/22_model_zoo.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/22_model_zoo.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch.utils.model_zoo</span> <span class="kn">import</span> <span class="n">load_url</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">S3_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;https://dmai-mrl.s3.amazonaws.com/mrl_public&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="LSTM-LM">LSTM LM<a class="anchor-link" href="#LSTM-LM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lstm_lm_small" class="doc_header"><code>lstm_lm_small</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lstm_lm_small</code>(<strong><code>vocab</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lstm_lm_large" class="doc_header"><code>lstm_lm_large</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L49" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lstm_lm_large</code>(<strong><code>vocab</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lstm_lm_small</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lstm_lm_large</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_ZINC" class="doc_header"><code>class</code> <code>LSTM_LM_Small_ZINC</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L81" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_ZINC</code>(<strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_zinc'</code></em>) :: <a href="/mrl/agent#GenerativeAgent"><code>GenerativeAgent</code></a></p>
</blockquote>
<p>GenerativeAgent - baseline agent for generative models</p>
<p>Inputs:</p>
<ul>
<li><p><code>model nn.Module</code>: model</p>
</li>
<li><p><code>vocab Vocab</code>: vocabulary</p>
</li>
<li><p><code>loss_function Callable</code>: loss function for supervised training. Should
function as <code>loss = loss_function(model_output, y)</code></p>
</li>
<li><p><code>dataset Base_Dataset</code>: dataset</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_ZINC_NC" class="doc_header"><code>class</code> <code>LSTM_LM_Small_ZINC_NC</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L112" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_ZINC_NC</code>(<strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_zinc_nc'</code></em>) :: <a href="/mrl/agent#GenerativeAgent"><code>GenerativeAgent</code></a></p>
</blockquote>
<p>GenerativeAgent - baseline agent for generative models</p>
<p>Inputs:</p>
<ul>
<li><p><code>model nn.Module</code>: model</p>
</li>
<li><p><code>vocab Vocab</code>: vocabulary</p>
</li>
<li><p><code>loss_function Callable</code>: loss function for supervised training. Should
function as <code>loss = loss_function(model_output, y)</code></p>
</li>
<li><p><code>dataset Base_Dataset</code>: dataset</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_ZINC</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_ZINC_NC</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conditional-LSTM-LM">Conditional LSTM LM<a class="anchor-link" href="#Conditional-LSTM-LM"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cond_lstm_small" class="doc_header"><code>cond_lstm_small</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cond_lstm_small</code>(<strong><code>vocab</code></strong>, <strong><code>encoder</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cond_lstm_large" class="doc_header"><code>cond_lstm_large</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L182" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cond_lstm_large</code>(<strong><code>vocab</code></strong>, <strong><code>encoder</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mlp_cond_lstm_small" class="doc_header"><code>mlp_cond_lstm_small</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L220" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mlp_cond_lstm_small</code>(<strong><code>vocab</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mlp_cond_lstm_large" class="doc_header"><code>mlp_cond_lstm_large</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L229" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mlp_cond_lstm_large</code>(<strong><code>vocab</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlp_cond_lstm_small</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlp_cond_lstm_large</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="VAE">VAE<a class="anchor-link" href="#VAE"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mlp_vae" class="doc_header"><code>mlp_vae</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L240" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mlp_vae</code>(<strong><code>vocab</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="conv_vae" class="doc_header"><code>conv_vae</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L281" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>conv_vae</code>(<strong><code>vocab</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lstm_vae" class="doc_header"><code>lstm_vae</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L323" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lstm_vae</code>(<strong><code>vocab</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlp_vae</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">conv_vae</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lstm_vae</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

