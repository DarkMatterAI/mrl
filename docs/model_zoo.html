---

title: Model Zoo


keywords: fastai
sidebar: home_sidebar

summary: "Standard Pretrained Models"
description: "Standard Pretrained Models"
nb_path: "nbs/22_model_zoo.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/22_model_zoo.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Zoo">Model Zoo<a class="anchor-link" href="#Model-Zoo"> </a></h2><p>This module contains a set of standard models with pre-trained weights</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="model_from_url" class="doc_header"><code>model_from_url</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>model_from_url</code>(<strong><code>weight_filename</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PretrainedGenerativeAgent" class="doc_header"><code>class</code> <code>PretrainedGenerativeAgent</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L36" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PretrainedGenerativeAgent</code>(<strong><code>weight_filename</code></strong>, <strong><code>model</code></strong>, <strong><code>vocab</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>dataset</code></strong>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'pretrained_model'</code></em>) :: <a href="/mrl/agent.html#GenerativeAgent"><code>GenerativeAgent</code></a></p>
</blockquote>
<p>PretrainedGenerativeAgent - base <a href="/mrl/agent.html#GenerativeAgent"><code>GenerativeAgent</code></a>
variant for pretrained models</p>
<p>Inputs:</p>
<ul>
<li><p><code>weight_filename str</code>: filename to grab from S3</p>
</li>
<li><p><code>model nn.Module</code>: model</p>
</li>
<li><p><code>vocab Vocab</code>: vocabulary</p>
</li>
<li><p><code>loss_function Callable</code>: loss function for supervised training. Should
function as <code>loss = loss_function(model_output, y)</code></p>
</li>
<li><p><code>dataset Base_Dataset</code>: dataset</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="LSTM-LM">LSTM LM<a class="anchor-link" href="#LSTM-LM"> </a></h2><p>Models based on <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> class</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lstm_lm_small" class="doc_header"><code>lstm_lm_small</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L110" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lstm_lm_small</code>(<strong><code>vocab</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>lstm_lm_small - small LSTM_LM model</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lstm_lm_large" class="doc_header"><code>lstm_lm_large</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L144" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lstm_lm_large</code>(<strong><code>vocab</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>lstm_lm_large - large LSTM_LM model</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lstm_lm_small</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lstm_lm_large</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_ZINC" class="doc_header"><code>class</code> <code>LSTM_LM_Small_ZINC</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L181" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_ZINC</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_zinc'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_ZINC - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on a chunk of the ZINC library</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_ZINC</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>

<span class="n">agent</span><span class="o">.</span><span class="n">reload_weights</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_Chembl" class="doc_header"><code>class</code> <code>LSTM_LM_Small_Chembl</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L236" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_Chembl</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_chembl'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Chembl - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on a chunk of the Chembl library</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_Chembl</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_ZINC_NC" class="doc_header"><code>class</code> <code>LSTM_LM_Small_ZINC_NC</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L291" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_ZINC_NC</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_zinc_nc'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_ZINC_NC - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on a chunk of the ZINC library with
no chirality markers (ie no '@' symbols)</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_ZINC_NC</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_Chembl_NC" class="doc_header"><code>class</code> <code>LSTM_LM_Small_Chembl_NC</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L347" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_Chembl_NC</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_chembl_nc'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Chembl_NC - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on a chunk of the Chembl library with
no chirality markers (ie no '@' symbols)</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_Chembl_NC</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_ZINC_Selfies" class="doc_header"><code>class</code> <code>LSTM_LM_Small_ZINC_Selfies</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L402" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_ZINC_Selfies</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_zinc_selfies'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_ZINC_Selfies - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on a chunk of the ZINC library using
SELFIES-type tokenization</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_ZINC_Selfies</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_Chembl_Selfies" class="doc_header"><code>class</code> <code>LSTM_LM_Small_Chembl_Selfies</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L459" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_Chembl_Selfies</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_chembl_selfies'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Chembl_Selfies - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on a chunk of the Chembl library using
SELFIES-type tokenization</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_Chembl_Selfies</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_Rgroup" class="doc_header"><code>class</code> <code>LSTM_LM_Small_Rgroup</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L517" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_Rgroup</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_rgroup'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Rgroup - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on R-groups. R groups are SMILES with
the format <code>*R</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_Rgroup</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_Linkers" class="doc_header"><code>class</code> <code>LSTM_LM_Small_Linkers</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L573" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_Linkers</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_linkers'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Linkers - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on linkers. Linkes are SMILES with
the format <code>*R*</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_Linkers</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_Linkers_Mapped" class="doc_header"><code>class</code> <code>LSTM_LM_Small_Linkers_Mapped</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L629" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_Linkers_Mapped</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_linkers_mapped'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Linkers_Mapped - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a>
model trained on linkers with mapping tokens for
compatibility with <a href="/mrl/template.blocks.html#LinkerBlockTemplate"><code>LinkerBlockTemplate</code></a>. Linkers
are SMILES with the format <code>*R*</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_Linkers_Mapped</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_Swissprot" class="doc_header"><code>class</code> <code>LSTM_LM_Small_Swissprot</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L688" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_Swissprot</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_swissprot'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Swissprot - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a>
model trained on the Swissprot protein dataset.
This model was trained on protein sequences
of 650 amino acids or fewer</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_Swissprot</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">proteins</span> <span class="o">=</span> <span class="n">to_protein</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">proteins</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">proteins</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">proteins</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LSTM_LM_Small_PI1M" class="doc_header"><code>class</code> <code>LSTM_LM_Small_PI1M</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L746" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LSTM_LM_Small_PI1M</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'lstmlm_small_pi1m'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>LSTM_LM_Small_Chembl - small <a href="/mrl/generative_models.lstm_lm.html#LSTM_LM"><code>LSTM_LM</code></a> model
trained on a chunk of the PI1M polymer library</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_PI1M</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conditional-LSTM-LM">Conditional LSTM LM<a class="anchor-link" href="#Conditional-LSTM-LM"> </a></h2><p>Models based on <a href="/mrl/generative_models.lstm_lm.html#Conditional_LSTM_LM"><code>Conditional_LSTM_LM</code></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cond_lstm_small" class="doc_header"><code>cond_lstm_small</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L801" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cond_lstm_small</code>(<strong><code>vocab</code></strong>, <strong><code>encoder</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>cond_lstm_small - small conditional LSTM_LM model</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>encoder nn.Module</code>: encoder module</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cond_lstm_large" class="doc_header"><code>cond_lstm_large</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L845" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cond_lstm_large</code>(<strong><code>vocab</code></strong>, <strong><code>encoder</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>cond_lstm_large - large conditional LSTM_LM model</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>encoder nn.Module</code>: encoder module</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mlp_cond_lstm_small" class="doc_header"><code>mlp_cond_lstm_small</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L890" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mlp_cond_lstm_small</code>(<strong><code>vocab</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>mlp_cond_lstm_small - small conditional
LSTM_LM model with MLP encoder</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mlp_cond_lstm_large" class="doc_header"><code>mlp_cond_lstm_large</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L906" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mlp_cond_lstm_large</code>(<strong><code>vocab</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>mlp_cond_lstm_large - large conditional
LSTM_LM model with MLP encoder</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlp_cond_lstm_small</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlp_cond_lstm_large</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP_Cond_LSTM_LM_Small_ZINC" class="doc_header"><code>class</code> <code>FP_Cond_LSTM_LM_Small_ZINC</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L927" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP_Cond_LSTM_LM_Small_ZINC</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'fp_cond_lstmlm_small_zinc'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>FP_Cond_LSTM_LM_Small_ZINC - small
<a href="/mrl/generative_models.lstm_lm.html#Conditional_LSTM_LM"><code>Conditional_LSTM_LM</code></a> model trained to
reconstruct SMILES from a ECFP6 fingerprint
using a chunk of the ZINC database</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">FP_Cond_LSTM_LM_Small_ZINC</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP_Cond_LSTM_LM_Small_ZINC_Selfies" class="doc_header"><code>class</code> <code>FP_Cond_LSTM_LM_Small_ZINC_Selfies</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L985" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP_Cond_LSTM_LM_Small_ZINC_Selfies</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'fp_cond_lstmlm_small_zinc_selfies'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>FP_Cond_LSTM_LM_Small_ZINC_Selfies - small
<a href="/mrl/generative_models.lstm_lm.html#Conditional_LSTM_LM"><code>Conditional_LSTM_LM</code></a> model trained to
reconstruct SMILES from a ECFP6 fingerprint
using a chunk of the ZINC database with
SELFIES encoding</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">FP_Cond_LSTM_LM_Small_ZINC_Selfies</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP_Cond_LSTM_LM_Small_Chembl" class="doc_header"><code>class</code> <code>FP_Cond_LSTM_LM_Small_Chembl</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L1044" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP_Cond_LSTM_LM_Small_Chembl</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'fp_cond_lstmlm_small_chembl'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>FP_Cond_LSTM_LM_Small_Chembl - small
<a href="/mrl/generative_models.lstm_lm.html#Conditional_LSTM_LM"><code>Conditional_LSTM_LM</code></a> model trained to
reconstruct SMILES from a ECFP6 fingerprint
using the Chembl database</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">FP_Cond_LSTM_LM_Small_Chembl</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VAE">VAE<a class="anchor-link" href="#VAE"> </a></h2><p>Models based on <a href="/mrl/generative_models.vae.html#VAE"><code>VAE</code></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mlp_vae" class="doc_header"><code>mlp_vae</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L1101" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mlp_vae</code>(<strong><code>vocab</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>mlp_vae - VAE with MLP encoder</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="conv_vae" class="doc_header"><code>conv_vae</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L1146" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>conv_vae</code>(<strong><code>vocab</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>mlp_vae - VAE with convolutional encoder</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lstm_vae" class="doc_header"><code>lstm_vae</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L1192" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lstm_vae</code>(<strong><code>vocab</code></strong>, <strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>mlp_vae - VAE with LSTM encoder</p>
<p>Inputs:</p>
<ul>
<li><p><code>vocab Vocab</code>: vocab to use</p>
</li>
<li><p><code>drop_scale float</code>: scale dropout values</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">CharacterVocab</span><span class="p">(</span><span class="n">SMILES_CHAR_VOCAB</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlp_vae</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">conv_vae</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">lstm_vae</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP_VAE_ZINC" class="doc_header"><code>class</code> <code>FP_VAE_ZINC</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L1233" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP_VAE_ZINC</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'fp_vae_zinc'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>FP_VAE_ZINC - MLP-to-LSTM VAE trained to
reconstruct SMILES from a ECFP6 fingerprint
using the ZINC database</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">FP_VAE_ZINC</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP_VAE_Chembl" class="doc_header"><code>class</code> <code>FP_VAE_Chembl</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L1290" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP_VAE_Chembl</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'fp_vae_chembl'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>FP_VAE_Chembl - MLP-to-LSTM VAE trained to
reconstruct SMILES from a ECFP6 fingerprint
using the Chembl database</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">FP_VAE_Chembl</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP_VAE_ZINC_Selfies" class="doc_header"><code>class</code> <code>FP_VAE_ZINC_Selfies</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/model_zoo.py#L1346" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP_VAE_ZINC_Selfies</code>(<strong><code>drop_scale</code></strong>=<em><code>1.0</code></em>, <strong><code>base_update</code></strong>=<em><code>0.97</code></em>, <strong><code>base_update_iter</code></strong>=<em><code>5</code></em>, <strong><code>base_model</code></strong>=<em><code>True</code></em>, <strong><code>opt_kwargs</code></strong>=<em><code>{}</code></em>, <strong><code>clip</code></strong>=<em><code>1.0</code></em>, <strong><code>name</code></strong>=<em><code>'fp_vae_zinc_selfies'</code></em>) :: <a href="/mrl/model_zoo.html#PretrainedGenerativeAgent"><code>PretrainedGenerativeAgent</code></a></p>
</blockquote>
<p>FP_VAE_ZINC_Selfies - MLP-to-LSTM VAE trained to
reconstruct SMILES from a ECFP6 fingerprint
using the ZINC database with SELFIES encoding</p>
<p>Inputs:</p>
<ul>
<li><p><code>drop_scale float</code>: dropout scale</p>
</li>
<li><p><code>base_update float</code>: update fraction for the baseline model. Updates
the base model following <code>base_model = base_update*base_model + (1-base_update)*model</code></p>
</li>
<li><p><code>base_update_iter int</code>: update frequency for baseline model</p>
</li>
<li><p><code>base_model bool</code>: if False, baseline model will not be created</p>
</li>
<li><p><code>opt_kwargs dict</code>: dictionary of keyword arguments passed to <code>optim.Adam</code></p>
</li>
<li><p><code>clip float</code>: gradient clipping</p>
</li>
<li><p><code>name str</code>: agent name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">FP_VAE_ZINC_Selfies</span><span class="p">()</span>

<span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

