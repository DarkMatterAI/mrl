---

title: Tutorial - Templates (Beginner)

keywords: fastai
sidebar: home_sidebar

summary: "Basic overview of using templates"
description: "Basic overview of using templates"
nb_path: "nbs/tutorials.template.beginner.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/tutorials.template.beginner.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a basic overview of using the <a href="/mrl/template.template#Template"><code>Template</code></a> class to filter compounds. This tutorial looks under the hood at how templates function and how you can create your own templates</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">mrl.imports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.templates</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First lets get some compounds</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2000</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Templates">Basic Templates<a class="anchor-link" href="#Basic-Templates"> </a></h2><p>Now we create our template. We'll use the <a href="/mrl/template.template#RuleOf3Template"><code>RuleOf3Template</code></a> class, which implements the "Rule of 3" constraints (doi.org/10.1016/S1359-6446(03)02831-9). The Rule of 3 imposes the following criteria:</p>
<ul>
<li>Molecular weight &lt; 300</li>
<li>LogP &lt; 3</li>
<li>Hydrogen Bond Donors &lt; 3</li>
<li>Hydrogen Bond Acceptors &lt; 3</li>
<li>Rotatable bonds &lt; 3</li>
</ul>
<p>This is a specific case of the <a href="/mrl/template.template#Template"><code>Template</code></a> class</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">RuleOf3Template</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Passing our list of mols to the template, we get out a list of bools</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">template</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Which we can use to filter our list of mols for those that pass</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">passing</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">))</span> <span class="k">if</span> <span class="n">outputs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">passing</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>92</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Under the hood, the Template contains a list of filters, implemented with the <a href="/mrl/template.filters#Filter"><code>Filter</code></a> class. These filters take in a mol and assign it a True/False output.</p>
<p>Take for example the <a href="/mrl/template.filters#MolWtFilter"><code>MolWtFilter</code></a> class. If we create it will the inputs <code>min_val=50, max_val=300</code>, it will return True for any molecule that has a molecular weight between 50 and 300</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filt</span> <span class="o">=</span> <span class="n">MolWtFilter</span><span class="p">(</span><span class="n">min_val</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">max_val</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">filt</span><span class="p">(</span><span class="n">mols</span><span class="p">))</span> <span class="c1"># number of passing compounds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>503</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/mrl/template.template#Template"><code>Template</code></a> is basically a list of filters with some added functions for logging data, saving/loading templates and parallel processing.</p>
<p>We can re-create the <a href="/mrl/template.template#RuleOf3Template"><code>RuleOf3Template</code></a> we used earlier by specifying the individual filters for the Rule of 3</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">MolWtFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="n">LogPFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">HBDFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">HBAFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">RotBondFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This gives the same result as before</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">template</span><span class="p">(</span><span class="n">mols</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>92</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Templates can be saved or loaded as such:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_template.template&#39;</span><span class="p">)</span>
<span class="n">new_template</span> <span class="o">=</span> <span class="n">Template</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;my_template.template&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;my_template.template&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Templates also hold a log of all compounds screened</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">hard_log</span>
<span class="n">log</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">hard_col_names</span>
<span class="n">log</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>smiles</th>
      <th>molwt</th>
      <th>logp</th>
      <th>hbd</th>
      <th>hba</th>
      <th>rotbond</th>
      <th>final</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CNc1nc(SCC(=O)Nc2cc(Cl)ccc2OC)nc2ccccc12</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>COc1ccc(C(=O)Oc2ccc(/C=C3\C(=N)N4OC(C)=CC4=NC3...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cc1sc(NC(=O)c2ccccc2)c(C(N)=O)c1C</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>COc1ccc(NCc2noc(-c3ccoc3)n2)cc1OC(F)F</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>O=C(COC(=O)c1cccc(Br)c1)c1ccc2c(c1)OCCCO2</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the log we can see the results from each individual filter. A molecule will only pass if all filters return True</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So far we have used Templates and Filters to assign a True/False pass/fail criteria to a molecule. Filters that return a True/False output are called <strong>Hard Filters</strong>.</p>
<p>We can also use templates to assign a score to compounds as well. Filters that return a score rather than True/False are called <strong>Soft Filters</strong>.</p>
<p>We can use a combination of hard and soft filters to precisely define our desired chemical space. Hard filters can be thought of as must-have criteria, while soft filters can be thought of as nice-to-have criteria.</p>
<p>In a reinforcement learning context, compounds that fail the hard filters can be removed from training. Passing compounds can then be scored with the soft filters to give a score bonus to highly desirable molecules. This incentivises the model to generate compounds that meet the criteria of the soft filters.</p>
<p>Hard filters are best used to define large ranges of easy to calculate chemical properties to roughly filter compounds. Soft filters are best used to express preferences for specific substructures or narrow property ranges.</p>
<p>For example, lets use the same Rule of 3 hard filters we've been using thus far with some new soft filters.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hard_filters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">MolWtFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="c1"># note that `None` means that bound is ignored</span>
    <span class="n">LogPFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">HBDFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">HBAFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">RotBondFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">soft_filters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">StructureFilter</span><span class="p">([</span><span class="s1">&#39;[#6]1:[#6]:[#7]:[#6]:[#6]:[#6]:1&#39;</span><span class="p">],</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fail_score</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">StructureFilter</span><span class="p">([</span><span class="s1">&#39;[#6]1:[#6]:[#7]:[#7]:[#6]:[#6]:1&#39;</span><span class="p">,</span> <span class="s1">&#39;[#6]1:[#6]:[#7]:[#7]:[#7]:[#6]:1&#39;</span><span class="p">],</span> 
                    <span class="n">exclude</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">fail_score</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">MolWtFilter</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">TPSAFilter</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">hard_filters</span><span class="p">,</span> <span class="n">soft_filters</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets go through the soft filters we creates.</p>
<p>The first filter is a structure filter that looks for a desirable structure - a 6-membered aromatic ring with one nitrogen. We want to give a score bonus to compounds that meet this criteria. The filter is a <a href="/mrl/template.filters#StructureFilter"><code>StructureFilter</code></a>. The main argument is a list of smarts to look for, in this case just the one smarts. The <code>exclude=False</code> denotes that the filter will return <code>True</code> if a mol matches the given smarts. <code>score=1</code> means a compound that matches the smarts gets a score of <code>1</code>. <code>fail_score=-1</code> means a compound that fails to match the smarts gets a score of <code>-1</code>.</p>
<p>The second filter looks at substructure filtering from a different perspective. Now we want to exclude undesirable structures. In this case, we have smarts for an aromatic ring with a <code>N-N</code> feature and a <code>N-N-N</code> feature. We pass <code>excude=True</code> and <code>criteria='any'</code> to denote that the filter will return <code>False</code> if a molecule matches any of the smarts given. We set <code>score=0.</code> and <code>fail_score=-1</code> so that compounds that don't match the smarts get no score, while compounds that match any of the smarts get <code>-1</code>.</p>
<p>The next two filters, <a href="/mrl/template.filters#MolWtFilter"><code>MolWtFilter</code></a> and <a href="/mrl/template.filters#TPSAFilter"><code>TPSAFilter</code></a> are property filters for molecular weight and TPSA, giving a compound a score of <code>1</code> for meeting each criteria.</p>
<p>For a detailed look at different filter functions and their arguments, see the <a href="/mrl/template.filters.html">Filter</a> page.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can filter compounds using the <a href="/mrl/template.template#Template.screen_mols"><code>Template.screen_mols</code></a> function. This returns two lists, <code>passes</code> and <code>fails</code>. <code>passes</code> contains tuples of <code>(mol, score)</code> for compounds that passes the hard filters. <code>fails</code> contains a list of mols that failed the hard filters</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">passes</span><span class="p">,</span> <span class="n">fails</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">screen_mols</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">passes</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(&lt;rdkit.Chem.rdchem.Mol at 0x7ff6235dfa80&gt;, -1.0, 2),
 (&lt;rdkit.Chem.rdchem.Mol at 0x7ff6235eaf80&gt;, -1.0, 68),
 (&lt;rdkit.Chem.rdchem.Mol at 0x7ff6235ec0d0&gt;, -1.0, 120),
 (&lt;rdkit.Chem.rdchem.Mol at 0x7ff6235ec350&gt;, -1.0, 128),
 (&lt;rdkit.Chem.rdchem.Mol at 0x7ff6235ec440&gt;, 0.0, 131),
 (&lt;rdkit.Chem.rdchem.Mol at 0x7ff6235ec760&gt;, 2.0, 141)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also easily merge filters through addition. <code>template1 + template2</code> will return a template that contains the hard and soft filters from both input templates. For example</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1</span> <span class="o">=</span> <span class="n">ValidMoleculeTemplate</span><span class="p">()</span> <span class="c1"># returns True for valid single compounds, good check for generative models</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">RuleOf5Template</span><span class="p">()</span> <span class="c1"># rule of 5</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see the filters in the <code>__repr__</code> for the templates</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Template
	Hard Filter:
		Vaidity Filter
		Single Compound Filter
	Soft Filter:
		</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Template
	Hard Filter:
		hbd (None, 5)
		hba (None, 10)
		molwt (None, 500)
		logp (None, 5)
	Soft Filter:
		</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Template
	Hard Filter:
		Vaidity Filter
		Single Compound Filter
		hbd (None, 5)
		hba (None, 10)
		molwt (None, 500)
		logp (None, 5)
	Soft Filter:
		</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

