---

title: Chem


keywords: fastai
sidebar: home_sidebar

summary: "Core comp chem functions implemented with RDKit"
description: "Core comp chem functions implemented with RDKit"
nb_path: "nbs/01_chem.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_chem.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>//anaconda3/envs/insight/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="RDKit-i/o">RDKit i/o<a class="anchor-link" href="#RDKit-i/o"> </a></h2><p><a href="/mrl/chem.html#to_mol"><code>to_mol</code></a> and <a href="/mrl/chem.html#to_smile"><code>to_smile</code></a> are functions that make it easy to work with both SMILES strings and RDKit <code>Mol</code> objects. For example, if a function requires a <code>mol</code> input, adding <code>mol = to_mol(mol)</code> allows the function to take either SMILES strings or RDKit mols as input</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_mol" class="doc_header"><code>to_mol</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_mol</code>(<strong><code>smile_or_mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_smile" class="doc_header"><code>to_smile</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_smile</code>(<strong><code>smile_or_mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_smile</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">str</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_smile</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)))</span> <span class="o">==</span> <span class="nb">str</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)))</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mol-Descriptors">Mol Descriptors<a class="anchor-link" href="#Mol-Descriptors"> </a></h2><p>These are a bunch of wrappers for standard RDKit functions. The reason for doing this is RDKit functions can't be pickled, which causes all sorts of problems for multiprocessing. This is fixed by creating a wrapper function</p>
<p>For example:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcExactMolWt</span><span class="p">,</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parallel execution succeeded&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel execution failed&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcExactMolWt</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parallel execution succeeded&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel execution failed&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>parallel execution failed
Parallel execution succeeded
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sadly, having a generic wrapper constructor also fails to pickle because such a wrapper requires an RDKit function as input to construct the wrapper, which brings back the pickle problems (see code example below). This leaves us with manually defining wrapper functions for RDKit functions</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rdkit_wrapper</span><span class="p">(</span><span class="n">rdkit_func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">rdkit_func</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">rdkit_wrapper</span><span class="p">(</span><span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcExactMolWt</span><span class="p">),</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parallel execution succeeded&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel execution failed&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>parallel execution failed
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="molwt" class="doc_header"><code>molwt</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>molwt</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hbd" class="doc_header"><code>hbd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L39" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hbd</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hba" class="doc_header"><code>hba</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hba</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tpsa" class="doc_header"><code>tpsa</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tpsa</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotbond" class="doc_header"><code>rotbond</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotbond</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fsp3" class="doc_header"><code>fsp3</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fsp3</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="logp" class="doc_header"><code>logp</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>logp</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rings" class="doc_header"><code>rings</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rings</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="heteroatoms" class="doc_header"><code>heteroatoms</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>heteroatoms</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="aromaticrings" class="doc_header"><code>aromaticrings</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L63" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>aromaticrings</code>(<strong><code>mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">hbd</span><span class="p">,</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
    
<span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;success&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Substructure-Matching">Substructure Matching<a class="anchor-link" href="#Substructure-Matching"> </a></h2><p>This class is used for substructure matching an input <code>Mol</code> against a list of SMARTS.</p>
<p><strong>Note</strong>: Substructure matching is tricky. Be sure to verify your SMARTS before putting a large number of them into a filter.</p>
<p><a href="/mrl/chem.html#CatalogMatch"><code>CatalogMatch</code></a> functions as a base class to match <code>Mol</code> objects against any generic catalog. <code>has_match</code> will return a single boolean value for if the <code>Mol</code> matches one of he filters in the catalog. <code>get_matches</code> will return a list of bools for all elements in the catalog.</p>
<p><code>SMARTSMatch</code> will generate a catalog from a list of SMARTS</p>
<p><a href="/mrl/chem.html#PAINSMatch"><code>PAINSMatch</code></a>, <a href="/mrl/chem.html#PAINSAMatch"><code>PAINSAMatch</code></a>, <a href="/mrl/chem.html#PAINSBMatch"><code>PAINSBMatch</code></a> and <a href="/mrl/chem.html#PAINSCMatch"><code>PAINSCMatch</code></a> specify different PAINS catalogs present in RDKit (see <a href="https://www.rdkit.org/docs/source/rdkit.Chem.rdfiltercatalog.html#rdkit.Chem.rdfiltercatalog.FilterCatalogParams.FilterCatalogs">here</a>)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CatalogMatch" class="doc_header"><code>class</code> <code>CatalogMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L67" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CatalogMatch</code>(<strong><code>catalog</code></strong>)</p>
</blockquote>
<p>Base Class for SMARTS matching</p>
<p>Inputs: <code>catalog</code>, RDKit <code>FilterCatalog</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SmartsMatch" class="doc_header"><code>class</code> <code>SmartsMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L95" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SmartsMatch</code>(<strong><code>smarts</code></strong>) :: <a href="/mrl/chem.html#CatalogMatch"><code>CatalogMatch</code></a></p>
</blockquote>
<p>Class for SMARTS matching</p>
<p>Inputs: <code>smarts</code>, list of smarts</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ParamsMatch" class="doc_header"><code>class</code> <code>ParamsMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L115" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ParamsMatch</code>(<strong><code>params</code></strong>) :: <a href="/mrl/chem.html#CatalogMatch"><code>CatalogMatch</code></a></p>
</blockquote>
<p>Generates <a href="/mrl/chem.html#CatalogMatch"><code>CatalogMatch</code></a> object from <code>params</code>, a <code>FilterCatalogParams</code> object</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSMatch" class="doc_header"><code>class</code> <code>PAINSMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L125" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSMatch</code>() :: <a href="/mrl/chem.html#ParamsMatch"><code>ParamsMatch</code></a></p>
</blockquote>
<p>Full PAINS filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSAMatch" class="doc_header"><code>class</code> <code>PAINSAMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L130" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSAMatch</code>() :: <a href="/mrl/chem.html#ParamsMatch"><code>ParamsMatch</code></a></p>
</blockquote>
<p>PAINS A filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSBMatch" class="doc_header"><code>class</code> <code>PAINSBMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L135" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSBMatch</code>() :: <a href="/mrl/chem.html#ParamsMatch"><code>ParamsMatch</code></a></p>
</blockquote>
<p>PAINS B filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSCMatch" class="doc_header"><code>class</code> <code>PAINSCMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L140" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSCMatch</code>() :: <a href="/mrl/chem.html#ParamsMatch"><code>ParamsMatch</code></a></p>
</blockquote>
<p>PAINS C filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ZINCMatch" class="doc_header"><code>class</code> <code>ZINCMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L145" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ZINCMatch</code>() :: <a href="/mrl/chem.html#ParamsMatch"><code>ParamsMatch</code></a></p>
</blockquote>
<p>ZINC filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BRENKMatch" class="doc_header"><code>class</code> <code>BRENKMatch</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L150" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BRENKMatch</code>() :: <a href="/mrl/chem.html#ParamsMatch"><code>ParamsMatch</code></a></p>
</blockquote>
<p>BRENK filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smarts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[#0]):[#6]:[#6](-[*]):[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[*]):[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6]:[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[#7]-[*]):[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[#6]1:[#6]:[#7]:[#6]:[#6]:[#6]:1&#39;</span>
<span class="p">]</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">SmartsMatch</span><span class="p">(</span><span class="n">smarts</span><span class="p">)</span>

<span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;c1ccccc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cc(NC)ccc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cc(NC)cnc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cccc(NCc2ccccc2)c1&#39;</span>
<span class="p">]</span>

<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">sm</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fingerprints">Fingerprints<a class="anchor-link" href="#Fingerprints"> </a></h2><p>This section deals with creating and manipulating molecular fingerprints. Below are functions for generating different forms of Morgan fingerprints (ECFP4, ECFP6, FCFP4, FCFP6). Fingerprints by default are generated as RDKit <code>ExplicitBitVect</code> objects, but can be converted to numpy arrays using the <a href="/mrl/chem.html#fp_to_array"><code>fp_to_array</code></a> function.</p>
<p>Fingerprint similarity functions using Tanimoto, Dice and Cosine metrics are implemented for both <code>ExplicitBitVect</code> and <code>ndarray</code> objects.</p>
<p><strong>Note</strong> following cheminformatics convention, fingerprint metrics are implemented as <em>similarities</em> rather than <em>distances</em>. The metrics used have the relationship <code>similarity = 1 - distance</code>. For using fingerprint difference metrics in machine learning applications, be sure you are using the correct relationship (similarity vs difference) for your task.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="morgan_fp" class="doc_header"><code>morgan_fp</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L157" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>morgan_fp</code>(<strong><code>mol</code></strong>, <strong><code>radius</code></strong>=<em><code>3</code></em>, <strong><code>nbits</code></strong>=<em><code>2048</code></em>, <strong><code>use_features</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>morgan fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ECFP4" class="doc_header"><code>ECFP4</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L163" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ECFP4</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>ECFP4 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ECFP6" class="doc_header"><code>ECFP6</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L167" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ECFP6</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>ECFP6 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FCFP4" class="doc_header"><code>FCFP4</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FCFP4</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>FCFP4 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FCFP6" class="doc_header"><code>FCFP6</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L175" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FCFP6</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>FCFP6 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fp_to_array" class="doc_header"><code>fp_to_array</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L179" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fp_to_array</code>(<strong><code>fp</code></strong>)</p>
</blockquote>
<p>Converts RDKit <code>ExplicitBitVec</code> to numpy array</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tanimoto" class="doc_header"><code>tanimoto</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L185" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tanimoto</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>)</p>
</blockquote>
<p>Tanimoto similarity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tanimoto_rd" class="doc_header"><code>tanimoto_rd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L189" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tanimoto_rd</code>(<strong><code>fp</code></strong>, <strong><code>fps</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dice" class="doc_header"><code>dice</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L192" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dice</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>)</p>
</blockquote>
<p>Dice similarity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dice_rd" class="doc_header"><code>dice_rd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dice_rd</code>(<strong><code>fp</code></strong>, <strong><code>fps</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cosine" class="doc_header"><code>cosine</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cosine</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>)</p>
</blockquote>
<p>Cosine similarity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cosine_rd" class="doc_header"><code>cosine_rd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L203" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cosine_rd</code>(<strong><code>fp</code></strong>, <strong><code>fps</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When computing similarities between fingerprints, several things need to be lined up. Different methods are needed for different fingerprint formats (<code>ndarray</code> vs <code>ExplicitBitVect</code>) and different distance metrics.</p>
<p>The <a href="/mrl/chem.html#FP"><code>FP</code></a> class holds logic to make this easy.</p>
<p>The <a href="/mrl/chem.html#FP.get_fingerprint"><code>FP.get_fingerprint</code></a> function allows for parallel processing of fingerprint generation.</p>
<p>The <a href="/mrl/chem.html#FP.fingerprint_similaity"><code>FP.fingerprint_similaity</code></a> routes fingerprints to the correct similarity function based on the fingerprint's array type and the simillarity metric used.</p>
<p>For cases where instantiating a class isn't helpful, <a href="/mrl/chem.html#get_fingerprint"><code>get_fingerprint</code></a> and <a href="/mrl/chem.html#fingerprint_similarities"><code>fingerprint_similarities</code></a> work as functional wrappers around <a href="/mrl/chem.html#FP"><code>FP</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP" class="doc_header"><code>class</code> <code>FP</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L208" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP</code>()</p>
</blockquote>
<p>FP - class for manipulating molecular fingerprints</p>
<p>fp = FP()
mol_fp = fp.get_fingerprint(mol, 'ECFP6')</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_fingerprint" class="doc_header"><code>get_fingerprint</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L316" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_fingerprint</code>(<strong><code>mol</code></strong>, <strong><code>fp_type</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fingerprint_similarities" class="doc_header"><code>fingerprint_similarities</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L320" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fingerprint_similarities</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>, <strong><code>metric</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="n">FP</span><span class="p">()</span>
<span class="n">fps</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">get_fingerprint</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">fp_type</span><span class="o">=</span><span class="s1">&#39;ECFP4&#39;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;rdkit&#39;</span><span class="p">)</span>
<span class="n">fps_np</span> <span class="o">=</span> <span class="n">fp_to_array</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">fingerprint_similaity</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="s1">&#39;tanimoto&#39;</span><span class="p">),</span> 
                   <span class="n">fp</span><span class="o">.</span><span class="n">fingerprint_similaity</span><span class="p">(</span><span class="n">fps_np</span><span class="p">,</span> <span class="n">fps_np</span><span class="p">,</span> <span class="s1">&#39;tanimoto&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mol-Operations">Mol Operations<a class="anchor-link" href="#Mol-Operations"> </a></h2><p>Functions for editing or manipulating <code>Mol</code> objects.</p>
<p><a href="/mrl/chem.html#fuse_on_atom_mapping"><code>fuse_on_atom_mapping</code></a> and <a href="/mrl/chem.html#fuse_on_link"><code>fuse_on_link</code></a> convert molecular fragments into fused <code>Mol</code> objects. <a href="/mrl/chem.html#fuse_on_atom_mapping"><code>fuse_on_atom_mapping</code></a> relies on RDKit's atom mapping convention (ie <code>[*:1]CC</code>), while <a href="/mrl/chem.html#fuse_on_link"><code>fuse_on_link</code></a> relies on user specified linkages.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fuse_on_atom_mapping" class="doc_header"><code>fuse_on_atom_mapping</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L325" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fuse_on_atom_mapping</code>(<strong><code>fragment_string</code></strong>)</p>
</blockquote>
<p>Inputs: <code>fragment_string</code>, str or Chem.Mol</p>
<p>Outputs: str</p>
<p>Merges a series of molecular fragments into a single compound by atom mapping</p>
<p>ie <code>R1-[*:1].R2-[*:1] &gt;&gt; R1-R2</code></p>
<p>Fragments with paired atom mappings will be fused on the atoms connected to the mapped dummies.
Mappings that occur once or more than 2 times are ignored</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">fuse_on_atom_mapping</span><span class="p">(</span><span class="s1">&#39;[*:1]CC.[*:1]CC&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CCCC&#39;</span>
<span class="k">assert</span> <span class="n">fuse_on_atom_mapping</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;[*:1]CC.[*:1]CC&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;CCCC&#39;</span>
<span class="k">assert</span> <span class="n">fuse_on_atom_mapping</span><span class="p">(</span><span class="s1">&#39;[*:1]CC.[*:2]CC&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CC[*:1].CC[*:2]&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fuse_on_link" class="doc_header"><code>fuse_on_link</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L380" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fuse_on_link</code>(<strong><code>fragment_string</code></strong>, <strong><code>links</code></strong>)</p>
</blockquote>
<p>Inputs: <code>fragment_string</code>, str or Chem.Mol, <code>links</code>, list of defines linkages</p>
<p>Outputs: str</p>
<p>Merges a series of molecular fragments into a single compound by <code>links</code></p>
<p>ie <code>fuse_on_link('R1-[Rb].R2-[Rb]', ['[Rb]']) &gt;&gt; 'R1-R2'</code></p>
<p>Fragments matching a given link are defined by substring searching.
Links that occur once or more than 2 times are ignored</p>
<p>Note: inputs with RDKit atom mapping (ie <code>[*:1]CC</code>) will fail</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">fuse_on_link</span><span class="p">(</span><span class="s1">&#39;[Rb]CC.[Rb]CC&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;[Rb]&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;CCCC&#39;</span>
<span class="k">assert</span> <span class="n">fuse_on_link</span><span class="p">(</span><span class="s1">&#39;[Rb]CC.[Rb]CC&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;[Pb]&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;CC[Rb].CC[Rb]&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

