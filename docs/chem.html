---

title: Chem

keywords: fastai
sidebar: home_sidebar

summary: "Core comp chem functions implemented with RDKit"
description: "Core comp chem functions implemented with RDKit"
nb_path: "nbs/01_chem.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_chem.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="RDKit-i/o">RDKit i/o<a class="anchor-link" href="#RDKit-i/o"> </a></h2><p><a href="/mrl/chem#to_mol"><code>to_mol</code></a> and <a href="/mrl/chem#to_smile"><code>to_smile</code></a> are functions that make it easy to work with both SMILES strings and RDKit <code>Mol</code> objects. For example, if a function requires a <code>mol</code> input, adding <code>mol = to_mol(mol)</code> allows the function to take either SMILES strings or RDKit mols as input</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_mol" class="doc_header"><code>to_mol</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L39" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_mol</code>(<strong><code>smile_or_mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="smart_to_mol" class="doc_header"><code>smart_to_mol</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>smart_to_mol</code>(<strong><code>smile_or_mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_smile" class="doc_header"><code>to_smile</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L65" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_smile</code>(<strong><code>smile_or_mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_kekule" class="doc_header"><code>to_kekule</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L74" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_kekule</code>(<strong><code>smile_or_mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_smart" class="doc_header"><code>to_smart</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_smart</code>(<strong><code>smart_or_mol</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_mols" class="doc_header"><code>to_mols</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L94" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_mols</code>(<strong><code>list_of_inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_smiles" class="doc_header"><code>to_smiles</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L97" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_smiles</code>(<strong><code>list_of_inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_smarts" class="doc_header"><code>to_smarts</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L100" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_smarts</code>(<strong><code>list_of_inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="canon_smile" class="doc_header"><code>canon_smile</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>canon_smile</code>(<strong><code>smile</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_stereo" class="doc_header"><code>remove_stereo</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L106" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_stereo</code>(<strong><code>smile</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="smile_to_selfie" class="doc_header"><code>smile_to_selfie</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>smile_to_selfie</code>(<strong><code>smile</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="selfie_to_smile" class="doc_header"><code>selfie_to_smile</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L116" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>selfie_to_smile</code>(<strong><code>selfie</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_selfie" class="doc_header"><code>split_selfie</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L129" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_selfie</code>(<strong><code>selfie</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_smile</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">str</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_smile</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)))</span> <span class="o">==</span> <span class="nb">str</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)))</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;O=C(NCc1ccc(Br)cc1F)C(=O)NCC1(Cc2ccccc2)CC1&#39;</span>
<span class="k">assert</span> <span class="n">selfie_to_smile</span><span class="p">(</span><span class="n">smile_to_selfie</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Misc-Functions">Misc Functions<a class="anchor-link" href="#Misc-Functions"> </a></h2><p>Miscellaneous RDKit related functions</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="neutralize_atoms" class="doc_header"><code>neutralize_atoms</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L136" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>neutralize_atoms</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Neutralize charges, from rdkit.org/docs/Cookbook.html#neutralizing-molecules</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="initialize_neutralisation_reactions" class="doc_header"><code>initialize_neutralisation_reactions</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L152" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>initialize_neutralisation_reactions</code>()</p>
</blockquote>
<p>github.com/kaiwang0112006/clusfps/blob/master/third_party_package/RDKit_2015_03_1/Docs/Book/Cookbook.rst</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="neutralize_charges" class="doc_header"><code>neutralize_charges</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L176" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>neutralize_charges</code>(<strong><code>mol</code></strong>, <strong><code>reactions</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>github.com/kaiwang0112006/clusfps/blob/master/third_party_package/RDKit_2015_03_1/Docs/Book/Cookbook.rst</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_bond_groups" class="doc_header"><code>find_bond_groups</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_bond_groups</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Find groups of contiguous rotatable bonds and return them sorted by decreasing size</p>
<p><a href="https://www.rdkit.org/docs/Cookbook.html">https://www.rdkit.org/docs/Cookbook.html</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="draw_mols" class="doc_header"><code>draw_mols</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L225" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>draw_mols</code>(<strong><code>mols</code></strong>, <strong><code>legends</code></strong>=<em><code>None</code></em>, <strong><code>mols_per_row</code></strong>=<em><code>3</code></em>, <strong><code>sub_img_size</code></strong>=<em><code>(300, 300)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mol-Descriptors">Mol Descriptors<a class="anchor-link" href="#Mol-Descriptors"> </a></h2><p>These are a bunch of wrappers for standard RDKit functions. The reason for doing this is RDKit functions can't be pickled, which causes all sorts of problems for multiprocessing. This is fixed by creating a wrapper function</p>
<p>For example:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcExactMolWt</span><span class="p">,</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parallel execution succeeded&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel execution failed&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcExactMolWt</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parallel execution succeeded&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel execution failed&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Parallel execution succeeded
Parallel execution succeeded
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sadly, having a generic wrapper constructor also fails to pickle because such a wrapper requires an RDKit function as input to construct the wrapper, which brings back the pickle problems (see code example below). This leaves us with manually defining wrapper functions for RDKit functions</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rdkit_wrapper</span><span class="p">(</span><span class="n">rdkit_func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">rdkit_func</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">rdkit_wrapper</span><span class="p">(</span><span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">CalcExactMolWt</span><span class="p">),</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parallel execution succeeded&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;parallel execution failed&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Parallel execution succeeded
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="molwt" class="doc_header"><code>molwt</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L237" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>molwt</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>molecular weight</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hbd" class="doc_header"><code>hbd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L241" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hbd</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of hydrogen bond donors</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hba" class="doc_header"><code>hba</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L245" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hba</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of hydrogen bond acceptors</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tpsa" class="doc_header"><code>tpsa</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L249" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tpsa</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>total polar surface area</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotbond" class="doc_header"><code>rotbond</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L253" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotbond</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of rotatable bonds</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="loose_rotbond" class="doc_header"><code>loose_rotbond</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L257" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>loose_rotbond</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of rotatable bonds, includes things like amides and esters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rot_chain_length" class="doc_header"><code>rot_chain_length</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L261" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rot_chain_length</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Length of longest contiguous rotatable bond chain</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fsp3" class="doc_header"><code>fsp3</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L267" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fsp3</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>fraction sp3 hybridized atoms</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="logp" class="doc_header"><code>logp</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L271" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>logp</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>logp</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rings" class="doc_header"><code>rings</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L275" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rings</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of rings</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="max_ring_size" class="doc_header"><code>max_ring_size</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L279" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>max_ring_size</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>size of largest ring</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="min_ring_size" class="doc_header"><code>min_ring_size</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L284" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>min_ring_size</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>size of smallest ring</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="heteroatoms" class="doc_header"><code>heteroatoms</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L289" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>heteroatoms</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of heteroatoms</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="all_atoms" class="doc_header"><code>all_atoms</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L293" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>all_atoms</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>total number of atoms</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="heavy_atoms" class="doc_header"><code>heavy_atoms</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L298" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>heavy_atoms</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of heavy atoms</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="formal_charge" class="doc_header"><code>formal_charge</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L302" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>formal_charge</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>formal charge</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="molar_refractivity" class="doc_header"><code>molar_refractivity</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L306" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>molar_refractivity</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>molar refractivity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="aromaticrings" class="doc_header"><code>aromaticrings</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L310" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>aromaticrings</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>number of aromatic rings</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qed" class="doc_header"><code>qed</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L314" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qed</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>QED Score doi:10.1038/nchem.1243 </p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sa_score" class="doc_header"><code>sa_score</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L318" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sa_score</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Synthetic Accessability score doi.org/10.1186/1758-2946-1-8</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="num_bridgeheads" class="doc_header"><code>num_bridgeheads</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L322" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>num_bridgeheads</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Number of bridgehead atoms</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="num_spiro" class="doc_header"><code>num_spiro</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L326" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>num_spiro</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Number of spiro atoms</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="chiral_centers" class="doc_header"><code>chiral_centers</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L330" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>chiral_centers</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Number of chiral centers</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="penalized_logp" class="doc_header"><code>penalized_logp</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L336" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>penalized_logp</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Reward that consists of log p penalized by SA and # long cycles,
as described in (Kusner et al. 2017). Scores are normalized based on the
statistics of 250k_rndm_zinc_drugs_clean.smi dataset
:param mol: rdkit mol object
:return: float</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="n">hbd</span><span class="p">,</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;CCC&#39;</span><span class="p">)])</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
    
<span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;success&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Substructure-Matching">Substructure Matching<a class="anchor-link" href="#Substructure-Matching"> </a></h2><p>This class is used for substructure matching an input <code>Mol</code> against a list of SMARTS.</p>
<p><strong>Note</strong>: Substructure matching is tricky. Be sure to verify your SMARTS before putting a large number of them into a filter.</p>
<p><code>CatalogMatch</code> functions as a base class to match <code>Mol</code> objects against any generic catalog. <code>has_match</code> will return a single boolean value for if the <code>Mol</code> matches one of he filters in the catalog. <code>get_matches</code> will return a list of bools for all elements in the catalog. <code>percent_matches</code> returns a list of floats for what percentate of filters match.</p>
<p><code>SMARTSMatch</code> will generate a catalog from a list of SMARTS</p>
<p><code>PAINSMatch</code>, <code>PAINSAMatch</code>, <code>PAINSBMatch</code> and <code>PAINSCMatch</code> specify different PAINS catalogs present in RDKit (see <a href="https://www.rdkit.org/docs/source/rdkit.Chem.rdfiltercatalog.html#rdkit.Chem.rdfiltercatalog.FilterCatalogParams.FilterCatalogs">here</a>)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Catalog" class="doc_header"><code>class</code> <code>Catalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L377" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Catalog</code>(<strong><code>catalog</code></strong>)</p>
</blockquote>
<p>Base Class for SMARTS matching</p>
<p>Inputs:</p>
<ul>
<li><code>catalog FilterCatalog</code>: RDKit <code>FilterCatalog</code></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Catalog.__call__" class="doc_header"><code>Catalog.__call__</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L390" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Catalog.__call__</code>(<strong><code>mol</code></strong>, <strong><code>criteria</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p><strong>call</strong> - run <code>mol</code> against <code>self.catalog</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>mol [Chem.Mol, list[Chem.Mol]]</code>: input mols</p>
</li>
<li><p><code>criteria ['any', 'all', float, int]</code>: match criteria.
(match any filter, match all filters, match float percent of filters,
match int number of filters)</p>
</li>
</ul>
<p>If <code>any</code>, returns <code>True</code> if any smarts match.</p>
<p>If <code>all</code>, returns <code>True</code> if all smarts match.</p>
<p>If <code>float</code>, returns <code>True</code> if more than <code>float</code> percent (inclusive)
of smarts match.</p>
<p>If <code>int</code>, returns <code>True</code> if more than <code>int</code> total (inclusive) smarts match</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SmartsCatalog" class="doc_header"><code>class</code> <code>SmartsCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L451" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SmartsCatalog</code>(<strong><code>smarts</code></strong>) :: <a href="/mrl/chem#Catalog"><code>Catalog</code></a></p>
</blockquote>
<p>Class for SMARTS matching</p>
<p>Inputs: <code>smarts</code>, list of smarts</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ParamsCatalog" class="doc_header"><code>class</code> <code>ParamsCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L471" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ParamsCatalog</code>(<strong><code>params</code></strong>) :: <a href="/mrl/chem#Catalog"><code>Catalog</code></a></p>
</blockquote>
<p>Generates <code>CatalogMatch</code> object from <code>params</code>, a <code>FilterCatalogParams</code> object</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSCatalog" class="doc_header"><code>class</code> <code>PAINSCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L481" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSCatalog</code>() :: <a href="/mrl/chem#ParamsCatalog"><code>ParamsCatalog</code></a></p>
</blockquote>
<p>Full PAINS filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSACatalog" class="doc_header"><code>class</code> <code>PAINSACatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L486" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSACatalog</code>() :: <a href="/mrl/chem#ParamsCatalog"><code>ParamsCatalog</code></a></p>
</blockquote>
<p>PAINS A filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSBCatalog" class="doc_header"><code>class</code> <code>PAINSBCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L491" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSBCatalog</code>() :: <a href="/mrl/chem#ParamsCatalog"><code>ParamsCatalog</code></a></p>
</blockquote>
<p>PAINS B filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PAINSCCatalog" class="doc_header"><code>class</code> <code>PAINSCCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L496" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PAINSCCatalog</code>() :: <a href="/mrl/chem#ParamsCatalog"><code>ParamsCatalog</code></a></p>
</blockquote>
<p>PAINS C filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ZINCCatalog" class="doc_header"><code>class</code> <code>ZINCCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L501" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ZINCCatalog</code>() :: <a href="/mrl/chem#ParamsCatalog"><code>ParamsCatalog</code></a></p>
</blockquote>
<p>ZINC filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BRENKCatalog" class="doc_header"><code>class</code> <code>BRENKCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L506" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BRENKCatalog</code>() :: <a href="/mrl/chem#ParamsCatalog"><code>ParamsCatalog</code></a></p>
</blockquote>
<p>BRENK filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NIHCatalog" class="doc_header"><code>class</code> <code>NIHCatalog</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L511" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NIHCatalog</code>() :: <a href="/mrl/chem#ParamsCatalog"><code>ParamsCatalog</code></a></p>
</blockquote>
<p>NIH filter matching</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smarts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[#0]):[#6]:[#6](-[*]):[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[*]):[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6]:[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[#7]-[*]):[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[#6]1:[#6]:[#7]:[#6]:[#6]:[#6]:1&#39;</span>
<span class="p">]</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">SmartsCatalog</span><span class="p">(</span><span class="n">smarts</span><span class="p">)</span>

<span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;c1ccccc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cc(NC)ccc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cc(NC)cnc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cccc(NCc2ccccc2)c1&#39;</span>
<span class="p">]</span>

<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">sm</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">sm</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">sm</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">criteria</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fingerprints">Fingerprints<a class="anchor-link" href="#Fingerprints"> </a></h2><p>This section deals with creating and manipulating molecular fingerprints. Below are functions for generating different forms of Morgan fingerprints (ECFP4, ECFP6, FCFP4, FCFP6). Fingerprints by default are generated as RDKit <code>ExplicitBitVect</code> objects, but can be converted to numpy arrays using the <a href="/mrl/chem#fp_to_array"><code>fp_to_array</code></a> function.</p>
<p>Fingerprint similarity functions using Tanimoto, Dice and Cosine metrics are implemented for both <code>ExplicitBitVect</code> and <code>ndarray</code> objects.</p>
<p><strong>Note</strong> following cheminformatics convention, fingerprint metrics are implemented as <em>similarities</em> rather than <em>distances</em>. The metrics used have the relationship <code>similarity = 1 - distance</code>. For using fingerprint difference metrics in machine learning applications, be sure you are using the correct relationship (similarity vs difference) for your task.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="morgan_fp" class="doc_header"><code>morgan_fp</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L518" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>morgan_fp</code>(<strong><code>mol</code></strong>, <strong><code>radius</code></strong>=<em><code>3</code></em>, <strong><code>nbits</code></strong>=<em><code>2048</code></em>, <strong><code>use_features</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>morgan fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ECFP4" class="doc_header"><code>ECFP4</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L524" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ECFP4</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>ECFP4 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ECFP6" class="doc_header"><code>ECFP6</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L528" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ECFP6</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>ECFP6 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FCFP4" class="doc_header"><code>FCFP4</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L532" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FCFP4</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>FCFP4 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FCFP6" class="doc_header"><code>FCFP6</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L536" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FCFP6</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>FCFP6 Fingerprint</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="failsafe_fp" class="doc_header"><code>failsafe_fp</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L540" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>failsafe_fp</code>(<strong><code>mol</code></strong>, <strong><code>fp_function</code></strong>)</p>
</blockquote>
<p>Returns vector of zeros if failure</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fp_to_array" class="doc_header"><code>fp_to_array</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L553" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fp_to_array</code>(<strong><code>fp</code></strong>)</p>
</blockquote>
<p>Converts RDKit <code>ExplicitBitVec</code> to numpy array</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tanimoto" class="doc_header"><code>tanimoto</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L565" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tanimoto</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>)</p>
</blockquote>
<p>Tanimoto similarity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tanimoto_rd" class="doc_header"><code>tanimoto_rd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L569" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tanimoto_rd</code>(<strong><code>fp</code></strong>, <strong><code>fps</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dice" class="doc_header"><code>dice</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L572" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dice</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>)</p>
</blockquote>
<p>Dice similarity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dice_rd" class="doc_header"><code>dice_rd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L576" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dice_rd</code>(<strong><code>fp</code></strong>, <strong><code>fps</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cosine" class="doc_header"><code>cosine</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L579" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cosine</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>)</p>
</blockquote>
<p>Cosine similarity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cosine_rd" class="doc_header"><code>cosine_rd</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L583" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cosine_rd</code>(<strong><code>fp</code></strong>, <strong><code>fps</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When computing similarities between fingerprints, several things need to be lined up. Different methods are needed for different fingerprint formats (<code>ndarray</code> vs <code>ExplicitBitVect</code>) and different distance metrics.</p>
<p>The <a href="/mrl/chem#FP"><code>FP</code></a> class holds logic to make this easy.</p>
<p>The <a href="/mrl/chem#FP.get_fingerprint"><code>FP.get_fingerprint</code></a> function allows for parallel processing of fingerprint generation.</p>
<p>The <a href="/mrl/chem#FP.fingerprint_similarity"><code>FP.fingerprint_similarity</code></a> routes fingerprints to the correct similarity function based on the fingerprint's array type and the simillarity metric used.</p>
<p>For cases where instantiating a class isn't helpful, <a href="/mrl/chem#get_fingerprint"><code>get_fingerprint</code></a> and <a href="/mrl/chem#fingerprint_similarities"><code>fingerprint_similarities</code></a> work as functional wrappers around <a href="/mrl/chem#FP"><code>FP</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FP" class="doc_header"><code>class</code> <code>FP</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L588" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FP</code>()</p>
</blockquote>
<p>FP - class for manipulating molecular fingerprints</p>
<p><code>fp = FP()</code></p>
<p><code>mol_fp = fp.get_fingerprint(mol, 'ECFP6')</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FP.get_fingerprint" class="doc_header"><code>FP.get_fingerprint</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L611" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FP.get_fingerprint</code>(<strong><code>mol</code></strong>, <strong><code>fp_type</code></strong>=<em><code>'ECFP6'</code></em>, <strong><code>output_type</code></strong>=<em><code>'rdkit'</code></em>)</p>
</blockquote>
<p>get_fingerprint - Generates fingerprint for <code>mol</code>.</p>
<p>Inputs:</p>
<ul>
<li><p><code>mol [Chem.Mol, list[Chem.Mol]]</code> - input mols</p>
</li>
<li><p><code>fp_type str</code>: Fingerprint type, must be a key of <a href="/mrl/chem#FP.fps"><code>FP.fps</code></a></p>
</li>
<li><p><code>output_type str['rdkit', 'numpy']</code>: Output datatype. Numpy
<code>ndarray</code> or RDKit <code>ExplicitBitVec</code></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FP.fingerprint_similarity" class="doc_header"><code>FP.fingerprint_similarity</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L633" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FP.fingerprint_similarity</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>, <strong><code>metric</code></strong>)</p>
</blockquote>
<p>fingerprint_similarity - Computes the similarity
between <code>fps1</code> and <code>fps2</code> using <code>metric</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>fps1 [ndarray, ExplicitBitVect]</code>: first fingerprint set</p>
</li>
<li><p><code>fps2 [ndarray, ExplicitBitVect]</code>: second fingerprint set</p>
</li>
</ul>
<p>Returns:</p>
<ul>
<li><code>similarities [ndarray]</code>: matrix of similarities between all
fingerprints in <code>fps1</code> and all fingerprints in <code>fps2</code></li>
</ul>
<p>Fingerprints can either be a Numpy <code>ndarray</code> or an RDKit <code>ExplicitBitVec</code>.
Both fingerprint inputs must be the same datatype.</p>
<p>Numpy fingerprints can eiher be a 1D vector or a 2D matrix
of stacked fingerprints</p>
<p>RDKit fingerprints can either be an <code>ExplicitBitVec</code> or a list of
<code>ExplicitBitVec</code> objects.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_fingerprint" class="doc_header"><code>get_fingerprint</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L721" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_fingerprint</code>(<strong><code>mol</code></strong>, <strong><code>fp_type</code></strong>, <strong><code>output_type</code></strong>=<em><code>'rdkit'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fingerprint_similarities" class="doc_header"><code>fingerprint_similarities</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L725" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fingerprint_similarities</code>(<strong><code>fps1</code></strong>, <strong><code>fps2</code></strong>, <strong><code>metric</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="n">FP</span><span class="p">()</span>
<span class="n">fps</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">get_fingerprint</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">fp_type</span><span class="o">=</span><span class="s1">&#39;ECFP4&#39;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;rdkit&#39;</span><span class="p">)</span>
<span class="n">fps_np</span> <span class="o">=</span> <span class="n">fp_to_array</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">fingerprint_similarity</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="s1">&#39;tanimoto&#39;</span><span class="p">),</span> 
                   <span class="n">fp</span><span class="o">.</span><span class="n">fingerprint_similarity</span><span class="p">(</span><span class="n">fps_np</span><span class="p">,</span> <span class="n">fps_np</span><span class="p">,</span> <span class="s1">&#39;tanimoto&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Custom-Fingerpint-Functions">Custom Fingerpint Functions<a class="anchor-link" href="#Custom-Fingerpint-Functions"> </a></h2><p>Here is an example on how to add new fingerprint functions and distance functions</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">my_fp</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">fp</span> <span class="o">=</span>  <span class="n">AllChem</span><span class="o">.</span><span class="n">RDKFingerprint</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fp</span>

<span class="k">class</span> <span class="nc">MyFP</span><span class="p">(</span><span class="n">FP</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">[</span><span class="s1">&#39;my_fp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_fp</span>
        
<span class="n">fp</span> <span class="o">=</span> <span class="n">MyFP</span><span class="p">()</span>
<span class="n">fps</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">get_fingerprint</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">fp_type</span><span class="o">=</span><span class="s1">&#39;my_fp&#39;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;rdkit&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">my_dist</span><span class="p">(</span><span class="n">fps1</span><span class="p">,</span> <span class="n">fps2</span><span class="p">):</span>
    <span class="c1"># make sure your distance function works on binary/boolean arrays!!</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">fps1</span><span class="p">,</span> <span class="n">fps2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;russellrao&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">my_dist_rd</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fps</span><span class="p">):</span>
    <span class="c1"># make sure the RDKit method gives the same result as scipy, not always the case</span>
    <span class="k">return</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">BulkRusselSimilarity</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fps</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyFP</span><span class="p">(</span><span class="n">FP</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">similarities</span><span class="p">[</span><span class="s1">&#39;my_metric&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rdkit&#39;</span> <span class="p">:</span> <span class="n">my_dist_rd</span><span class="p">,</span>
                                          <span class="s1">&#39;numpy&#39;</span> <span class="p">:</span> <span class="n">my_dist</span><span class="p">}</span>
                
<span class="n">fp</span> <span class="o">=</span> <span class="n">MyFP</span><span class="p">()</span>
<span class="n">fps</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">get_fingerprint</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">fp_type</span><span class="o">=</span><span class="s1">&#39;ECFP6&#39;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="n">fp</span><span class="o">.</span><span class="n">fingerprint_similarity</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="s1">&#39;my_metric&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.00195312, 0.00097656, 0.00048828, 0.00146484],
       [0.00097656, 0.01123047, 0.00585938, 0.00830078],
       [0.00048828, 0.00585938, 0.01171875, 0.00439453],
       [0.00146484, 0.00830078, 0.00439453, 0.01806641]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mol-Operations">Mol Operations<a class="anchor-link" href="#Mol-Operations"> </a></h2><p>Functions for editing or manipulating <code>Mol</code> objects.</p>
<p>Fragmenting functions like <a href="/mrl/chem#fragment_smile"><code>fragment_smile</code></a> break molecules into fragments by cutting single bonds.</p>
<p><a href="/mrl/chem#fuse_on_atom_mapping"><code>fuse_on_atom_mapping</code></a> fuses fragments following RDKit's atom mapping conventions.</p>
<p><code>[*:1]-R1-[*:2] + [*:1]-R2 &gt;&gt; [*:2]-R1-R2</code></p>
<p><a href="/mrl/chem#fuse_on_link"><code>fuse_on_link</code></a> relies on user-defined linkages such as heavy atoms.</p>
<p><code>[Rb]-R1-[Pb] + [Rb]-R2 &gt;&gt; [Pb]-R1-R2</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fragment_mol" class="doc_header"><code>fragment_mol</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L731" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fragment_mol</code>(<strong><code>mol</code></strong>, <strong><code>max_cuts</code></strong>, <strong><code>return_mols</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Wrapper for RDKit mol fragmentation</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fragment_smile" class="doc_header"><code>fragment_smile</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L735" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fragment_smile</code>(<strong><code>smile</code></strong>, <strong><code>cuts</code></strong>)</p>
</blockquote>
<p>fragment_smile - fragment <code>smile</code> based on <code>cuts</code></p>
<p><code>smile str</code>: smiles string to fragment</p>
<p><code>cuts [int, list[int]]</code>: Number of cuts to make. If list,
 code iterates over items in <code>cuts</code> and generates fragments from each value.</p>
<p>Note that the RDKit fragmentation uses only a single cut value. So fragmenting with
 5 cuts will not include the result of fragmenting with 4 cuts</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fragment_smiles" class="doc_header"><code>fragment_smiles</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L782" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fragment_smiles</code>(<strong><code>smiles</code></strong>, <strong><code>cuts</code></strong>)</p>
</blockquote>
<p>fragment and deduplicate a list of smiles</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fragment_smile</span><span class="p">(</span><span class="s1">&#39;CCCCCCCC&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;*CCCCCC&#39;, &#39;*CCCC&#39;, &#39;*CCC&#39;, &#39;*CCCCCCC&#39;, &#39;*CCCCC&#39;, &#39;*C&#39;, &#39;*CC&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fuse_on_atom_mapping" class="doc_header"><code>fuse_on_atom_mapping</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L789" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fuse_on_atom_mapping</code>(<strong><code>fragment_string</code></strong>)</p>
</blockquote>
<p>fuse_on_atom_mapping - Merges a series of molecular fragments
into a single compound by atom mapping</p>
<p>ie <code>R1-[*:1].R2-[*:1] &gt;&gt; R1-R2</code></p>
<p>Fragments with paired atom mappings will be fused on the atoms connected to the mapped dummies.
Mappings that occur once or more than 2 times are ignored</p>
<p>Inputs:</p>
<ul>
<li><code>fragment_string [str, Chem.Mol]</code>: input molecule fragments</li>
</ul>
<p>Outputs:</p>
<ul>
<li><code>new_smile str</code>: fused molecule</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">fuse_on_atom_mapping</span><span class="p">(</span><span class="s1">&#39;[*:1]CC.[*:1]CC&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CCCC&#39;</span>
<span class="k">assert</span> <span class="n">fuse_on_atom_mapping</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;[*:1]CC.[*:1]CC&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;CCCC&#39;</span>
<span class="k">assert</span> <span class="n">fuse_on_atom_mapping</span><span class="p">(</span><span class="s1">&#39;[*:1]CC.[*:2]CC&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CC[*:1].CC[*:2]&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fuse_on_link" class="doc_header"><code>fuse_on_link</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L865" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fuse_on_link</code>(<strong><code>fragment_string</code></strong>, <strong><code>links</code></strong>)</p>
</blockquote>
<p>fuse_on_link -  Merges a series of molecular fragments
into a single compound by <code>links</code></p>
<p>ie <code>fuse_on_link('R1-[Rb].R2-[Rb]', ['[Rb]']) &gt;&gt; 'R1-R2'</code></p>
<p>Fragments matching a given link are defined by substring searching.
Links that occur once or more than 2 times are ignored</p>
<p>Note: inputs with RDKit atom mapping (ie <code>[*:1]CC</code>) will fail</p>
<p>Inputs:</p>
<ul>
<li><p><code>fragment_string [str, Chem.Mol]</code>: input molecule</p>
</li>
<li><p><code>links list</code>: list of defines linkages</p>
</li>
</ul>
<p>Outputs:</p>
<ul>
<li><code>str</code>: fused molecule</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">fuse_on_link</span><span class="p">(</span><span class="s1">&#39;[Rb]CC.[Rb]CC&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;[Rb]&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;CCCC&#39;</span>
<span class="k">assert</span> <span class="n">fuse_on_link</span><span class="p">(</span><span class="s1">&#39;[Rb]CC.[Rb]CC&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;[Pb]&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;CC[Rb].CC[Rb]&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fragment_smile</span> <span class="o">=</span> <span class="s1">&#39;C1CCC([*:1])CC1.C([*:3])CC.c1cncc([*:2])c1.c1nc([*:1])c2c([*:3])nc([*:2])cc2n1&#39;</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">fragment_smile</span><span class="p">)</span>
<span class="n">mol</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fused_smile</span> <span class="o">=</span> <span class="n">fuse_on_atom_mapping</span><span class="p">(</span><span class="n">fragment_smile</span><span class="p">)</span>
<span class="n">new_mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">fused_smile</span><span class="p">)</span>
<span class="n">new_mol</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="murcko_scaffold" class="doc_header"><code>murcko_scaffold</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L904" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>murcko_scaffold</code>(<strong><code>smile</code></strong>, <strong><code>generic</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>murcko_scaffold - convert smile to murcko scaffold.</p>
<p>If generic, all atoms are converted to carbon</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smile</span> <span class="o">=</span> <span class="s1">&#39;Cc1cc(Oc2nccc(CCC)c2)ccc1&#39;</span>
<span class="n">scaffold</span> <span class="o">=</span> <span class="n">murcko_scaffold</span><span class="p">(</span><span class="n">smile</span><span class="p">)</span>
<span class="n">scaffold_generic</span> <span class="o">=</span> <span class="n">murcko_scaffold</span><span class="p">(</span><span class="n">smile</span><span class="p">,</span> <span class="n">generic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">draw_mols</span><span class="p">(</span><span class="n">to_mols</span><span class="p">([</span><span class="n">smile</span><span class="p">,</span> <span class="n">scaffold</span><span class="p">,</span> <span class="n">scaffold_generic</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Structure-Enumeration">Structure Enumeration<a class="anchor-link" href="#Structure-Enumeration"> </a></h2><p>Often it can be useful to enumerate variants of the same core structure. For example, generating every 6 member ring variant with 2 nitrogens. The <a href="/mrl/chem#StructureEnumerator"><code>StructureEnumerator</code></a> class provides a way of enumerating over a core structure defined by a smarts string and a set of user inputs. The structure enumerator can also add wildcard atoms.</p>
<p>For examples on using the <a href="/mrl/chem#StructureEnumerator"><code>StructureEnumerator</code></a> class, see the Structure Enumeration tutorial page</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_map_nums" class="doc_header"><code>add_map_nums</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L920" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_map_nums</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>Adds map numbers to all atoms in <code>mol</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_ring_bonds" class="doc_header"><code>check_ring_bonds</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L929" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_ring_bonds</code>(<strong><code>smile</code></strong>)</p>
</blockquote>
<p>Looks for SP hybridized atoms in rings</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="decorate_smile" class="doc_header"><code>decorate_smile</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L939" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>decorate_smile</code>(<strong><code>smile</code></strong>, <strong><code>num_attachments</code></strong>)</p>
</blockquote>
<p>decorate_smiles - adds wildcard atoms to smile based on num_attachments.
 If there are N atoms with at lest one implicit hydrogen, N choose num_attachments
 combinations are generated</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="decorate_smiles" class="doc_header"><code>decorate_smiles</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L968" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>decorate_smiles</code>(<strong><code>smiles</code></strong>, <strong><code>num_attachments</code></strong>)</p>
</blockquote>
<p>Decorate all items in <code>smiles</code> and cleans results</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_atom" class="doc_header"><code>remove_atom</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L976" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_atom</code>(<strong><code>rwmol</code></strong>, <strong><code>atom_idx</code></strong>, <strong><code>add_bond</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>remove_atom - removes atom based on <code>atom_idx</code>. If <code>add_bond</code> and the removed
 atom is connected to two other heavy atoms, a single bond is formed between neighbors</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_spec_template" class="doc_header"><code>generate_spec_template</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L997" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_spec_template</code>(<strong><code>mol</code></strong>)</p>
</blockquote>
<p>generates blank atom_spec and bond_spec for mol. returns blank specs and matching smarts</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="StructureEnumerator" class="doc_header"><code>class</code> <code>StructureEnumerator</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1009" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>StructureEnumerator</code>(<strong><code>smarts</code></strong>, <strong><code>atom_spec</code></strong>, <strong><code>bond_spec</code></strong>, <strong><code>max_num</code></strong>=<em><code>1000000</code></em>, <strong><code>substitute_bonds</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>StructureEnumerator - class for enumerating molecular structures</p>
<p>Inputs:</p>
<ul>
<li><p><code>smarts str</code>: base smarts string to enumerate</p>
</li>
<li><p><code>atom_spec dict</code>: dict of the form <code>{atom_map_num:[allowed_atom_types]}</code>
where elements in <code>allowed_atom_types</code> match keys in <code>self.atom_types</code></p>
</li>
<li><p><code>bond_spec dict</code>: dict of the form
<code>{(bond_start_map_num, bond_end_map_num) : [possible_bond_types]}</code>
where elements in <code>possible_bond_types</code> match keys in <code>self.bond_types</code></p>
</li>
<li><p><code>max_num int</code>: max number of combinations to iterate</p>
</li>
<li><p><code>substitute_bonds Optional[List]</code>: List of bond types for new bonds
formed from removing atoms. Bond types should match keys in <code>self.bond_types</code>.
If None, all keys in <code>self.bond_types</code> are used</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_one_atom" class="doc_header"><code>add_one_atom</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1309" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_one_atom</code>(<strong><code>inputs</code></strong>)</p>
</blockquote>
<p>helper function for <a href="/mrl/chem#add_atom_combi"><code>add_atom_combi</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_atom_combi" class="doc_header"><code>add_atom_combi</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1347" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_atom_combi</code>(<strong><code>smile</code></strong>, <strong><code>atom_types</code></strong>, <strong><code>cpus</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>add_atom_combi - creates variants of <code>smile</code> with one atom
added or removed, defined by <code>atom_types</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>smile str</code>: smiles string to modify</p>
</li>
<li><p><code>atom_types list[str, int]</code>: list of allowed atom types to add.
If <code>-1</code> is in the list, variants of <code>smile</code> with one atom removed
will be generated. If <code>-2</code> is in the list, the code will look for
atoms with two neighbors, remove the center atom and bond the
neighbors (ie ring contraction)</p>
</li>
<li><p><code>cpus Optional[int]</code>: number of cpus to use for multiprocessing.
If None, serial processing is used</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">add_atom_combi</span><span class="p">(</span><span class="s1">&#39;C1CN=CCC1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_bond_combi" class="doc_header"><code>add_bond_combi</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1403" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_bond_combi</code>(<strong><code>smile</code></strong>, <strong><code>max_ring_size</code></strong>=<em><code>8</code></em>, <strong><code>cpus</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>add_bond_combi - creates variants of <code>smile</code> with a single
bond added or removed</p>
<p>Inputs:</p>
<ul>
<li><p><code>smile str</code>: smiles string to modify</p>
</li>
<li><p><a href="/mrl/chem#max_ring_size"><code>max_ring_size</code></a>: maximum allowed ring size</p>
</li>
<li><p><code>cpus Optional[int]</code>: number of cpus to use for multiprocessing.
If None, serial processing is used</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_one_bond" class="doc_header"><code>add_one_bond</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1483" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_one_bond</code>(<strong><code>inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">add_bond_combi</span><span class="p">(</span><span class="s1">&#39;C1CN=CCC1&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Proteins">Proteins<a class="anchor-link" href="#Proteins"> </a></h2><p>Functions designed for manipulating proteins as amino acid sequences.</p>
<h4 id="Current-Limitations">Current Limitations<a class="anchor-link" href="#Current-Limitations"> </a></h4><p>The underlying RDKit utils for amino acids are somewhat more restricted than those for SMILES strings. Only standard amino acid characters can be used (ie no wildcards).</p>
<p>Proteins are represented as FASTA sequences, ie <code>MKDCSNGCSAECTGEGG</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_protein" class="doc_header"><code>to_protein</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1517" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_protein</code>(<strong><code>sequence_or_mol</code></strong>)</p>
</blockquote>
<p>Convert amino acid sequence to Chem.Mol</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_sequence" class="doc_header"><code>to_sequence</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1533" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_sequence</code>(<strong><code>sequence_or_mol</code></strong>)</p>
</blockquote>
<p>Converts sequence Mol into string</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_proteins" class="doc_header"><code>to_proteins</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1544" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_proteins</code>(<strong><code>list_of_inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_sequences" class="doc_header"><code>to_sequences</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/chem.py#L1547" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_sequences</code>(<strong><code>list_of_inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_protein</span><span class="p">(</span><span class="s1">&#39;MKDCSNGCSAECTGEGG&#39;</span><span class="p">))</span><span class="o">==</span><span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span>
<span class="k">assert</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">to_protein</span><span class="p">(</span><span class="s1">&#39;MKDCSNGCSAECTGEGG&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;MKDCSNGCSAECTGEGG&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

