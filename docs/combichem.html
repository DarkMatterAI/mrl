---

title: Combichem


keywords: fastai
sidebar: home_sidebar

summary: "Combinatorial chemistry functions"
description: "Combinatorial chemistry functions"
nb_path: "nbs/23_combichem.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/23_combichem.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Combichem">Combichem<a class="anchor-link" href="#Combichem"> </a></h2><p>Combichem methods use stochastic rules-based molecular changes to generate new compounds. Combichem consists of the following steps:</p>
<ol>
<li>Library generation - create the next iteration of the library</li>
<li>Library scoring - apply a numeric score to each item in the library</li>
<li>Library pruning - remove low scoring compounds</li>
</ol>
<p>Library generation consists of two main steps - <strong>mutation</strong> and <strong>crossover</strong>.</p>
<p>A mutation is a process that maps a single molecule to a new molecule. Custom mutations can be created by subclassing <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a></p>
<p>Crossover is a process where a pair of molelcules is used to generate a new molecule that contains features of each parent molecule. Custom crossovers can be created by subclassing <a href="/mrl/combichem.html#Crossover"><code>Crossover</code></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Crossover" class="doc_header"><code>class</code> <code>Crossover</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L21" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Crossover</code>(<strong><code>name</code></strong>=<em><code>'crossover'</code></em>)</p>
</blockquote>
<p>Crossover - base class for crossover events.
To create custom crossovers, subclass <a href="/mrl/combichem.html#Crossover"><code>Crossover</code></a>
and implement the <a href="/mrl/combichem.html#Crossover.crossover"><code>Crossover.crossover</code></a> method</p>
<p>When called, <a href="/mrl/combichem.html#Crossover"><code>Crossover</code></a> is passed a list of <code>Mol</code>
objects. The crossover operation randomly generates
molecular pairs, and sends those pairs to <a href="/mrl/combichem.html#Crossover.crossover"><code>Crossover.crossover</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Crossover.crossover" class="doc_header"><code>Crossover.crossover</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Crossover.crossover</code>(<strong><code>mol_pair</code></strong>)</p>
</blockquote>
<p>crossover - performs crossover operation</p>
<p>Inputs:</p>
<ul>
<li><code>mol_pair list[Chem.Mol, Chem.Mol]</code>: list of two
Mol objects</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FragmentCrossover" class="doc_header"><code>class</code> <code>FragmentCrossover</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L65" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FragmentCrossover</code>(<strong><code>full_crossover</code></strong>=<em><code>False</code></em>, <strong><code>name</code></strong>=<em><code>'fragment crossover'</code></em>) :: <a href="/mrl/combichem.html#Crossover"><code>Crossover</code></a></p>
</blockquote>
<p>FragmentCrossover - crossover based on
molecular fragmentation.</p>
<p>Each Mol is fragmented into a set of
<code>(scaffold, rgroup)</code> pairs by cutting
single bonds in the molecule.</p>
<p>During crossover, molecular pairs are
merged following <code>scaffold1 + rgroup2</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>full_crossover bool</code>: if True, all
<code>scaffold, rgroup</code> combinations are generated</p>
</li>
<li><p><code>name str</code>: crossover name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;files/smiles.csv&#39;</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="n">cx</span> <span class="o">=</span> <span class="n">FragmentCrossover</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">cx</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Mutator" class="doc_header"><code>class</code> <code>Mutator</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L139" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Mutator</code>(<strong><code>name</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Mutator - base class for mutations.
To create custom mutations, subclass
<a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a> and implement <a href="/mrl/combichem.html#Mutator.mutate"><code>Mutator.mutate</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SmartsMutator" class="doc_header"><code>class</code> <code>SmartsMutator</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L179" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SmartsMutator</code>(<strong><code>smarts</code></strong>, <strong><code>name</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a></p>
</blockquote>
<p>SmartsMutator - SMARTS reaction based
mutator.</p>
<p>Inputs:</p>
<ul>
<li><p><code>smarts list[str]</code>: list of SMARTS reaction strings</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ChangeAtom" class="doc_header"><code>class</code> <code>ChangeAtom</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L230" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ChangeAtom</code>(<strong><code>atom_types</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>ChangeAtom - SMARTS-based mutator that
changes atom type without changing
molecular structure</p>
<p>Inputs:</p>
<ul>
<li><code>atom_types Optional[list[str]]</code>: list of
allowed atom types. Must be strings of
atomic weights, ie <code>['6', '7', '8']</code></li>
</ul>
<p>Default: <code>['6', '7', '8', '9', '15', '16', '17', '35']</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AppendAtomSingle" class="doc_header"><code>class</code> <code>AppendAtomSingle</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L259" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AppendAtomSingle</code>(<strong><code>atom_types</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>AppendAtomSingle - SMARTS-based mutator
that appends an atom somewhere on the
input structure with a single bond</p>
<p>Inputs:</p>
<ul>
<li><code>atom_types Optional[list[str]]</code>: list of
allowed atom types. Must be strings of
atomic symbols, ie <code>['C', 'N', 'O']</code></li>
</ul>
<p>Default: <code>['C', 'N', 'O', 'F', 'P', 'S', 'Cl', 'Br']</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AppendAtomsDouble" class="doc_header"><code>class</code> <code>AppendAtomsDouble</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L285" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AppendAtomsDouble</code>(<strong><code>atom_types</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>AppendAtomsDouble - SMARTS-based mutator
that appends an atom somewhere on the
input structure with a double bond</p>
<p>Inputs:</p>
<ul>
<li><code>atom_types Optional[list[str]]</code>: list of
allowed atom types. Must be strings of
atomic symbols, ie <code>['C', 'N', 'O']</code>.
Atom types must be compatible with
forming a double bond</li>
</ul>
<p>Default: <code>['C', 'N', 'O', 'P', 'S']</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AppendAtomsTriple" class="doc_header"><code>class</code> <code>AppendAtomsTriple</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L313" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AppendAtomsTriple</code>(<strong><code>atom_types</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>AppendAtomsTriple - SMARTS-based mutator
that appends an atom somewhere on the
input structure with a triple bond</p>
<p>Inputs:</p>
<ul>
<li><code>atom_types Optional[list[str]]</code>: list of
allowed atom types. Must be strings of
atomic symbols, ie <code>['C', 'N']</code>.
Atom types must be compatible with
forming a triple bond</li>
</ul>
<p>Default: <code>['C', 'N']</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AppendAtom" class="doc_header"><code>class</code> <code>AppendAtom</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L341" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AppendAtom</code>() :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>AppendAtom - SMARTS-based mutator
that appends an atom somewhere on the
input structure.</p>
<p>Combines <a href="/mrl/combichem.html#AppendAtomSingle"><code>AppendAtomSingle</code></a>,
<a href="/mrl/combichem.html#AppendAtomsDouble"><code>AppendAtomsDouble</code></a> and <a href="/mrl/combichem.html#AppendAtomsTriple"><code>AppendAtomsTriple</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DeleteAtom" class="doc_header"><code>class</code> <code>DeleteAtom</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L358" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DeleteAtom</code>() :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>DeleteAtom - SMARTS-based mutator
that randomly deletes an atom from
the input structure</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ChangeBond" class="doc_header"><code>class</code> <code>ChangeBond</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L376" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ChangeBond</code>() :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>ChangeBond - SMARTS-based mutator
that randomly changes a bond in the
input structure</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InsertAtomSingle" class="doc_header"><code>class</code> <code>InsertAtomSingle</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L394" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InsertAtomSingle</code>(<strong><code>atom_types</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>InsertAtomSingle - SMARTS-based mutator
that randomly inserts an atom into
the input structure with single bonds</p>
<p>Inputs:</p>
<ul>
<li><code>atom_types Optional[list[str]]</code>: list of
allowed atom types. Must be strings of
atomic symbols, ie <code>['C', 'N', 'O']</code></li>
</ul>
<p>Default: <code>['C', 'N', 'O', 'P', 'S']</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InsertAtomDouble" class="doc_header"><code>class</code> <code>InsertAtomDouble</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L420" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InsertAtomDouble</code>(<strong><code>atom_types</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>InsertAtomDouble - SMARTS-based mutator
that randomly inserts an atom into
the input structure with a double bond</p>
<p>Inputs:</p>
<ul>
<li><code>atom_types Optional[list[str]]</code>: list of
allowed atom types. Must be strings of
atomic symbols, ie <code>['C', 'N', 'O']</code>.
Atom types must be compatible with
forming a double bond</li>
</ul>
<p>Default: <code>['C', 'N', 'P', 'S']</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InsertAtomTriple" class="doc_header"><code>class</code> <code>InsertAtomTriple</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L450" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InsertAtomTriple</code>() :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>InsertAtomTriple - SMARTS-based mutator
that randomly inserts an atom into
the input structure with a triple bond</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InsertAtom" class="doc_header"><code>class</code> <code>InsertAtom</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L463" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InsertAtom</code>() :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>InsertAtom - SMARTS-based mutator
that randomly inserts an atom into
the input structure.</p>
<p>Combines <a href="/mrl/combichem.html#InsertAtomSingle"><code>InsertAtomSingle</code></a>,
<a href="/mrl/combichem.html#InsertAtomDouble"><code>InsertAtomDouble</code></a> and <a href="/mrl/combichem.html#InsertAtomTriple"><code>InsertAtomTriple</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AddRing" class="doc_header"><code>class</code> <code>AddRing</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L480" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AddRing</code>() :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>AddRing - SMARTS-based mutator
that randomly creates rings</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AllSmarts" class="doc_header"><code>class</code> <code>AllSmarts</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L496" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AllSmarts</code>() :: <a href="/mrl/combichem.html#SmartsMutator"><code>SmartsMutator</code></a></p>
</blockquote>
<p>AllSmarts - SMARTS-based mutator
that combines <a href="/mrl/combichem.html#ChangeAtom"><code>ChangeAtom</code></a>,
<a href="/mrl/combichem.html#AppendAtom"><code>AppendAtom</code></a>, <a href="/mrl/combichem.html#DeleteAtom"><code>DeleteAtom</code></a>,
<a href="/mrl/combichem.html#ChangeBond"><code>ChangeBond</code></a>, <a href="/mrl/combichem.html#InsertAtom"><code>InsertAtom</code></a>,
and <a href="/mrl/combichem.html#AddRing"><code>AddRing</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AppendRgroupMutator" class="doc_header"><code>class</code> <code>AppendRgroupMutator</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L516" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AppendRgroupMutator</code>(<strong><code>rgroups</code></strong>, <strong><code>name</code></strong>=<em><code>'Rgroup'</code></em>) :: <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a></p>
</blockquote>
<p>AppendRgroupMutator - randomly
appends r-groups to the input molecule</p>
<p>Inputs:</p>
<ul>
<li><p><code>rgroups list[str]</code>: list of rgroups. All
rgroups should have a single wildcard (<code>*</code>) atom</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EnumerateHeterocycleMutator" class="doc_header"><code>class</code> <code>EnumerateHeterocycleMutator</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L561" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EnumerateHeterocycleMutator</code>(<strong><code>depth</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>'enum heteroatoms'</code></em>) :: <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a></p>
</blockquote>
<p>EnumerateHeterocycleMutator - mutates
input molecule by enumerating nitrogens
on heterocycles</p>
<p>Inputs:</p>
<ul>
<li><p><code>depth int</code>: number of recursive enumerations</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">EnumerateHeterocycleMutator</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>72</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ShuffleNitrogen" class="doc_header"><code>class</code> <code>ShuffleNitrogen</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L586" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ShuffleNitrogen</code>(<strong><code>n_shuffles</code></strong>, <strong><code>name</code></strong>=<em><code>'shuffle nitrogen'</code></em>) :: <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a></p>
</blockquote>
<p>ShuffleNitrogen - mutates input molecule
by shuffling the positions of carbon and nitrogen
atoms in the molecule</p>
<p>Inputs:</p>
<ul>
<li><p><code>n_shuffles int</code>: number of shuffled variants to
generate</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ContractAtom" class="doc_header"><code>class</code> <code>ContractAtom</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L634" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ContractAtom</code>(<strong><code>include_rings</code></strong>=<em><code>True</code></em>, <strong><code>name</code></strong>=<em><code>'contract'</code></em>) :: <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a></p>
</blockquote>
<p>ContractAtom - mutates input molecule by
removing an atom with two bonds and joining
the removed atoms neighbors with a single bond.</p>
<p>ie <code>a-b-c -&gt; a-c</code></p>
<p>Inputs:</p>
<ul>
<li><p><code>include_rings bool</code>: if True, rings will be
contracted</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SelfiesMutator" class="doc_header"><code>class</code> <code>SelfiesMutator</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L693" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SelfiesMutator</code>(<strong><code>n_augs</code></strong>, <strong><code>name</code></strong>=<em><code>'selfies'</code></em>) :: <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a></p>
</blockquote>
<p>SelfiesMutator - base class for SELFIES
based mutation</p>
<p>Inputs:</p>
<ul>
<li><p><code>n_augs int</code>: number of mutated versions
to generate</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SelfiesInsert" class="doc_header"><code>class</code> <code>SelfiesInsert</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L733" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SelfiesInsert</code>(<strong><code>n_augs</code></strong>, <strong><code>name</code></strong>=<em><code>'selfies insert'</code></em>) :: <a href="/mrl/combichem.html#SelfiesMutator"><code>SelfiesMutator</code></a></p>
</blockquote>
<p>SelfiesInsert - SELFIES insertion mutator.
Randomly inserts a SELFIES token into
the input compound</p>
<p>Inputs:</p>
<ul>
<li><p><code>n_augs int</code>: number of mutated versions
to generate</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">SelfiesInsert</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>20</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SelfiesReplace" class="doc_header"><code>class</code> <code>SelfiesReplace</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L757" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SelfiesReplace</code>(<strong><code>n_augs</code></strong>, <strong><code>name</code></strong>=<em><code>'selfies replace'</code></em>) :: <a href="/mrl/combichem.html#SelfiesMutator"><code>SelfiesMutator</code></a></p>
</blockquote>
<p>SelfiesReplace - SELFIES replacement mutator.
Randomly replaces a SELFIES token in
the input compound</p>
<p>Inputs:</p>
<ul>
<li><p><code>n_augs int</code>: number of mutated versions
to generate</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">SelfiesReplace</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>20</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SelfiesRemove" class="doc_header"><code>class</code> <code>SelfiesRemove</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L781" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SelfiesRemove</code>(<strong><code>n_augs</code></strong>, <strong><code>name</code></strong>=<em><code>'selfies remove'</code></em>) :: <a href="/mrl/combichem.html#SelfiesMutator"><code>SelfiesMutator</code></a></p>
</blockquote>
<p>SelfiesRemove - SELFIES removal mutator.
Randomly removes a SELFIES token in
the input compound</p>
<p>Inputs:</p>
<ul>
<li><p><code>n_augs int</code>: number of mutated versions
to generate</p>
</li>
<li><p><code>name str</code>: mutator name</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MutatorCollection" class="doc_header"><code>class</code> <code>MutatorCollection</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L804" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MutatorCollection</code>(<strong><code>mutators</code></strong>, <strong><code>p_mutators</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>MutatorCollection - orchestrates a
set of <a href="/mrl/combichem.html#Mutator"><code>Mutator</code></a> classes. When called,
randomly selects a mutator to apply
to the input mol</p>
<p>Inputs:</p>
<ul>
<li><p><code>mutators list[Mutator]</code>: list of mutator
objects</p>
</li>
<li><p><code>p_mutators Optional[list[float]]</code>: Optional
list of probabilities for selecting
each mutator. If None, a uniform distribution
is applied</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CombiChem" class="doc_header"><code>class</code> <code>CombiChem</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/combichem.py#L847" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CombiChem</code>(<strong><code>mutator_collection</code></strong>=<em><code>None</code></em>, <strong><code>crossovers</code></strong>=<em><code>None</code></em>, <strong><code>template</code></strong>=<em><code>None</code></em>, <strong><code>rewards</code></strong>=<em><code>None</code></em>, <strong><code>prune_percentile</code></strong>=<em><code>90</code></em>, <strong><code>max_library_size</code></strong>=<em><code>None</code></em>, <strong><code>log</code></strong>=<em><code>False</code></em>, <strong><code>p_explore</code></strong>=<em><code>0.0</code></em>)</p>
</blockquote>
<p>CombiChem - class for running
combichem operations</p>
<p>Inputs:</p>
<ul>
<li><p><code>mutator_collection Optional[MutatorCollection]</code>:
Collection of mutations to use</p>
</li>
<li><p><code>crossovers Optional[list[Crossover]]</code>:
list of <a href="/mrl/combichem.html#Crossover"><code>Crossover</code></a> objects</p>
</li>
<li><p><code>template Optional[Template]</code>: <a href="/mrl/template.template.html#Template"><code>Template</code></a> to
control chemical space</p>
</li>
<li><p><code>rewards Optional[Reward]</code>: Rewards to
score molecules</p>
</li>
<li><p><code>prune_percentile int[0,100]</code>: Percentile
of compounds to keep during pruning</p>
</li>
<li><p><code>max_library_size Optional[int]</code>: Maximum
library size after pruning</p>
</li>
<li><p><code>log bool</code>: If True, compounds generated by
combichem are logged</p>
</li>
<li><p><code>p_explore float[0.,1.]</code>: Percentage of
compounds below <code>prune_percentile</code> to keep</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

