---

title: Filters


keywords: fastai
sidebar: home_sidebar

summary: "Filters are used to define pass/fail criteria for screening molecules"
description: "Filters are used to define pass/fail criteria for screening molecules"
nb_path: "nbs/02_template.filters.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_template.filters.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>//anaconda3/envs/mrl/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">Overview<a class="anchor-link" href="#Overview"> </a></h2><p>A core concept in MRL is using molecular templates, expressed with the <a href="/mrl/template.template.html#Template"><code>Template</code></a> class, to define chemical spaces. A template contains a set of filters that define desirable property ranges, such as</p>

<pre><code>Molecular weight: 250-450
Rotatable bonds: Less than 8
PAINS Filter: Pass</code></pre>
<p>These property specifications are expressed through the <a href="/mrl/template.filters.html#Filter"><code>Filter</code></a> class. The primary function of a filter is to define some pass/fail criteria for a molecule. This is done through the <code>property_function</code> and <code>criteria_function</code> methods. <code>property_function</code> computes some value based on the input molecule. <code>criteria_function</code> converts the output of <code>property_function</code> to a single boolean value.</p>
<p>Filters follow the conovention that <code>True</code> means the input <code>Mol</code> has passed the <code>criteria_function</code> function, while <code>False</code> means the <code>Mol</code> has failed the <code>criteria_function</code>.</p>
<p>We can also use filters to express a soft preference for chemical properties by adding a score. If a score is provided, the output of <code>property_function</code> and <code>criteria_function</code> are sent to a <a href="/mrl/template.filters.html#ScoreFunction"><code>ScoreFunction</code></a> subclass, which returns a numeric value.</p>
<p>This allows us to use filters to define both the <strong>must-have</strong> chemical properties as well as <strong>nice-to-have</strong> properties. For example:</p>

<pre><code>Must Have:
Molecular weight: 250-450, 
Rotatable bonds: Less than 8
PAINS Filter: Pass

Nice To Have:
Molecular weight: 350-400 (+1), 
TPSA: Less than 80 (+1)
Substructure Match: '[#6]1:[#6]:[#7]:[#6]:[#6]:[#6]:1' (+3)
Substructure Match: '[#6]1:[#6]:[#7]:[#7]:[#7]:[#6]:1' (-1)</code></pre>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Score-Functions">Score Functions<a class="anchor-link" href="#Score-Functions"> </a></h2><p><a href="/mrl/template.filters.html#ScoreFunction"><code>ScoreFunction</code></a> classes take the outputs of a filter (both <code>property_function</code> and <code>criteria_function</code>, see <a href="/mrl/template.filters.html#Filter"><code>Filter</code></a> for more details) and return a numeric score. This can be used to incentivise a generative model to produce molecules with specific properties without making those properties must-have constraints.</p>
<p><a href="/mrl/template.filters.html#ConstantScore"><code>ConstantScore</code></a> returns a standard value based on if the <code>criteria_output</code> is <code>True</code> or <code>False</code>. For more sophisticated scores like those seen in MPO functions, something like <a href="/mrl/template.filters.html#LinearDecayScore"><code>LinearDecayScore</code></a> can be used, which returns a constant score within a certain range, but decays the score outside that range.</p>
<p><a href="/mrl/template.filters.html#ScoreFunction"><code>ScoreFunction</code></a> can be subclassed with any variant that takes as input <code>property_output</code> and <code>criteria_output</code> and returns a numeric value</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ScoreFunction" class="doc_header"><code>class</code> <code>ScoreFunction</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ScoreFunction</code>()</p>
</blockquote>
<p>Base score function</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NoScore" class="doc_header"><code>class</code> <code>NoScore</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L21" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NoScore</code>() :: <a href="/mrl/template.filters.html#ScoreFunction"><code>ScoreFunction</code></a></p>
</blockquote>
<p>Pass through for no score</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PassThroughScore" class="doc_header"><code>class</code> <code>PassThroughScore</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L26" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PassThroughScore</code>() :: <a href="/mrl/template.filters.html#ScoreFunction"><code>ScoreFunction</code></a></p>
</blockquote>
<p>Pass through for property_output</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ModifiedScore" class="doc_header"><code>class</code> <code>ModifiedScore</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L31" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ModifiedScore</code>(<strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#ScoreFunction"><code>ScoreFunction</code></a></p>
</blockquote>
<p>Base class for scores where property_output is modified by some function</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ConstantScore" class="doc_header"><code>class</code> <code>ConstantScore</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L48" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ConstantScore</code>(<strong><code>pass_score</code></strong>, <strong><code>fail_score</code></strong>) :: <a href="/mrl/template.filters.html#ModifiedScore"><code>ModifiedScore</code></a></p>
</blockquote>
<p>Returns pass_score if criteria_output, else fail_score</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WeightedPropertyScore" class="doc_header"><code>class</code> <code>WeightedPropertyScore</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L57" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WeightedPropertyScore</code>(<strong><code>weight</code></strong>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#ModifiedScore"><code>ModifiedScore</code></a></p>
</blockquote>
<p>Returns weight*property_output if criteria_output, else fail_score</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PropertyFunctionScore" class="doc_header"><code>class</code> <code>PropertyFunctionScore</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L66" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PropertyFunctionScore</code>(<strong><code>function</code></strong>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#ModifiedScore"><code>ModifiedScore</code></a></p>
</blockquote>
<p>Returns output <code>function(property_output)</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LinearDecayScore" class="doc_header"><code>class</code> <code>LinearDecayScore</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L76" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LinearDecayScore</code>(<strong><code>pass_score</code></strong>, <strong><code>low_start</code></strong>, <strong><code>low_end</code></strong>, <strong><code>high_start</code></strong>, <strong><code>high_end</code></strong>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#ScoreFunction"><code>ScoreFunction</code></a></p>
</blockquote>
<p>LinearDecayScore - score with linear decay. <code>low_start&lt;low_end&lt;high_start&lt;high_end</code></p>
<p>Returns <code>pass_score</code> if <code>criteria_output=True</code> and
<code>low_end&lt;=property_output&lt;=high_start</code>. If <code>low_start&lt;=property_output&lt;=low_end</code> or
<code>high_start&lt;=property_output&lt;=high_end</code>, the score is a linear interpolation between <code>pass_score</code>
and <code>fail_score</code>. Otherwise, returns <code>fail_score</code>.</p>
<p>One of <code>low_end</code>, <code>high_start</code> must be not None.</p>
<p>If one of <code>low_end</code>, <code>high_start</code> is None, the corresponding bound is ignored</p>
<p>if <code>low_start</code> or <code>high_end</code> is None, the score immediately drops to <code>fail_score</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">score</span> <span class="o">=</span> <span class="n">LinearDecayScore</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">fail_score</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">),[</span><span class="n">score</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x11e86e5f8&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAD4CAYAAADhNOGaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3de3zU9Z3v8dcnN0K4B8ItFxISUAEFIVwERIJi0bairRdstba1pSp02253u/axZ/fs45w9++hj9+z27CpqabXaapXgDVrxLhfxApnIXVRCuMwkIYQA4RJy/5w/ZmDTNEDCTOY7l8/z8ZjHzPwuM28lmU++v9/8Pl9RVYwxxsSvBNcBjDHGuGWFwBhj4pwVAmOMiXNWCIwxJs5ZITDGmDiX5DrApRgyZIjm5ua6jmGMMVGltLT0iKpmdFwelYUgNzcXj8fjOoYxxkQVETnQ2XI7NGSMMXHOCoExxsQ5KwTGGBPnrBAYY0ycs0JgjDFxLiSFQESeEpHDIrLzPOtFRP5LRMpEZLuITG63boGIfB5Y93Ao8hhjjOm6UI0IngYWXGD9TcCYwG0x8DiAiCQCywLrxwF3i8i4EGUyxhjTBSG5jkBVN4hI7gU2WQj8Tv09rz8WkYEiMgLIBcpUtRxARF4IbPtpKHKZyHWqsYU/bDrAqYYW11FiUmpKIt+YlsPAtBTXUUwUCNcFZZmAt91zX2BZZ8und/YCIrIY/2iCnJycnklpwuJA7Wm+/zsPX1SfQsR1mtikCn/YdJAn7pnChMwBruOYCBeuQtDZr7teYPlfLlRdDiwHKCwstNl0otTGPUdY8odPAHj2/unMHjPEcaLYtOXgMR567hO+9viH/POtE7izMNt1JBPBwvWtIR/Q/icxC6i8wHITY1SV37xfzree2sSw/r1YvXSWFYEedHXOIP70w9lMzR3Ez17czs9f3k5Dc6vrWCZChasQrAa+Ffj20AygTlWrgBJgjIjkiUgKsCiwrYkhDc2t/HTlNv75td3MHzeMlx+axajBfVzHinmD+/bid9+dzkNz83l+s5c7nvgI37F617FMBArJoSEReR6YCwwRER/wP4FkAFV9AlgD3AyUAfXAdwLrWkRkKfAmkAg8paq7QpHJRIbaU4189xkP27zH+fENY/ireWNISLATA+GSmCD8bMHlTMoeyE+Lt/GVRzbyzHemMTF7oOtoJoJINE5eX1hYqNZ9NDr8n9c+5bcf7OfRb0xmwYThruPEtX1HTnPXrz4id3Afih+4xnUc44CIlKpqYcfldmWx6TFNLW28/EkFN1wxzIpABMgb0ocH5+azef9RNpXXuo5jIogVAtNj3vusmtrTTdw5Nct1FBOwaGoOg/uk8OjaMtdRTASxQmB6TLHHx7D+vZgz5i8mRDKO9E5J5P5r83h/zxG2eY+7jmMihBUC0yMO1TWw7vPD3D4li6RE+zGLJPfOGEX/1CSW2ajABNhvqOkRL33io03hjil2IVOk6ZeazLdn5fHWp9V8fuik6zgmAlghMCGnqqz0eJmel07uELteIBJ9Z2YuaSmJPLbORgXGCoHpAZv3HWV/bb21NYhgg/qkcM+MUfxxWyX7j5x2Hcc4ZoXAhNwKj5e+vZK4+coRrqOYC/je7DySEhN4fN1e11GMY1YITEidbGhmzY4qvjpxJL1TEl3HMRcwtH8qi6Zm8/IWH5XHz7iOYxyyQmBC6o/bqmhobuOuqXZYKBr84Lp8VGH5hnLXUYxDVghMSBV7vFw2rB8Ts6wHfjTIHNib267O5PnNB6k52eg6jnHECoEJmS+qT7LVe5w7CrMQm3Emajw4N5/m1jae3LjPdRTjiBUCEzLFJV6SE4Xbrs50HcV0w+iMvtx85Qh+/9F+jtc3uY5jHLBCYEKiqaWNl7f4G8wN7tvLdRzTTUuKCjjd1MrTH+53HcU4YIXAhMR7n1Vz9HQTd9pJ4qh0xYj+3HDFMH77wX5ONba4jmPCzAqBCYkVJV6G90+1BnNRbOm8AurONPPcxwdcRzFhFpJCICILRORzESkTkYc7Wf+3IrI1cNspIq0ikh5Yt19EdgTW2WwzUehQXQPrv6jh9ilZJNrsY1FrUvZAZhcM4dfv77P5jeNM0IVARBKBZcBNwDjgbhEZ134bVf03VZ2kqpOAnwPrVfVou02KAuv/YuYcE/nONZgrtHkHot2SogKOnGqk2ON1HcWEUShGBNOAMlUtV9Um4AVg4QW2vxt4PgTvayJAW5tS7PEyY3S6TUgfA2aMTmfKqEH8an05TS1truOYMAlFIcgE2v/54Ass+wsikgYsAF5qt1iBt0SkVEQWn+9NRGSxiHhExFNTUxOC2CYUNu8/yoHaeruSOEaICEvnFVBx/AyvbqlwHceESSgKQWcHhfU8234V+KDDYaFZqjoZ/6GlJSIyp7MdVXW5qhaqamFGhp2QjBTFJV769UpiwXhrMBcr5o7NYEJmfx5fv5fWtvP9KptYEopC4APa/zmYBVSeZ9tFdDgspKqVgfvDwCv4DzWZKHCioZk1O6u4ZZI1mIslIsKSuQXsO3Ka13ZUuY5jwiAUhaAEGCMieSKSgv/DfnXHjURkAHAdsKrdsj4i0u/sY+BGYGcIMpkw+OO2Shqa22zegRj0pfHDKRjal8fWltFmo4KYF3QhUNUWYCnwJrAbKFbVXSLygIg80G7T24C3VLX9LBjDgI0isg3YDLymqm8Em8mER7HHx+XD+3GVNZiLOQkJwkNz8/ns0Ene/eyw6zimhyWF4kVUdQ2wpsOyJzo8fxp4usOycmBiKDKY8Pr80Em2eY/zD18ZZw3mYtQtE0fyy3e+4NG1ZdxwxVD7d45hdmWxuSTFHmswF+uSEhN48LoCtnmP80FZres4pgdZITDd1tTSxitbKpg/bhjpfVJcxzE96OtTMhneP5VH3tvjOorpQVYITLe9uzvQYM5OEse8XkmJfH/OaDbtO4pn/9GL72CikhUC020rPF5GDEjlWmswFxfunpZNep8UHl1b5jqK6SFWCEy3VNWdYYM1mIsraSlJ3D87j3Wf17Czos51HNMDrBCYbnmpNNBgboodFoon914zin6pSSyzUUFMskJguszfYM7HjNHp5AxOcx3HhFH/1GS+PTOXN3YdYk/1SddxTIhZITBdtmnfUQ4etQZz8eo7s/JITUrksXV7XUcxIWaFwHRZscdLv9QkbppgDebiUXqfFL45PYfV2yo5WFvvOo4JISsEpktONDSzZkcVCyeNJDXZGszFq+/PGU2iCI+vt1FBLLFCYLpk9dZKGluswVy8G9Y/lTsKs3ip1MehugbXcUyIWCEwXbLS4+Xy4f24MtMazMW7B67Lp1WV5RvKXUcxIWKFwFzUZ4dOsM1Xx52F2dZ4zJCdnsatkzL5w+YDHDnV6DqOCQErBOaiikt8pCQmWIM5c85DRfk0trTx1MZ9rqOYELBCYC6osaWVV7b4mD9uGIOswZwJyM/oy80TRvD7jw5Qd6bZdRwTJCsE5oLe3X2YY/XN3GnXDpgOHirK52RjC7/7cL/rKCZIISkEIrJARD4XkTIRebiT9XNFpE5EtgZu/9jVfY1bK0q8jByQyuyCIa6jmAgzfuQA5l0+lKc+2MfpxhbXcUwQgi4EIpIILANuAsYBd4vIuE42fV9VJwVu/6ub+xoHKo+fYcMeazBnzm9JUQHH6pt5fvNB11FMEEIxIpgGlKlquao2AS8AC8Owr+lhL5X6UIXbrcGcOY8powYxM38wv9pQTkNzq+s45hKFohBkAt52z32BZR1dIyLbROR1ERnfzX0RkcUi4hERT01NTQhimwtpa1NWlvqYmT/YGsyZC1paVEDNyUZWlvpcRzGXKBSFoLNjBtrh+SfAKFWdCDwCvNqNff0LVZeraqGqFmZk2IQoPe3jfbUcPFpvVxKbi7omfzBX5wzkiXV7aW5tcx3HXIJQFAIf0P7TIguobL+Bqp5Q1VOBx2uAZBEZ0pV9jRvFJf4GcwsmDHcdxUQ4EWFpUQEVx8+waqv9+kajUBSCEmCMiOSJSAqwCFjdfgMRGS6BS1JFZFrgfWu7sq8Jv7ozzby+85A1mDNdNu/yoVwxoj+PrS2jta3TQb2JYEEXAlVtAZYCbwK7gWJV3SUiD4jIA4HNbgd2isg24L+ARerX6b7BZjLBWb3N32DursIc11FMlDg7Kig/cprXd1a5jmO6SVSjr3oXFhaqx+NxHSNm3fLoRppa2nj9R9dabyHTZa1tyvxfrqdXUiJr/mq2/exEIBEpVdXCjsvtymLzZ3ZXnWC7r467plqDOdM9iQnCQ3ML2F11gvc+O+w6jukGKwTmzxR7vKQkJnDrJGswZ7pv4aSRZA3qzaNry4jGow3xygqBOcffYK6C+eOtwZy5NMmJCfzguny2HDzOR3trXccxXWSFwJzz9qfVHK9v5i67dsAE4Y4pWQzt14tH3itzHcV0kRUCc06xx8fIAanMsgZzJgipyYksnjOaj8prKT1wzHUc0wVWCAwAFcfP8P6eGm4vzLYGcyZo35iew6C0ZJattVFBNLBCYID/bjB3x5Qs11FMDEhLSeK7s/J477PD7Kqscx3HXIQVAkNbm1Ls8TKrYDDZ6dZgzoTGt2bm0q9XEo+t3es6irkIKwSGj8pr8R07Yw3mTEgN6J3MvdeMYs3OKsoOn3Idx1yAFQJDscdL/9QkvjTeGsyZ0Lp/dh69khJ4fJ2NCiKZFYI4V1d/tsFcpjWYMyE3uG8v7p6Ww6tbK/AerXcdx5yHFYI4t3pbBU0tbdxlk9ObHrJ4zmgSRXhivY0KIpUVgji3wuPlihH9GT+yv+soJkaNGNCbr0/JYqXHR/WJBtdxTCesEMSxXZV17Kw4wV2FWdZgzvSoB6/Lp1WVX28odx3FdMIKQRxb6fGRkpjAQmswZ3pYzuA0bpk4kuc2HeTo6SbXcUwHISkEIrJARD4XkTIRebiT9d8Uke2B24ciMrHduv0iskNEtoqITTIQJg3N/gZzN1qDORMmD83N50xzK7/9YJ/rKKaDoAuBiCQCy4CbgHHA3SIyrsNm+4DrVPUq4H8DyzusL1LVSZ1NmGB6xtufVlN3ptlOEpuwGTOsHwvGD+fpD/dzoqHZdRzTTihGBNOAMlUtV9Um4AVgYfsNVPVDVT3bfepj/JPUG4eKPV4yB/ZmVr41mDPhs3ReAScbWvj9RwdcRzHthKIQZALeds99gWXncz/wervnCrwlIqUisvh8O4nIYhHxiIinpqYmqMDxznesno1lR7h9ShYJ1mDOhNGEzAHMvSyDJzfuo76pxXUcExCKQtDZJ0mnUxOJSBH+QvB37RbPUtXJ+A8tLRGROZ3tq6rLVbVQVQszMjKCzRzXXiz1AXC7NZgzDiwtKuDo6Sae3+y9+MYmLEJRCHxA+wPNWUBlx41E5CrgN8BCVT03dZGqVgbuDwOv4D/UZHpIW5uy0uNjVv4QazBnnCjMTWd6XjrLN+ylsaXVdRxDaApBCTBGRPJEJAVYBKxuv4GI5AAvA/eq6hftlvcRkX5nHwM3AjtDkMmcx4d7a6k4foY7Cm00YNz54bwxVJ9o5KXSCtdRDCEoBKraAiwF3gR2A8WquktEHhCRBwKb/SMwGHisw9dEhwEbRWQbsBl4TVXfCDaTOT9rMGciwayCwUzMHsjj68toaW1zHSfuJYXiRVR1DbCmw7In2j3+HvC9TvYrByZ2XG56Rl19M2/sOsSiqdnWYM44JSIsLSrg+7/zsHpbJV+bbCNUl+zK4jiyKtBgzuYdMJHg+suHcvnwfjy2bi9tbZ1+v8SEiRWCOLKixMu4Ef2ZkDnAdRRjSEgQHioqoOzwKd7cdch1nLhmhSBO7KyoY1flCbuS2ESUL185grwhfXh0bRmqNipwxQpBnFjp8ZKSlMDCSSNdRzHmnMQE4cG5+eyqPMG6L+xCUVesEMSBhuZWXt1ayZfGD2dgmjWYM5HltqszyRzYm0ffs1GBK1YI4sBbgQZzd9q1AyYCJScm8IPrRlN64Bgflx91HScuWSGIA8Ul1mDORLY7C7MZ0rcXy9aWuY4Sl6wQxDjv0Xo+2HuEOwqtwZyJXKnJiSyek8fGsiNs9R53HSfuWCGIcdZgzkSLb04fxcC0ZB59z0YF4WaFIIa1tSkvlvqYXTCErEHWYM5Etj69kvjOzDze2V3N7qoTruPEFSsEMeyDvUcCDebs2gETHb49M5e+vZLsXEGYWSGIYcUeHwN6J3PjuGGuoxjTJQPSkrn3mlG8tqOK8ppTruPEDSsEMep4fRNv7jrErZNGWoM5E1Xun51Hr6QEHl+313WUuGGFIEat2lrpbzBnLSVMlBnStxeLpubwypYKfMfqXceJC1YIYtSKEi/jR/Zn/EhrMGeizw+uG40I/Gp9uesoccEKQQzaWVHHp1XWYM5ErxEDevP1yVms8Hg5fKLBdZyYF5JCICILRORzESkTkYc7WS8i8l+B9dtFZHJX9zXdV3y2wdzETNdRjLlkD87Np6W1jd9s3Oc6SswLuhCISCKwDLgJGAfcLSLjOmx2EzAmcFsMPN6NfU03NDS38uqWChaMH86AtGTXcYy5ZKMG9+GWiSN59uMDHDvd5DpOTAvFiGAaUKaq5araBLwALOywzULgd+r3MTBQREZ0cV/TDW/uOsSJhhabhczEhIeKCqhvauW3H9iooCeFohBkAt52z32BZV3Zpiv7AiAii0XEIyKemhrrW34+xR5/g7mZ+YNdRzEmaGOH9eNL44fx9If7OdnQ7DpOzApFIeisk1nHpuLn26Yr+/oXqi5X1UJVLczIyOhmxPjgPVrPB2W11mDOxJSlRWM40dDC7z8+4DpKzApFIfAB7Y9DZAGVXdymK/uaLlpZ6kMEaylhYsqVWQOYMzaDJ9/fx5mmVtdxYlIoCkEJMEZE8kQkBVgErO6wzWrgW4FvD80A6lS1qov7mi5obVNe9HiZXTCEzIG9XccxJqR+OK+A2tNNvFBy0HWUmBR0IVDVFmAp8CawGyhW1V0i8oCIPBDYbA1QDpQBvwYeutC+wWaKRx+UHaGyrsFOEpuYNDU3nWl56SzfUE5ji40KQi0pFC+iqmvwf9i3X/ZEu8cKLOnqvqb7ij1eBqYlc+N4azBnYtPSogK+9dRmXv6kgrun5biOE1PsyuIYcOx0E2/tqubWSZn0SrIGcyY2XTtmCFdlDeDxdXtpaW1zHSemWCGIAau2VtDU2maHhUxMExGWFBVw8Gg9f9pe5TpOTLFCEOVUlRUeH1dmDmDcyP6u4xjTo+ZfMYyxw/qybG0ZbW2dftPcXAIrBFFuV+UJdled4M5Cm5PYxL6EBP+oYM/hU7z1abXrODHDCkGUW1HipVdSArdMsgZzJj58+coR5A5OY9naMvzfQzHBskIQxRqaW1m1tYIFE4YzoLc1mDPxISkxgQfn5rOjoo71X1i7mVCwQhDFzjaYu8tOEps4c9vVWYwckGqT3IeIFYIotqLES3Z6b2aMtgZzJr6kJCWweM5oSvYfY1N5res4Uc8KQZTyHq3nw7213DEl2xrMmbi0aFoOQ/qm8KiNCoJmhSBKrfR4EYHbp9i3hUx8Sk1O5P7Zo3l/zxG2eY+7jhPVrBBEodY25cVSH9eOyWCkNZgzceyeGTkM6J1so4IgWSGIQhsDDebsJLGJd/1Sk/n2zFze/rSazw6dcB0nalkhiELFHi+D0pK5YdxQ11GMce47s3Lpk5LIY2v3uo4StawQRJljp5t4e1c1t15tDeaMARiYlsI9M0bxp+2V7D9y2nWcqGSFIMq8Gmgwd9dUOyxkzFn3X5tHUmICj6+zUcGlsEIQRVSVFSVersoawOXDrcGcMWcN7ZfKoqnZvPSJj4rjZ1zHiTpBFQIRSReRt0VkT+B+UCfbZIvIWhHZLSK7RORH7db9k4hUiMjWwO3mYPLEup0VJ/js0ElrN21MJ35wXT4Ay9fbqKC7gh0RPAy8q6pjgHcDzztqAX6qqlcAM4AlIjKu3fpfquqkwM1mKruAFZ6D9EpK4KsTR7qOYkzEyRzYm69NzuSFEi81Jxtdx4kqwRaChcAzgcfPALd23EBVq1T1k8Djk/jnJrZWmd3kbzBXyc1XjrAGc8acx4NzC2hubeM3G8tdR4kqwRaCYapaBf4PfOCC32cUkVzgamBTu8VLRWS7iDzV2aGldvsuFhGPiHhqauKv4+AbOw9xsqGFO2zeAWPOK29IH7581Uie/egAx+ubXMeJGhctBCLyjojs7OS2sDtvJCJ9gZeAH6vq2Ss/HgfygUlAFfDv59tfVZeraqGqFmZkZHTnrWNCscdLTnoaM/KswZwxF7KkKJ/TTa08/eF+11GiRtLFNlDVG863TkSqRWSEqlaJyAjg8Hm2S8ZfBJ5T1ZfbvXZ1u21+DfypO+HjxcFaf4O5n84faw3mjLmIy4f354YrhvHbD/bzvWtH07fXRT/m4l6wh4ZWA/cFHt8HrOq4gYgI8CSwW1X/o8O6Ee2e3gbsDDJPTFpZGmgwZ4eFjOmSpfMKqDvTzLMfH3AdJSoEWwh+AcwXkT3A/MBzRGSkiJz9BtAs4F5gXidfE/1XEdkhItuBIuAnQeaJOWcbzM0Zk8GIAdZgzpiumJQ9kGvHDOE37++jobnVdZyIF9SYSVVrges7WV4J3Bx4vBHo9HiGqt4bzPvHg/f31FBV18A/fGXcxTc2xpyzpKiARcs/ZkWJl/tm5rqOE9HsyuIIt9LjY1BaMtdfYQ3mjOmO6XnpFI4axK/W76Wppc11nIhmhSCCHT3dxFufHuK2q7OswZwx3SQiLJlXQGVdA69uqXAdJ6JZIYhgr26poLlVrcGcMZdo7tgMJmT257F1ZbS2qes4EcsKQYRSVYo9XiZmDeCy4f1cxzEmKokIS+YWsL+2nj9tr3QdJ2JZIYhQOyrq+OzQSe6wBnPGBOVL44czZmhfHlu7lzYbFXTKCkGEWlHiJTU5gVsmWYM5Y4KRkCA8VJTP59UneWd39cV3iENWCCLQmaZWVm+t5OYJI+ifag3mjAnWV68aSU56GsvWlqFqo4KOrBBEoDd2VXGyscUOCxkTIkmJCTxwXT7bfHVsLDviOk7EsUIQgYpLfIwanMaM0emuoxgTM74+JZPh/VN59L0y11EijhWCCHOg9jQflddyx5Qs/G2ajDGh0CspkcVzRrNp31FK9h91HSeiWCGIMC+W+kgQ+PoUazBnTKjdPS2HwX1SbFTQgRWCCHKuwdxYazBnTE/onZLId2fnsf6LGnb46lzHiRhWCCLIhkCDubvsJLExPebea0bRLzWJZWttVHCWFYIIstLjJb1PCtdfMcx1FGNiVv/UZL49M5c3dh1iT/VJ13EighWCCFF7qpG3P63mtqszSUmyfxZjetJ3ZuWRlpLIY+v2uo4SEYL6xBGRdBF5W0T2BO47nXxeRPYHJqDZKiKe7u4fD17dWklzq3KnHRYypsel90nhm9NzWLW1ggO1p13HcS7YPz0fBt5V1THAu4Hn51OkqpNUtfAS949ZqkpxiZeJ2QOtwZwxYfL9a0eTlJjAE+ttVBBsIVgIPBN4/Axwa5j3jwnbfXV8Xn3SThIbE0ZD+6dyZ2EWL5b6qKo74zqOU8EWgmGqWgUQuD/fNFoKvCUipSKy+BL2R0QWi4hHRDw1NTVBxo4sKzz+BnNfmTjCdRRj4soP5uTTprB8Q7nrKE5dtBCIyDsisrOT28JuvM8sVZ0M3AQsEZE53Q2qqstVtVBVCzMyMrq7e8Q609TKH7dWcvOV1mDOmHDLTk/j1kmZPL/5IEdONbqO48xFC4Gq3qCqEzq5rQKqRWQEQOD+8HleozJwfxh4BZgWWNWl/WPZ6zv9DebsJLExbjxUlE9jSxtPbdznOoozwR4aWg3cF3h8H7Cq4wYi0kdE+p19DNwI7Ozq/rGu2OMld3Aa0/OswZwxLuRn9OXmK0fwu48OUFff7DqOE8EWgl8A80VkDzA/8BwRGSkiawLbDAM2isg2YDPwmqq+caH948WB2tN8XH6UOwqzrcGcMQ4tmVvAqcYWnvlov+soTiQFs7Oq1gLXd7K8Erg58LgcmNid/ePFSk+gwdxkazBnjEvjRvbn+suH8tQH+7h/dh59egX10Rh17BJWR842mLtubAbDB6S6jmNM3Fsyr4Dj9c38YdNB11HCzgqBIxv21HDoRAN3TbWTxMZEgsk5g5iZP5jl75fT0NzqOk5YWSFwpLjEy+A+Kcy73BrMGRMpls4roOZkIytLfa6jhJUVAgdqTzXyzm5rMGdMpLlm9GAm5wzkiXV7aW5tcx0nbOxTyIFXtlT4G8zZYSFjIoqIsHReARXHz/DqlgrXccLGCkGYqSrFHi+Tsgcydpg1mDMm0hRdNpRxI/rz+Lq9tLap6zhhYYUgzLb56vii+pRdSWxMhBIRlhQVUH7kNK/vrHIdJyysEITZihIvvZMT+ao1mDMmYi2YMJzRGX1YtnYvqrE/KrBCEEZnmlr54zZ/g7l+1mDOmIiVmCAsmVvA7qoTvPdZ7LdAs0IQRmt2VHGqsYU7C+1KYmMi3S2TRpI1qDePvFcW86MCKwRhdLbB3DRrMGdMxEtOTOCB6/LZ6j3Oh3trXcfpUVYIwmT/kdNs2mcN5oyJJrdPyWJov148+l6Z6yg9ygpBmKws9ZIg/h8sY0x0SE1OZPGc0XxUXkvpgWOu4/QYKwRh0NLaxoulPuZeNpRh/a3BnDHR5BvTcxiUlsyytbE7KrBCEAYb9tRQfaLRrh0wJgqlpSTx3Vl5vPfZYXZW1LmO0yOsEIRBcYkv0GBuqOsoxphL8K2ZufTrlcRj62JzVBBUIRCRdBF5W0T2BO4HdbLNZSKytd3thIj8OLDun0Skot26m4PJE4mOBBrMfW2yNZgzJloN6J3Mt2aO4vWdhyg7fNJ1nJAL9pPpYeBdVR0DvBt4/mdU9XNVnaSqk4ApQD3+CezP+uXZ9aq6puP+0e7VLRW0tKkdFjImyn13Vh6pSYk8tm6v6yghF2whWAg8E3j8DHDrRba/HtirqgeCfN+ooKqsKPFydc5AxliDOWOi2uC+vbh7Wg6rtlbiPVrvOk5IBVsIhqlqFUDg/mIHwRcBz3dYtlREtjmQx/YAAApWSURBVIvIU50dWjpLRBaLiEdEPDU1NcGlDpOt3uPsOWwN5oyJFYvnjCZRhCfWx9ao4KKFQETeEZGdndwWdueNRCQFuAVY2W7x40A+MAmoAv79fPur6nJVLVTVwoyMjO68tTPFHn+Dua9cZQ3mjIkFwwekcnthFis9Pg7VNbiOEzIXLQSqeoOqTujktgqoFpERAIH7C3Vnugn4RFWr2712taq2qmob8GtgWnD/OZGjvqmFP26r4stXWYM5Y2LJg9fl06rKr98vdx0lZII9NLQauC/w+D5g1QW2vZsOh4XOFpGA24CdQeaJGGt2HAo0mLPDQsbEkuz0NBZOHMkfNh3k6Okm13FCIthC8AtgvojsAeYHniMiI0Xk3DeARCQtsP7lDvv/q4jsEJHtQBHwkyDzRIziEi95Q/owNfe8pz2MMVHqoaJ8GlpaeWrjPtdRQiIpmJ1VtRb/N4E6Lq8Ebm73vB4Y3Ml29wbz/pGqvOYUm/cf5WcLLrMGc8bEoIKh/bhpwnCe+XA/358zmgG9o/vwr13h1ANWlvpITBBun2wN5oyJVQ/NLeBkYwu//2i/6yhBs0IQYi2tbbxU6mPu2AyGWoM5Y2LWhMwBFF2WwZMb91Hf1OI6TlCsEITY+i9qOHyykTun2kliY2Ld0nkFHKtv5g+bDrqOEhQrBCG2osTLkL7WYM6YeDBlVDozRqezfEM5Dc2truNcMisEIVRVd4Z3dldz+5RskhPtf60x8eCH88Zw+GQjL5b6XEe5ZPZpFULPb/aiwDen57iOYowJk5n5g5mUPZAn1u+lubXNdZxLYoUgRJpb23hh80GuG5tBdnqa6zjGmDAREZYWFeA7doZXt1S4jnNJrBCEyDufVnP4ZCP3TB/lOooxJsyuv2Io40f255H3yqJyVGCFIESe3XSAzIG9KbKTxMbEHRHhpzeO5eDR+qg8V2CFIATKa07xQVktd0/LJjHBriQ2Jh4VXTaUSdkDeeTdPTS2RNc3iKwQhMBzmw6SlCB27YAxcUxE+JsbL6OyroEXNntdx+kWKwRBamhu5cVSH1+aMJyh/exKYmPi2ayCwUzLS2fZ2rKouq7ACkGQ/ritkrozzXaS2BjjP1cwfyyHTzby7MfRMyOvFYIgPbvpIAVD+zJjdLrrKMaYCDB99GCuHTOEx9bt5XRjdPQgskIQhB2+OrZ5j3PP9BxrN22MOeev54/l6Okmnv5wv+soXWKFIAjPfnyA3smJfG2KtZs2xvy3q3MGMe/yoSzfUM6JhmbXcS4qqEIgIneIyC4RaRORwgtst0BEPheRMhF5uN3ydBF5W0T2BO6jZjqvujPNrNpWwcJJI+lvcxIbYzr46/ljqTvTzJPvR/4sZsGOCHYCXwM2nG8DEUkEluGfvH4ccLeIjAusfhh4V1XHAO8GnkeFlz/x0dDcxj0z7CSxMeYvTcgcwILxw3lq4z6O10f23MbBTlW5G7jY8fFpQJmqlge2fQFYCHwauJ8b2O4ZYB3wd8FkupBH3t3D6m2VIXmtqroGJmYPZELmgJC8njEm9vxk/lje/PQQN/3n+/TtFdTH7Tn/8rUrmZob2i+nhCbZhWUC7a+u8AHTA4+HqWoVgKpWich5+zOIyGJgMUBOzqV198zo14sxw/pe0r4djR3Wj/tm5obktYwxsemy4f34H18eR+mBoyF7zd7JiSF7rbMuWghE5B1geCer/l5VV3XhPTobLmgX9vvzHVSXA8sBCgsLu70/wKJpOSyaZi2ijTHhc//sPO6fnec6xgVdtBCo6g1BvocPaN97IQs4e3ymWkRGBEYDI4DDQb6XMcaYbgrH10dLgDEikiciKcAiYHVg3WrgvsDj+4CujDCMMcaEULBfH71NRHzANcBrIvJmYPlIEVkDoKotwFLgTWA3UKyquwIv8QtgvojsAeYHnhtjjAkjUb2kw+1OFRYWqsfjcR3DGGOiioiUqupfXPNlVxYbY0ycs0JgjDFxzgqBMcbEOSsExhgT56LyZLGI1ACXOuvDEOBICOOEiuXqHsvVPZareyI1FwSXbZSqZnRcGJWFIBgi4unsrLlrlqt7LFf3WK7uidRc0DPZ7NCQMcbEOSsExhgT5+KxECx3HeA8LFf3WK7usVzdE6m5oAeyxd05AmOMMX8uHkcExhhj2rFCYIwxcS6uCoGILBCRz0WkTEQiYn5kEckWkbUisltEdonIj1xnak9EEkVki4j8yXWWs0RkoIi8KCKfBf6/XeM6E4CI/CTwb7hTRJ4XkVRHOZ4SkcMisrPdsnQReVtE9gTuB0VIrn8L/DtuF5FXRGRgJORqt+5vRERFZEik5BKRHwY+x3aJyL+G4r3iphCISCKwDLgJGAfcLSLj3KYCoAX4qapeAcwAlkRIrrN+hL99eCT5T+ANVb0cmEgE5BORTOCvgEJVnQAk4p97w4WngQUdlj0MvKuqY4B3A8/D7Wn+MtfbwARVvQr4Avh5uEPReS5EJBt/e/yD4Q4U8DQdcolIEf653q9S1fHA/w3FG8VNIQCmAWWqWq6qTcAL+P+HOqWqVar6SeDxSfwfapluU/mJSBbwZeA3rrOcJSL9gTnAkwCq2qSqx92mOicJ6C0iSUAa/z0TX1ip6gag4yS5C4FnAo+fAW4Nayg6z6WqbwXmLAH4GP8Mhs5zBfwS+BmXMLVuKJwn14PAL1S1MbBNSGZ1jKdCkAl42z33ESEfuGeJSC5wNbDJbZJz/h/+X4Q210HaGQ3UAL8NHLL6jYj0cR1KVSvw/3V2EKgC6lT1Lbep/swwVa0C/x8fwFDHeTrzXeB11yEAROQWoEJVt7nO0sFY4FoR2SQi60VkaiheNJ4KgXSyLGK+OysifYGXgB+r6okIyPMV4LCqlrrO0kESMBl4XFWvBk7j5jDHnwkcc18I5AEjgT4ico/bVNFDRP4e/2HS5yIgSxrw98A/us7SiSRgEP7DyH8LFItIZ59t3RJPhcAHZLd7noWjoXtHIpKMvwg8p6ovu84TMAu4RUT24z+MNk9EnnUbCfD/O/pU9eyo6UX8hcG1G4B9qlqjqs3Ay8BMx5naqxaREQCB+5AcUggFEbkP+ArwTY2MC5vy8Rf0bYGf/yzgExEZ7jSVnw94Wf024x+tB30iO54KQQkwRkTyRCQF/4m81Y4zEajmTwK7VfU/XOc5S1V/rqpZqpqL///Ve6rq/C9cVT0EeEXkssCi64FPHUY66yAwQ0TSAv+m1xMBJ7HbWQ3cF3h8H7DKYZZzRGQB8HfALapa7zoPgKruUNWhqpob+Pn3AZMDP3uuvQrMAxCRsUAKIeiSGjeFIHBCainwJv5f0GJV3eU2FeD/y/te/H9xbw3cbnYdKsL9EHhORLYDk4B/cZyHwAjlReATYAf+3y0nbQpE5HngI+AyEfGJyP3AL4D5IrIH/zdhfhEhuR4F+gFvB372n4iQXM6dJ9dTwOjAV0pfAO4LxSjKWkwYY0yci5sRgTHGmM5ZITDGmDhnhcAYY+KcFQJjjIlzVgiMMSbOWSEwxpg4Z4XAGGPi3P8HmzNXk/ZdtcYAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">score</span> <span class="o">=</span> <span class="n">LinearDecayScore</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fail_score</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">),[</span><span class="n">score</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x11e94ca58&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Filters">Filters<a class="anchor-link" href="#Filters"> </a></h2><p>As described before, Filters serve the function of defining some pass/fail criteria for a given molecule. Filters contain a <code>property_function</code>, which computes some property of a molecule, and a <code>criteria_function</code> which converts the output of the property function to a boolean value, following the convention where <code>True</code> denotes a pass.</p>
<p>Filters can optionally contain a score, which can be any of <code>(None, int, float, ScoreFunction)</code>. A score of <code>None</code> is converted to <a href="/mrl/template.filters.html#NoScore"><code>NoScore</code></a>, while a numeric score (int or float) is converted to <a href="/mrl/template.filters.html#ConstantScore"><code>ConstantScore</code></a>.</p>
<p>The <code>eval_mol</code> function evaluates the filter on a given input. If <code>with_score=True</code> is passed, the output of <code>self.score_function</code> is returned, while if <code>with_score=False</code> is passed, the boolean output of <code>criteria_function</code> is returned</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Filter" class="doc_header"><code>class</code> <code>Filter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L168" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Filter</code>(<strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>)</p>
</blockquote>
<p>Filter - base filter function class</p>
<p>Inputs:</p>

<pre><code>`score` - one of (None, int, float, ScoreFunction), see `set_score`

`name` - (str, None), filter name used for repr

`fail_score` - (float, int), used in `set_score` if `score_function` is (int, float)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/mrl/template.filters.html#ValidityFilter"><code>ValidityFilter</code></a> and <a href="/mrl/template.filters.html#SingleCompoundFilter"><code>SingleCompoundFilter</code></a> are general molecule quantity filters. Generative models may produce invalid structures or multiple compounds when a single compound is desired. These filters can be used to eliminate those outputs</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ValidityFilter" class="doc_header"><code>class</code> <code>ValidityFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L233" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ValidityFilter</code>(<strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#Filter"><code>Filter</code></a></p>
</blockquote>
<p>ValidityFilter - checks to see if a given <code>Mol</code> is a valid compound</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SingleCompoundFilter" class="doc_header"><code>class</code> <code>SingleCompoundFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L251" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SingleCompoundFilter</code>(<strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#Filter"><code>Filter</code></a></p>
</blockquote>
<p>SingleCompoundFilter - checks to see if a given <code>Mol</code> is a single compound</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">ValidityFilter</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;CC&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;cc&#39;</span><span class="p">)</span> <span class="c1"># invalid smiles</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">SingleCompoundFilter</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;CC&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;CC.CC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most common type of filter used is one that determines if a specific molecular property is within a certain range. This is implemented with the <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a> class. <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a> will work for any <code>mol_function</code> that takes in a <code>Mol</code> object and returns a numeric output. The numeric output is then compared to <code>min_val</code> and <code>max_val</code>. Unspecified bounds (ie <code>max_val=None</code>) are ignored.</p>
<p>For convenience, a number of <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a> named after specific properties are provided</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PropertyFilter" class="doc_header"><code>class</code> <code>PropertyFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L271" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PropertyFilter</code>(<strong><code>mol_function</code></strong>, <strong><code>min_val</code></strong>=<em><code>None</code></em>, <strong><code>max_val</code></strong>=<em><code>None</code></em>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>) :: <a href="/mrl/template.filters.html#Filter"><code>Filter</code></a></p>
</blockquote>
<p>PropertyFilter - filters mols based on <code>mol_function</code></p>
<p>Inputs:</p>

<pre><code>`mol_function` - any function that takes as input a `Mol` object and returns a single numeric value

`min_val` - (None, int, float), inclusive lower bound for filter (ignored if None)

`max_val` - (None, int, float), inclusive upper bound for filter (ignored if None)

`score` - one of (None, int, float, ScoreFunction), see `FilterFunction.set_score`
`name` - (str, None), filter name used for repr

`fail_score` - (float, int), used in `set_score` if `score_function` is (int, float)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MolWtFilter" class="doc_header"><code>class</code> <code>MolWtFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L313" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MolWtFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Molecular weight filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HBDFilter" class="doc_header"><code>class</code> <code>HBDFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L318" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HBDFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Hydrogen bond donor filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HBAFilter" class="doc_header"><code>class</code> <code>HBAFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L323" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HBAFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Hydrogen bond acceptor filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TPSAFilter" class="doc_header"><code>class</code> <code>TPSAFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L328" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TPSAFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>TPSA filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RotBondFilter" class="doc_header"><code>class</code> <code>RotBondFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L333" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RotBondFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Rotatable bond filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SP3Filter" class="doc_header"><code>class</code> <code>SP3Filter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L338" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SP3Filter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Fractioon sp3 filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LogPFilter" class="doc_header"><code>class</code> <code>LogPFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L343" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LogPFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>LogP filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RingFilter" class="doc_header"><code>class</code> <code>RingFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L348" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RingFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Ring filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HeteroatomFilter" class="doc_header"><code>class</code> <code>HeteroatomFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L353" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HeteroatomFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Heteroatom filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AromaticRingFilter" class="doc_header"><code>class</code> <code>AromaticRingFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L358" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AromaticRingFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Aromatic ring filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HeavyAtomsFilter" class="doc_header"><code>class</code> <code>HeavyAtomsFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L363" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HeavyAtomsFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Number of heavy atoms filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MRFilter" class="doc_header"><code>class</code> <code>MRFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L368" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MRFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Molar refractivity of atoms filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ChargeFilter" class="doc_header"><code>class</code> <code>ChargeFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L373" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ChargeFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Formal charge of atoms filter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TotalAtomFilter" class="doc_header"><code>class</code> <code>TotalAtomFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L378" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TotalAtomFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Total number of atoms filter (incudes H)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="QEDFilter" class="doc_header"><code>class</code> <code>QEDFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L383" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>QEDFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>Total number of atoms filter (incudes H)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SAFilter" class="doc_header"><code>class</code> <code>SAFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L388" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SAFilter</code>(<strong><code>min_val</code></strong>, <strong><code>max_val</code></strong>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/mrl/template.filters.html#PropertyFilter"><code>PropertyFilter</code></a></p>
</blockquote>
<p>SA Score fillter</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">PropertyFilter</span><span class="p">(</span><span class="n">molwt</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;O=C(C)Oc1ccccc1C(=O)O&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">PropertyFilter</span><span class="p">(</span><span class="n">molwt</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;O=C(C)Oc1ccccc1C(=O)O&#39;</span><span class="p">,</span> <span class="n">with_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">MolWtFilter</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="n">WeightedPropertyScore</span><span class="p">(</span><span class="mf">2.</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;O=C(C)Oc1ccccc1C(=O)O&#39;</span><span class="p">,</span> <span class="n">with_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">molwt</span><span class="p">(</span><span class="n">to_mol</span><span class="p">(</span><span class="s1">&#39;O=C(C)Oc1ccccc1C(=O)O&#39;</span><span class="p">))</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">MolWtFilter</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;O=C(C)Oc1ccccc1C(=O)O&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">HeteroatomFilter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="s1">&#39;O=C(C)Oc1ccccc1C(=O)O&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another common filter is based on substructure matching. Substructure filtering is typically done in a hard filter fashion used to remove compounds (ie exclude all compounds with PAINS structures).</p>
<p>Substructure filters can also be used in a soft filter fashion to express a preference for molecular substructures. For example, if you would like (but not require) your compound to have a 3-ring scaffold system, that can be implemented through structural filtering as well.</p>
<p>Structure filters take in a list of SMARTS to filter against (or any subclass of <a href="/mrl/chem.html#Catalog"><code>Catalog</code></a>), as well as a <code>criteria</code> (any, all). <code>property_function</code> will return a single boolean value if <code>criteria='any'</code> (see <a href="/mrl/chem.html#Catalog.has_match"><code>Catalog.has_match</code></a>), or a list of booleans if <code>criteria='all'</code> (see <a href="/mrl/chem.html#Catalog.get_matches"><code>Catalog.get_matches</code></a>). <code>criteria_function</code> will then evaluate the <code>property_function</code> output based on <code>criteria</code>.</p>
<p>The <code>exclude</code> parameter defines how the filter treats structure matches. Substructure matching returns <code>True</code> when a match is found. If <code>exclude=True</code>, the filter will return <code>False</code> when a match is found. If <code>exclude=False</code>, the filter will return <code>True</code> when a match is found.</p>
<p>To make this more explicit, the <a href="/mrl/template.filters.html#ExclusionFilter"><code>ExclusionFilter</code></a> class always has the exclusion behavior.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="StructureFilter" class="doc_header"><code>class</code> <code>StructureFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L395" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>StructureFilter</code>(<strong><code>smarts</code></strong>, <strong><code>exclude</code></strong>=<em><code>True</code></em>, <strong><code>criteria</code></strong>=<em><code>'any'</code></em>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#Filter"><code>Filter</code></a></p>
</blockquote>
<p>StructureFilter - filters mols based on structures in <code>smarts</code></p>
<p>Inputs:</p>

<pre><code>`smarts` - (list, SmartsCatalog), list of smarts strings for filtering or [`SmartsCatalog`](/mrl/chem.html#SmartsCatalog)

`exclude` - if True, filter returns `False` when a structure match is found

`criteria` - ('any', 'all'), match criteria (match any filter, match all filters)

`score` - one of (None, int, float, ScoreFunction), see `FilterFunction.set_score`

`name` - (str, None), filter name used for repr

`fail_score` - (float, int), used in `set_score` if `score_function` is (int, float)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ExclusionFilter" class="doc_header"><code>class</code> <code>ExclusionFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L449" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ExclusionFilter</code>(<strong><code>smarts</code></strong>, <strong><code>criteria</code></strong>=<em><code>'any'</code></em>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#StructureFilter"><code>StructureFilter</code></a></p>
</blockquote>
<p>ExclusionFilter - excludes mols with substructure matches to <code>smarts</code></p>
<p>Inputs:</p>

<pre><code>`smarts` - (list, SmartsCatalog), list of smarts strings for filtering or [`SmartsCatalog`](/mrl/chem.html#SmartsCatalog)

`criteria` - ('any', 'all'), match criteria (match any filter, match all filters)

`score` - one of (None, int, float, ScoreFunction), see `FilterFunction.set_score`

`name` - (str, None), filter name used for repr

`fail_score` - (float, int), used in `set_score` if `score_function` is (int, float)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smarts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[#0]):[#6]:[#6](-[*]):[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[*]):[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6]:[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[*]-[#6]1:[#6]:[#6](-[#7]-[*]):[#6]:[#6]:[#6]:1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;[#6]1:[#6]:[#7]:[#6]:[#6]:[#6]:1&#39;</span>
<span class="p">]</span>

<span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;c1ccccc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cc(NC)ccc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cc(NC)cnc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cc1cccc(NCc2ccccc2)c1&#39;</span>
<span class="p">]</span>

<span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_mol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">StructureFilter</span><span class="p">(</span><span class="n">smarts</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="kc">True</span>

<span class="n">catalog</span> <span class="o">=</span> <span class="n">SmartsCatalog</span><span class="p">(</span><span class="n">smarts</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">StructureFilter</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">StructureFilter</span><span class="p">(</span><span class="n">smarts</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/mrl/template.filters.html#FPFilter"><code>FPFilter</code></a> allows for filtering based on fingerprint similarity. For a given molecule, a fingerpring of <code>fp_type</code> is generated and compared to <code>reference_fps</code> based on <code>fp_metric</code>. Fingerprint similarity scores greater than <code>fp_thresh</code> evaluate to <code>True</code>.</p>
<p>See <a href="/mrl/chem.html#FP"><code>FP</code></a> for fingeprint types and similarity metrics.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FPFilter" class="doc_header"><code>class</code> <code>FPFilter</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L475" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FPFilter</code>(<strong><code>reference_fps</code></strong>, <strong><code>fp_type</code></strong>, <strong><code>fp_metric</code></strong>, <strong><code>criteria</code></strong>=<em><code>'any'</code></em>, <strong><code>fp_thresh</code></strong>=<em><code>0.0</code></em>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0.0</code></em>) :: <a href="/mrl/template.filters.html#Filter"><code>Filter</code></a></p>
</blockquote>
<p>FPFilter - filters mols based on fingerprint similarity to <code>reference_smiles</code></p>
<p>Inputs:</p>

<pre><code>`reference_smiles` - (list), list of smiles or `Mol` objects for comparison

`fp_type` - fingerprint function. see [`FP`](/mrl/chem.html#FP)

`fp_metric` - fingerprint similarity metric. see [`FP`](/mrl/chem.html#FP)

`criteria` - ('any', 'all'), match criteria (match any reference, match all references)

`fp_thresh` - float, fingerprint similarity cutoff for defining a match

`name` - (str, None), filter name used for repr

`fail_score` - (float, int), used in `set_score` if `score_function` is (int, float)

`score` - one of (None, int, float, ScoreFunction), see `FilterFunction.set_score`</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FPFilter.from_smiles" class="doc_header"><code>FPFilter.from_smiles</code><a href="https://github.com/DarkMatterAI/mrl/tree/main/mrl/templates/filters.py#L534" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FPFilter.from_smiles</code>(<strong><code>reference_smiles</code></strong>, <strong><code>fp_type</code></strong>=<em><code>'ECFP6'</code></em>, <strong><code>fp_metric</code></strong>=<em><code>'tanimoto'</code></em>, <strong><code>criteria</code></strong>=<em><code>'any'</code></em>, <strong><code>fp_thresh</code></strong>=<em><code>0.0</code></em>, <strong><code>score</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>fail_score</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>creates FPFilter from <code>reference_smiles</code></p>
<p><code>reference_smiles</code> can be a list of smiles or a list of <code>Mols</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">FPFilter</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">fp_thresh</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">FPFilter</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">fp_thresh</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">FPFilter</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">fp_thresh</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">f</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span><span class="o">==</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

