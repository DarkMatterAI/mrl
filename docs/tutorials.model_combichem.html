---

title: Tutorial - Model Assisted Combichem


keywords: fastai
sidebar: home_sidebar

summary: "Tutorial on model assisted combichem"
description: "Tutorial on model assisted combichem"
nb_path: "nbs/tutorials/tutorials.model_combichem.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/tutorials/tutorials.model_combichem.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This tutorial shows how to use combichem in conjunction with a generative model</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Performance-Notes">Performance Notes<a class="anchor-link" href="#Performance-Notes"> </a></h2><p>Parts of this notebook aare CPU-constrained. If you have a multi-core machine, it is recommended that you uncomment and run the <a href="/mrl/core.html#set_global_pool"><code>set_global_pool</code></a> cells in the notebook. This will trigger the use of multiprocessing, which will result in 2-4x speedups.</p>
<p>This notebook may run slow on Collab due to CPU limitations.</p>
<p>If running on Collab, remember to change the runtime to GPU</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">mrl.imports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.chem</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.templates.all</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">mrl.torch_imports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.torch_core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.layers</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.dataloaders</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.train.reward</span> <span class="kn">import</span> <span class="n">Reward</span>
<span class="kn">from</span> <span class="nn">mrl.train.agent</span> <span class="kn">import</span> <span class="n">PredictiveAgent</span>
<span class="kn">from</span> <span class="nn">mrl.model_zoo</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mrl.combichem</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/dmai/miniconda3/envs/mrl/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: to-Python converter for boost::shared_ptr&lt;RDKit::FilterCatalogEntry const&gt; already registered; second conversion method ignored.
  return f(*args, **kwds)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Assisted-Combichem">Model Assisted Combichem<a class="anchor-link" href="#Model-Assisted-Combichem"> </a></h2><p>Model-assisted combichem involves using a generative model in conjunction with a combichem process to optimize some score function.</p>
<p>Standard combichem consists of the following steps:</p>
<ol>
<li>Library generation - create the next iteration of the library</li>
<li>Library scoring - apply a numeric score to each item in the library</li>
<li>Library pruning - remove low scoring compounds</li>
</ol>
<p>For more details on library generation, see the <a href="/mrl/tutorials.combichem.html">Combichem Tutorial</a>.</p>
<p>Model-assisted combichem incorporates a generative model into the combichem workflow:</p>
<ol>
<li>Combichem Library generation - generate compounds with a combichem process</li>
<li>Model sampling - generate compounds from a generative model</li>
<li>Library scoring - apply a numeric score to each item in the library</li>
<li>Library pruning - remove low scoring compounds</li>
<li>Model training - train the generative model on high scoring compounds</li>
</ol>
<p>We use the generative model to add compounds to the library. After scoring and pruning, we train the generative model on high scoring compounds</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Template">Template<a class="anchor-link" href="#Template"> </a></h2><p>We will use the following template to constrain chemical space</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smarts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;[#6](=[#16])(-[#7])-[#7]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#6]=[#6]=[#6]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#7][F,Cl,Br,I]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[*]#[Cl,Br]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#6;!R]=[#6;!R]-[#6;!R]=[#6;!R]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#6]#[#6]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#15]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#16]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[*]=[#17,#9,#35]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[*]=[*]=[*]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[*]-[#6]=[#6H2]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#7]~[#8]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[#7]~[#7]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;[*;R]=[*;!R]&#39;</span><span class="p">]</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">([</span><span class="n">ValidityFilter</span><span class="p">(),</span> 
                     <span class="n">SingleCompoundFilter</span><span class="p">(),</span> 
                     <span class="n">RotBondFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                     <span class="n">HeteroatomFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                     <span class="n">ChargeFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                     <span class="n">MaxRingFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                     <span class="n">MinRingFilter</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                     <span class="n">HBDFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                     <span class="n">HBAFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                     <span class="n">MolWtFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
                     <span class="n">LogPFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                     <span class="n">SAFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
                     <span class="n">BridgeheadFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                     <span class="n">PAINSAFilter</span><span class="p">(),</span>
                     <span class="n">ExclusionFilter</span><span class="p">(</span><span class="n">smarts</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">),</span>
                     <span class="n">RotChainFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
                     <span class="n">ChargeFilter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                     <span class="n">RingFilter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="p">],</span>
                    <span class="p">[],</span> 
                    <span class="n">fail_score</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_lookup</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reward">Reward<a class="anchor-link" href="#Reward"> </a></h2><p>For the reward, we will load a scikit-learn linear regression model trained to predict affinity against erbB1 using molecular fingerprints.</p>
<p>This score function is extremely simple and won't translate well to affinity. It is used as a lightweight example</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">FP_Regression_Score</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fp_function</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">failsafe_fp</span><span class="p">,</span> <span class="n">fp_function</span><span class="o">=</span><span class="n">ECFP6</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="n">to_mols</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
        <span class="n">fps</span> <span class="o">=</span> <span class="n">maybe_parallel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fp_function</span><span class="p">,</span> <span class="n">mols</span><span class="p">)</span>
        <span class="n">fps</span> <span class="o">=</span> <span class="p">[</span><span class="n">fp_to_array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">]</span>
        <span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">preds</span>
    
<span class="c1"># if in the repo</span>
<span class="n">reward_function</span> <span class="o">=</span> <span class="n">FP_Regression_Score</span><span class="p">(</span><span class="s1">&#39;../files/erbB1_regression.sklearn&#39;</span><span class="p">)</span>

<span class="c1"># if in Collab</span>
<span class="c1"># download_files()</span>
<span class="c1"># reward_function = FP_Regression_Score(&#39;files/erbB1_regression.sklearn&#39;)</span>

<span class="n">reward</span> <span class="o">=</span> <span class="n">Reward</span><span class="p">(</span><span class="n">reward_function</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Combichem">Combichem<a class="anchor-link" href="#Combichem"> </a></h2><p>Here we set up our combichem module with a list of mutators and crossovers</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mutators</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ChangeAtom</span><span class="p">([</span><span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="s1">&#39;35&#39;</span><span class="p">]),</span>
    <span class="n">AppendAtomSingle</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">,</span> <span class="s1">&#39;Br&#39;</span><span class="p">]),</span>
    <span class="n">AppendAtomsDouble</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]),</span>
    <span class="n">AppendAtomsTriple</span><span class="p">(),</span>
    <span class="n">DeleteAtom</span><span class="p">(),</span>
    <span class="n">ChangeBond</span><span class="p">(),</span>
    <span class="n">InsertAtomSingle</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]),</span>
    <span class="n">InsertAtomDouble</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]),</span>
    <span class="n">InsertAtomTriple</span><span class="p">(),</span>
    <span class="n">AddRing</span><span class="p">(),</span>
    <span class="n">ShuffleNitrogen</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">mc</span> <span class="o">=</span> <span class="n">MutatorCollection</span><span class="p">(</span><span class="n">mutators</span><span class="p">)</span>

<span class="n">crossovers</span> <span class="o">=</span> <span class="p">[</span><span class="n">FragmentCrossover</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CombiChem</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">crossovers</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="n">reward</span><span class="p">],</span>
                <span class="n">prune_percentile</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">max_library_size</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p_explore</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generative-Model">Generative Model<a class="anchor-link" href="#Generative-Model"> </a></h2><p>We load a pre-trained generative model. This is a LSTM-based language model trained on the ZINC database</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">LSTM_LM_Small_ZINC_NC</span><span class="p">(</span><span class="n">drop_scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-Functions">Helper Functions<a class="anchor-link" href="#Helper-Functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="n">cbc</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="n">n_gen</span><span class="p">,</span> <span class="n">sl</span><span class="p">):</span>
    <span class="n">new_library</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">build_generation</span><span class="p">()</span>
    <span class="n">new_library</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">clean_library</span><span class="p">(</span><span class="n">new_library</span><span class="p">)</span>
    <span class="n">cbc</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="n">new_library</span><span class="p">)</span>
    <span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sample_no_grad</span><span class="p">(</span><span class="n">n_gen</span><span class="p">,</span> <span class="n">sl</span><span class="p">)</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
    <span class="n">cbc</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="n">cbc</span><span class="o">.</span><span class="n">score_library</span><span class="p">()</span>
    <span class="n">cbc</span><span class="o">.</span><span class="n">prune_library</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">train_from_cbc</span><span class="p">(</span><span class="n">cbc</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="n">ds_size</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">lr</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">cbc</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="n">cbc</span><span class="o">.</span><span class="n">old_library</span><span class="p">])</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">ds_size</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">update_dataset_from_inputs</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">smiles</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">agent</span><span class="o">.</span><span class="n">train_supervised</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Assisted-Combichem">Model Assisted Combichem<a class="anchor-link" href="#Model-Assisted-Combichem"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">step</span><span class="p">(</span><span class="n">cbc</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
        
    <span class="n">train_from_cbc</span><span class="p">(</span><span class="n">cbc</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cbc</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>10.300824455022813
13.433134039044381
15.450325035452842
16.517450484484435
17.25814539551735
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

